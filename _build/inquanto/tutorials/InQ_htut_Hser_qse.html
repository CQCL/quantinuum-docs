<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YPQ1FTGDL3"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-YPQ1FTGDL3');
    </script>
    <link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Quantinuum H-Series" href="quantinuum_hardware.html" /><link rel="prev" title="Quantinuum H-Series - Launching circuits and retrieving results" href="InQ_htut_Hser_l%2Br.html" />

    <link rel="shortcut icon" href="../_static/quantinuum_favicon.svg"/><!-- Generated with Sphinx 6.2.1 and Furo 2024.08.06 -->
        <title>Quantinuum H-Series - Quantum Subspace Expansion - InQuanto 4.1.0</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=04c057b233f3c8d71940eee6080f658a04e2027d" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=cf727022eb7470bc603c08d2e55c3247faec75c9" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style>
<link rel="stylesheet" href="../_static/tokens.css"/>
<link rel="stylesheet" href="../_static/styles.css"/>
<link rel="stylesheet" href="../_static/tailwind.css"/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="preload"
as="style">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">

<style>  
  .sidebar-sticky {
    top: calc(3.5rem - 0px);
    height: calc(100vh - 3.5rem);
  }
  
  @media (min-width: 97em) {
    html {
      font-size: 100% !important;
    }
  }
  
</style>
</head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>
<!-- <script type="text/javascript" src="../_static/syncTheme.global.js" ></script> -->
 <!--Force light mode -->
 <script>document.body.setAttribute('data-theme','light')</script>
<nav style="position:fixed;top:0;z-index:1021;width:100%;">
    <div class="nexus-nav"></div>
</nav>
<script type="text/javascript" src="../_static/injectNav.global.js"></script>
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">InQuanto 4.1.0</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/inquanto_short_logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">InQuanto 4.1.0</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction/overview.html">What is InQuanto?</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/installation.html">Installation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Installation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/system_requirements.html">System Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/troubleshooting.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/quickstart.html">Quick-start</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../manual/howto.html">How to use InQuanto</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../manual/algorithms_overview.html">Algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Algorithms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../manual/algorithms/variational_overview.html">Variational Algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Variational Algorithms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/algorithms_vqe.html">Variational Quantum Eigensolver <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmVQE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/algorithms_vqd.html">Variational Quantum Deflation <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmVQD</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/algorithms_adapt.html">ADAPT-VQE</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../manual/algorithms/non_variational_overview.html">Non-variational and Phase Estimation algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Non-variational and Phase Estimation algorithms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/algorithms_qse.html">Quantum Subspace Expansion <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmQSE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/algorithms_sceom.html">Quantum Self Consistent Equation of Motion <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmSCEOM</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/qpe_canonical.html">Canonical Quantum Phase Estimation <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmDeterministicQPE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/qpe_iterative.html">Iterative Phase Estimation Algorithms</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../manual/algorithms/time_evolution_overview.html">Time evolution algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Time evolution algorithms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/te_vqs.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmVQS</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmMcLachlanRealTime</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmMcLachlanImagTime</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../manual/computables_overview.html">Computables</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Computables</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../manual/computables/basic_usage.html">Basic Usage and Composability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/computables/evaluating_w_protocols.html">Evaluating Computables with Protocols</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../manual/computables/composite_computables.html">Composite Computables</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Composite Computables</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../manual/computables/greens_function.html">Krylov subspace &amp; Green’s functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/computables/rdms.html">Reduced Density Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/computables/overlap_matrix.html">Overlap Matrices &amp; Non-Orthogonal Subspaces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../manual/computables/primitives.html">Primitive Computables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/computables/custom_computables.html">Custom Computables &amp; Partial Evaluations</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../manual/protocols_overview.html">Protocols</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Protocols</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/expval.html">Protocols for expectation values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/overlap_squared.html">Protocols for overlap squared</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/overlap.html">Protocols for overlaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/derivative.html">Protocols for derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/other.html">Other averaging protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/phase_est.html">Protocols for Phase Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/resource_estimation.html">Resource estimation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../manual/errmit.html">Noise mitigation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/spaces.html">Spaces, Operators, and States</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../manual/ansatzae_overview.html">Ansatzes</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Ansatzes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/ucc_family.html">The UCC Family</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/chemically_aware.html">Chemically Aware Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/trotter_ansatz.html">Trotter Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/fermion_state_exp.html">Fermionic Exponentiated Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/circuit_ansatz.html">Circuit Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/composed_ansatz.html">Composed Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/hea.html">Hardware Efficient Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/multi_configurational.html">Multiconfiguration States Using Givens Rotations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/basis_rotation.html">Real Basis Rotation Ansatzes</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../manual/symmetry.html">Symmetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/geometry.html">Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/minimizers.html">Classical Minimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/dmet.html">Density Matrix Embedding Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/express.html">Express</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials &amp; Examples</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial_overview.html">Tutorials</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial_overview.html#core-tutorials">Core Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Core Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_vqe_1.html">A basic VQE simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_vqe_2.html">Extended VQE</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_vqd.html">Variational Quantum Deflation for excited states</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_viz.html">Visualization with inquanto-nglview</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="tutorial_overview.html#backend-tutorials">Backend Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Backend Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_Nexus_1.html"><b>Tutorial: InQuanto + qnexus</b></a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_htut_Aer_H2.html">Running on the Aer simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_htut_Hser_H2.html">Running on Quantinuum H-Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_htut_Hser_l%2Br.html">Quantinuum H-Series -  Launching circuits and retrieving results</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Quantinuum H-Series -  Quantum Subspace Expansion</a></li>
<li class="toctree-l2"><a class="reference internal" href="quantinuum_hardware.html">Quantinuum H-Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="setup_ibm.html">IBMQ Setup</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial_overview.html#case-study-tutorials-fe4n2">Case Study Tutorials - Fe4N2</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Case Study Tutorials - Fe4N2</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_fe4n2_1.html">Fe4N2 - 1 - system construction with AVAS and CASSCF</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_fe4n2_2.html">Fe4N2 - 2 - circuit construction with ADAPT-VQE</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_fe4n2_3.html">Fe4N2 - 3 - calculations on the H-series</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial_overview.html#fragmentation-tutorials">Fragmentation Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Fragmentation Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_dmet.html">Tackling larger systems with fragmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_wft_dft.html">Projection-based embedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_nevpt2_AC0.html">NEVPT2 and AC0 energy corrections</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_wft_dft_2.html">Projection-based embedding with energy corrections</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples_overview.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extensions User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../extensions/extensions-overview.html">Extensions overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extensions/inquanto-nexus.html">InQuanto-Nexus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extensions/inquanto-pyscf.html">InQuanto-PySCF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extensions/inquanto-nglview.html">InQuanto-NGLView</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extensions/inquanto-phayes.html">InQuanto-Phayes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../extensions/extensions_examples.html">Extensions examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/inquanto_api_intro.html">InQuanto</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of InQuanto</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/algorithms.html">inquanto.algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/ansatz.html">inquanto.ansatzes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/computables.html">inquanto.computables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/core.html">inquanto.core</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/embeddings.html">inquanto.embeddings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/express.html">inquanto.express</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/geometry.html">inquanto.geometries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/mappings.html">inquanto.mappings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/minimizers.html">inquanto.minimizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/operators.html">inquanto.operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/protocols.html">inquanto.protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/spaces.html">inquanto.spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/states.html">inquanto.states</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/symmetry.html">inquanto.symmetry</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/inquanto-ext_api_intro.html">InQuanto-Extensions</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of InQuanto-Extensions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/extensions/inquanto-nexus_api.html">InQuanto-Nexus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html">InQuanto-PySCF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/extensions/inquanto-nglview_api.html">InQuanto-NGLView</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/extensions/inquanto-phayes.html">InQuanto-Phayes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/extensions/inquanto-cutensornet_api.html">InQuanto-cuTensorNet</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../misc/changelog.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/contact.html">Contact Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/cite.html">How to cite InQuanto</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/licence.html">License and Notices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/opensource.html">Open-source Attribution</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="quantinuum-h-series-quantum-subspace-expansion">
<h1>Quantinuum H-Series -  Quantum Subspace Expansion<a class="headerlink" href="#quantinuum-h-series-quantum-subspace-expansion" title="Permalink to this heading">¶</a></h1>
<p>This tutorial illustrates the computation of molecular excited states through the application of the Quantum Subspace Expansion (QSE) technique on the Quantinuum H-series remote emulator. The QSE method leverages a precise calculation of the ground state energy for a specific molecular configuration to approximate the energies of corresponding excited states. Consider a stable molecule, denoted by a Hamiltonian <span class="math notranslate nohighlight">\(H\)</span>, and let <span class="math notranslate nohighlight">\(\left|\Psi_{0}\right\rangle\)</span> represent the outcome of the Variational Quantum Eigensolver (<a class="reference internal" href="InQ_tut_vqe_1.html"><span class="std std-doc">VQE</span></a>) algorithm employed to estimate the ground state energy of <span class="math notranslate nohighlight">\(H\)</span>. More information on the QSE method can be found in the publication available at this <a class="reference external" href="https://doi.org/10.1103/PhysRevA.95.042308">link</a>.</p>
<p>The QSE technique constructs a subspace of state vectors <span class="math notranslate nohighlight">\(\left|\Psi_j^k\right\rangle\)</span> formed by one-electron excitations of the ground state wavefunction:</p>
<p>\begin{equation}
\left|\Psi_{j}^{k}\right\rangle = c_k^{\dagger}c_{j}\left|\Psi_0\right\rangle.
\end{equation}</p>
<p>where <span class="math notranslate nohighlight">\(c_k^{\dagger}, c_{j}\)</span> are the fermionic creation and annihilation operators over spin orbitals <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(j\)</span>, respectively. That is, these vectors are formed by reducing the occupation of spin orbital <span class="math notranslate nohighlight">\(j\)</span> by one, and increasing the occupation of spin orbital <span class="math notranslate nohighlight">\(k\)</span> by one. The vectors are not in general orthogonal to <span class="math notranslate nohighlight">\(\Psi_{0}\)</span> hence we will need to calculate an overlap matrix.</p>
<p>Within this subspace, we solve a generalized eigenvalue problem. Consider the operator <span class="math notranslate nohighlight">\(\hat{H} \)</span> with matrix elements given by
$<span class="math notranslate nohighlight">\((H)_{jk}^{lm} = \langle\Psi_j^l \left| \hat{H} \right| \Psi_k^m\rangle,\)</span>$</p>
<p>and define an overlap matrix <span class="math notranslate nohighlight">\(S\)</span> whose matrix elements are given by</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[S_{jk}^{lm} = \langle \Psi_j^l \left|\Psi_k^m\right\rangle.\]</div>
</div>
<p>The generalized eigenvalue equation to be solved is</p>
<p>\begin{equation}
HC=SCE,
\end{equation}</p>
<p>where <span class="math notranslate nohighlight">\(C\)</span> is the matrix of eigenvectors, and <span class="math notranslate nohighlight">\(E\)</span> is the vector of eigenvalues. Crucially, the energy eigenvalues <span class="math notranslate nohighlight">\(E\)</span> provide an estimate of the excited state energies of <span class="math notranslate nohighlight">\(H\)</span> as well as a refined value of the ground state energy.</p>
<p>Notice that the solution to the generalized eigenvalue equation can be done on a classical computer, provided <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(S\)</span> have been calculated. The matrix elements of both of these matrices can be constructed using a quantum computer, in the following way. First, re-write the matrix elements in terms of <span class="math notranslate nohighlight">\(\left | \Psi_{0}\right \rangle\)</span>:</p>
<p>\begin{align}
(H)<em>{jk}^{lm} =&amp; \langle\Psi_j^l \left| \hat{H} \right| \Psi_k^m\rangle = \langle \Psi</em>{0} | c_{j}^\dagger c_{l} \hat{H}c_{m}^{\dagger}c_{k}|\Psi_{0}\rangle\
S_{jk}^{lm} &amp;= \langle \Psi_j^l \left|\Psi_k^m\right\rangle = \langle \Psi_{0} | c_{j}^\dagger c_{l} c_{m}^{\dagger}c_{k}|\Psi_{0}\rangle.
\end{align}</p>
<p>The matrix elements can be calculated using a quantum computer or simulator. By transforming the operators
<span class="math notranslate nohighlight">\(c_{j}^\dagger c_{l} c_{k}^{\dagger}c_{m}\)</span> and <span class="math notranslate nohighlight">\(c_{l}^\dagger c_{j} \hat{H} c_{m}^{\dagger}c_{k}\)</span> to a set of Pauli quantum gates according to an appropriate scheme such as Jordan-Wigner or Bravyi-Kitaev, apply this gate set to the ground state wavefunction (constructed with the coefficients obtained from the VQE calculation) and perform a measurement to obtain the expected value. By measuring these expectation values, we obtain estimates of <span class="math notranslate nohighlight">\(S_{jk}^{lm}\)</span> and <span class="math notranslate nohighlight">\(H_{jk}^{lm}\)</span>, respectively.</p>
<p>This tutorial will guide you through the process of performing QSE and will show how to collate the resulting eigen-energies and eigen-vectors. To demonstrate these concepts, we will utilize the methane (CH<span class="math notranslate nohighlight">\(_4\)</span>) chemical system. Note that to follow this tutorial, you must have been granted access to Quantinuum systems by your InQuanto administrator.</p>
<p>The steps below are such:</p>
<ul class="simple">
<li><p>Define the system</p></li>
<li><p>Prepare the approximate ground state obtained by the VQE algorithm</p></li>
<li><p>Configure the Quantinuum backend</p></li>
<li><p>Establish the PMSV error mitigation</p></li>
<li><p>Define protocol for measuring QSE matrix elements</p></li>
<li><p>Build InQuanto computables</p></li>
<li><p>Submit and retreive InQuanto computables</p></li>
<li><p>The black-box approach using the AlgorithmQSE</p></li>
</ul>
<p>After defining the Z-matrix for Methane, the Hamiltonian object is created using a restricted Hartree-Fock (RHF) InQuanto-PySCF driver.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">get_system</span></code> function is responsible for computing the fermionic Hamiltonian operator, Fock space, and Hartree Fock state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">inquanto.extensions.pyscf</span> <span class="kn">import</span> <span class="n">ChemistryDriverPySCFMolecularRHF</span>

<span class="n">zmatrix</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">C</span>
<span class="s2">H             1    1.083000</span>
<span class="s2">H             1    1.083000      2  109.471000</span>
<span class="s2">H             1    1.083000      2  109.471000      3  120.000000</span>
<span class="s2">H             1    1.083000      2  109.471000      4  120.000000</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">driver</span> <span class="o">=</span> <span class="n">ChemistryDriverPySCFMolecularRHF</span><span class="p">(</span>
    <span class="n">zmatrix</span><span class="o">=</span><span class="n">zmatrix</span><span class="p">,</span>
    <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">frozen</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
    <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;STO-3G&quot;</span><span class="p">,</span>
    <span class="n">point_group_symmetry</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">hamiltonian</span><span class="p">,</span> <span class="n">space</span><span class="p">,</span> <span class="n">state</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">get_system</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">qubit_encode</span></code> function carries out qubit encoding, utilizing the mapping class associated with the current integral operator. The default mapping approach is the Jordan-Wigner method. Additionally, we employ the <code class="docutils literal notranslate"><span class="pre">compress</span></code> method, which eliminates Hamiltonian terms with coefficients less than <code class="docutils literal notranslate"><span class="pre">abs_tol</span></code>, chosen as <span class="math notranslate nohighlight">\(10^{-6}\)</span> here. This step is a means of reducing the number of measurement circuits/quantum computational resources needed (which means less time to run which is preferred for a tutorial), and the threshold we use is fairly reasonable compared to the scale of errors induced by noisy quantum simulation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qubit_hamiltonian</span> <span class="o">=</span> <span class="n">hamiltonian</span><span class="o">.</span><span class="n">qubit_encode</span><span class="p">()</span>
<span class="n">qubit_hamiltonian</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">abs_tol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
<span class="n">qubit_hamiltonian</span><span class="o">.</span><span class="n">df</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Coefficient</th>
      <th>Term</th>
      <th>Coefficient Type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-37.822198</td>
      <td></td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.496463</td>
      <td>Z5</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.496463</td>
      <td>Z4</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.128963</td>
      <td>Z4 Z5</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.496463</td>
      <td>Z3</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.110247</td>
      <td>Z3 Z5</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.123222</td>
      <td>Z3 Z4</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-0.012975</td>
      <td>X2 X3 Y4 Y5</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.012975</td>
      <td>X2 Y3 Y4 X5</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.012975</td>
      <td>Y2 X3 X4 Y5</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>10</th>
      <td>-0.012975</td>
      <td>Y2 Y3 X4 X5</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>11</th>
      <td>-0.496463</td>
      <td>Z2</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.123222</td>
      <td>Z2 Z5</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.110247</td>
      <td>Z2 Z4</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.128963</td>
      <td>Z2 Z3</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>15</th>
      <td>-0.067741</td>
      <td>Z1</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.106870</td>
      <td>Z1 Z5</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0.118715</td>
      <td>Z1 Z4</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0.106870</td>
      <td>Z1 Z3</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.118715</td>
      <td>Z1 Z2</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>20</th>
      <td>-0.011845</td>
      <td>X0 X1 Y4 Y5</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>21</th>
      <td>-0.011845</td>
      <td>X0 X1 Y2 Y3</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>22</th>
      <td>0.011845</td>
      <td>X0 Y1 Y4 X5</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>23</th>
      <td>0.011845</td>
      <td>X0 Y1 Y2 X3</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>24</th>
      <td>0.011845</td>
      <td>Y0 X1 X4 Y5</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>25</th>
      <td>0.011845</td>
      <td>Y0 X1 X2 Y3</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>26</th>
      <td>-0.011845</td>
      <td>Y0 Y1 X4 X5</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>27</th>
      <td>-0.011845</td>
      <td>Y0 Y1 X2 X3</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>28</th>
      <td>-0.067741</td>
      <td>Z0</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>29</th>
      <td>0.118715</td>
      <td>Z0 Z5</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>30</th>
      <td>0.106870</td>
      <td>Z0 Z4</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>31</th>
      <td>0.118715</td>
      <td>Z0 Z3</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>32</th>
      <td>0.106870</td>
      <td>Z0 Z2</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
    <tr>
      <th>33</th>
      <td>0.123178</td>
      <td>Z0 Z1</td>
      <td>&lt;class 'numpy.float64'&gt;</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To construct our ansatz for the specified fermion space and fermion state, we have employed the Chemically Aware Unitary Coupled Cluster method with singles and doubles excitations (UCCSD). The circuit is synthesized using Jordan-Wigner encoding.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inquanto.ansatzes</span> <span class="kn">import</span> <span class="n">FermionSpaceAnsatzChemicallyAwareUCCSD</span>

<span class="n">ansatz</span> <span class="o">=</span> <span class="n">FermionSpaceAnsatzChemicallyAwareUCCSD</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">state</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next, a noiseless VQE simulation is executed on the QulacsBackend. The goal is to achieve a minimized expectation value and a set of circuit parameters corresponding to the ground state. These optimized parameters are subsequently employed in the Hamiltonian averaging experiment later on.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inquanto.express</span> <span class="kn">import</span> <span class="n">run_vqe</span>
<span class="kn">from</span> <span class="nn">pytket.extensions.qulacs</span> <span class="kn">import</span> <span class="n">QulacsBackend</span>

<span class="n">state_backend</span> <span class="o">=</span> <span class="n">QulacsBackend</span><span class="p">()</span>
<span class="n">vqe</span> <span class="o">=</span> <span class="n">run_vqe</span><span class="p">(</span><span class="n">ansatz</span><span class="p">,</span> <span class="n">hamiltonian</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">state_backend</span><span class="p">,</span> <span class="n">with_gradient</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">parameters</span> <span class="o">=</span> <span class="n">vqe</span><span class="o">.</span><span class="n">final_parameters</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># TIMER BLOCK-0 BEGINS AT 2024-02-19 10:02:38.479944
# TIMER BLOCK-0 ENDS - DURATION (s):  0.8142243 [0:00:00.814224]
</pre></div>
</div>
</div>
</div>
<p>To simulate the specific noise profiles of machines, we can load and apply them to our simulations using the <code class="docutils literal notranslate"><span class="pre">QuantinuumBackend</span></code>, which retrieves information from your Quantinuum account. The QuantinuumBackend offers a range of available emulators, such as H1-1E and H1-2E. These emulators are designed for specific devices and they run remotely on a server.</p>
<p>Parameters used:</p>
<p><code class="docutils literal notranslate"><span class="pre">device_name</span></code> – Name of device, e.g. “H1-1”</p>
<p><code class="docutils literal notranslate"><span class="pre">label</span></code> – Job labels used if Circuits have no name, defaults to “job”</p>
<p><code class="docutils literal notranslate"><span class="pre">group</span></code> – string identifier of a collection of jobs, can be used for usage tracking.</p>
<p>The <a class="reference external" href="https://docs.quantinuum.com/tket/extensions/pytket-quantinuum/">pytket-quantinuum</a> extension allows the user to access the following quantum devices, emulators and syntax checkers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pytket.extensions.quantinuum</span> <span class="kn">import</span> <span class="n">QuantinuumBackend</span>

<span class="n">backend</span> <span class="o">=</span> <span class="n">QuantinuumBackend</span><span class="p">(</span><span class="n">device_name</span><span class="o">=</span><span class="s2">&quot;H1-1E&quot;</span><span class="p">,</span> <span class="n">group</span> <span class="o">=</span><span class="s2">&quot;Default - UK&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To reduce errors and inaccuracies caused by quantum noise and imperfections in the Quantinuum device, we can employ noise mitigation techniques. In this case, we will define the Qubit Operator symmetries within the system, enabling us to utilize PMSV (Partition Measurement Symmetry Verification). More information about QubitOperator can be found in the provided <a class="reference external" href="https://docs.quantinuum.com/inquanto/api/inquanto/operators.html#inquanto.operators.QubitOperator">link</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inquanto.operators</span> <span class="kn">import</span> <span class="n">QubitOperator</span>
<span class="kn">from</span> <span class="nn">inquanto.protocols</span> <span class="kn">import</span> <span class="n">PMSV</span>

<span class="n">stabilizers</span> <span class="o">=</span> <span class="p">[</span><span class="n">QubitOperator</span><span class="p">(</span><span class="s2">&quot;Z0 Z1 Z2 Z3 Z4 Z5&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>

<span class="n">mitms_pmsv</span> <span class="o">=</span> <span class="n">PMSV</span><span class="p">(</span><span class="n">stabilizers</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To expand the subspace for computing low-lying excited states, it is essential to define the basis. In this context, the function <code class="docutils literal notranslate"><span class="pre">generate_subspace_singlet_singles</span></code> is employed, which sequentially provides spin-adapted singlet-single excitation operators to preserve spin symmetry which are then mapped to qubits using the Jordan-Wigner method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inquanto.mappings</span> <span class="kn">import</span> <span class="n">QubitMappingJordanWigner</span>

<span class="n">mapping</span> <span class="o">=</span> <span class="n">QubitMappingJordanWigner</span><span class="p">()</span>

<span class="n">fermionic_excitations_singlets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">space</span><span class="o">.</span><span class="n">generate_subspace_singlet_singles</span><span class="p">())</span>
<span class="n">qubit_excitations_singlets</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">operator_map</span><span class="p">(</span><span class="n">fermionic_excitations_singlets</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now that the Hamiltonian, Ansatz and QSE basis operators are defined, we can build the computable. The computable is the chemical quantity that we are interested in. In this example, we are interested in building the QSE computable using the <code class="docutils literal notranslate"><span class="pre">QSEMatricesComputable</span></code> function.</p>
<p>Parameters used:</p>
<p><code class="docutils literal notranslate"><span class="pre">state</span></code>  – Ansatz used to represent the ground state, it is used as a reference state for the excitations to generate the subspace.</p>
<p><code class="docutils literal notranslate"><span class="pre">hermitian_operator</span></code> – A hermitian operator, typically a hamiltonian, to be expanded in the subspace.</p>
<p><code class="docutils literal notranslate"><span class="pre">expansion_operators</span></code>  – A List of excitation operators spanning the subspace.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inquanto.computables.composite</span> <span class="kn">import</span> <span class="n">QSEMatricesComputable</span>

<span class="n">qse</span> <span class="o">=</span> <span class="n">QSEMatricesComputable</span><span class="p">(</span>
    <span class="n">state</span><span class="o">=</span><span class="n">ansatz</span><span class="p">,</span>
    <span class="n">hermitian_operator</span><span class="o">=</span><span class="n">qubit_hamiltonian</span><span class="p">,</span>
    <span class="n">expansion_operators</span><span class="o">=</span><span class="n">qubit_excitations_singlets</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To compute the expectation value of a Hermitian operator through operator averaging on the system register, we employ the <code class="docutils literal notranslate"><span class="pre">PauliAveraging</span></code> protocol. This protocol effectively implements the procedure outlined in <a class="reference external" href="https://docs.quantinuum.com/inquanto/manual/protocols/expval.html">Operator Averaging</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inquanto.protocols</span> <span class="kn">import</span> <span class="n">PauliAveraging</span>
<span class="kn">from</span> <span class="nn">pytket.partition</span> <span class="kn">import</span> <span class="n">PauliPartitionStrat</span>

<span class="n">protocol</span> <span class="o">=</span> <span class="n">PauliAveraging</span><span class="p">(</span>
    <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
    <span class="n">shots_per_circuit</span><span class="o">=</span><span class="mi">6000</span><span class="p">,</span>
    <span class="n">pauli_partition_strategy</span><span class="o">=</span><span class="n">PauliPartitionStrat</span><span class="o">.</span><span class="n">CommutingSets</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">protocol</span><span class="o">.</span><span class="n">build_from</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span> <span class="n">computable</span><span class="o">=</span><span class="n">qse</span><span class="p">,</span> <span class="n">noise_mitigation</span><span class="o">=</span><span class="n">mitms_pmsv</span><span class="p">)</span>
<span class="n">protocol</span><span class="o">.</span><span class="n">compile_circuits</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;inquanto.protocols.averaging._pauli_averaging.PauliAveraging at 0x16ac06990&gt;
</pre></div>
</div>
</div>
</div>
<p>Despite having many Qubit Operators to measure, this protocol ends up generating 30 measurement circuits due to the commutation relations measurement partitioning strategy pytket uses.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">protocol</span><span class="o">.</span><span class="n">n_circuit</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>30
</pre></div>
</div>
</div>
</div>
<p>To launch the circuits to the backend we have used the <code class="docutils literal notranslate"><span class="pre">launch</span></code> function. This method processes all the circuits associated with the expectation value calculations and returns a list of ResultHandle objects representing the handles for the results. We can pickle these ResultHandle objects so we can retrieve the results once they are ready. After our experiments have finished, we can obtain the results by utilizing the <code class="docutils literal notranslate"><span class="pre">retrieve</span></code> function, which retrieves distributions from the backend for the specified source.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">handles</span> <span class="o">=</span> <span class="n">protocol</span><span class="o">.</span><span class="n">launch</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;handles.pickle&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">handle</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">handle</span><span class="p">,</span> <span class="n">protocol</span><span class="o">=</span><span class="n">pickle</span><span class="o">.</span><span class="n">HIGHEST_PROTOCOL</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">completion_check</span><span class="o">=</span><span class="n">backend</span><span class="o">.</span><span class="n">circuit_status</span><span class="p">(</span><span class="n">handles</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="c1">#n-1 </span>
<span class="nb">print</span><span class="p">(</span><span class="n">completion_check</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Circuit is queued.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">protocol</span><span class="o">.</span><span class="n">retrieve</span><span class="p">(</span><span class="n">handles</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;inquanto.protocols.averaging._pauli_averaging.PauliAveraging at 0x7fa080330990&gt;
</pre></div>
</div>
</div>
</div>
<p>Once the results have been retrieved the Hamiltonian expectation value is evaluated as a classical post-processing step.</p>
<p>We now need to pass the output of the <code class="docutils literal notranslate"><span class="pre">QSEMatricesComputable</span></code> into <code class="docutils literal notranslate"><span class="pre">pd_safe_eigh</span></code>. This will solve the generalized eigenvalue equation and return the eigenvalues and eigenvectors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H</span><span class="p">,</span><span class="n">S</span> <span class="o">=</span> <span class="n">qse</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">protocol</span><span class="o">.</span><span class="n">get_evaluator</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inquanto.core</span> <span class="kn">import</span> <span class="n">pd_safe_eigh</span>
  
<span class="n">e_vals_singlets</span><span class="p">,</span> <span class="n">e_coeffs_singlets</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">pd_safe_eigh</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="n">S</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">e_vals_singlets</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">e_coeffs_singlets</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-39.729 -38.91  -38.871 -38.768 -38.273 -37.903]
[[-0.156+0.476j  0.004-0.008j  0.002-0.006j -0.018+0.023j  0.002-0.015j
  -0.   -0.002j]
 [-0.311-0.135j -0.24 +0.368j -0.567+0.08j   3.806+1.333j  0.888+0.622j
  -0.223-0.734j]
 [-0.388-0.069j -0.606-0.105j -0.781+0.008j  4.621+0.967j -1.663-0.86j
  -0.85 +0.603j]
 [-0.003-0.003j  0.576+0.164j -0.384+0.022j  0.06 +0.043j -0.061+0.026j
  -0.004-0.055j]
 [-0.077-0.165j -1.04 +0.671j -0.19 -0.518j  0.644+1.722j -1.634+2.515j
  -5.204+1.559j]
 [ 0.16 +0.204j  0.08 +1.131j  0.391+0.141j -2.197-2.655j  0.879+3.241j
  -2.243+2.55j ]
 [-0.006+0.003j  0.111+0.338j  0.363+0.46j   0.113+0.117j -0.12 -0.056j
  -0.007+0.04j ]
 [-0.098-0.106j -0.638+0.085j -0.395+0.104j  1.81 +1.216j -1.329+1.704j
   1.878-1.188j]
 [ 0.17 +0.018j  0.057+0.8j    0.203+0.411j -1.287-0.708j  1.636+4.126j
   3.24 -1.954j]]
</pre></div>
</div>
</div>
</div>
<p>We perform additional post-processing to report the operator expansion for each excited state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inquanto.operators</span> <span class="kn">import</span> <span class="n">FermionOperator</span>

<span class="n">e_vecs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">e_coeffs_singlets</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">operator</span> <span class="o">=</span> <span class="n">FermionOperator</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">e_coeffs_singlets</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">fermionic_excitations_singlets</span><span class="p">):</span>
        <span class="n">operator</span> <span class="o">+=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">o</span>
    <span class="n">operator</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">abs_tol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">operator</span><span class="p">)</span>
    <span class="n">e_vecs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">operator</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-0.15565783977198872+0.47621487975804033j, F0^ F0 ), (-0.15565783977198872+0.47621487975804033j, F1^ F1 ), (-0.3109942131939058-0.13521605338785778j, F0^ F2 ), (-0.3109942131939058-0.13521605338785778j, F1^ F3 ), (-0.38839307178519544-0.0693114600174391j, F0^ F4 ), (-0.38839307178519544-0.0693114600174391j, F1^ F5 ), (-0.003308852334800071-0.002955219215334559j, F2^ F0 ), (-0.003308852334800071-0.002955219215334559j, F3^ F1 ), (-0.07692730809458342-0.1649068223822534j, F2^ F2 ), (-0.07692730809458342-0.1649068223822534j, F3^ F3 ), (0.16028553390102782+0.2040034257419802j, F2^ F4 ), (0.16028553390102782+0.2040034257419802j, F3^ F5 ), (-0.006135282730581221+0.003137920667681536j, F4^ F0 ), (-0.006135282730581221+0.003137920667681536j, F5^ F1 ), (-0.09846811137359278-0.10620905658730515j, F4^ F2 ), (-0.09846811137359278-0.10620905658730515j, F5^ F3 ), (0.16993533787082993+0.01769895101511043j, F4^ F4 ), (0.16993533787082993+0.01769895101511043j, F5^ F5 )
(0.003529209585032674-0.00795687921061023j, F0^ F0 ), (0.003529209585032674-0.00795687921061023j, F1^ F1 ), (-0.24049475157327982+0.36783111046288186j, F0^ F2 ), (-0.24049475157327982+0.36783111046288186j, F1^ F3 ), (-0.6060191423196757-0.10482632989727117j, F0^ F4 ), (-0.6060191423196757-0.10482632989727117j, F1^ F5 ), (0.5763459636232429+0.16388842490954422j, F2^ F0 ), (0.5763459636232429+0.16388842490954422j, F3^ F1 ), (-1.0398193192980176+0.6711364842936922j, F2^ F2 ), (-1.0398193192980176+0.6711364842936922j, F3^ F3 ), (0.0799938237057527+1.1312076955513257j, F2^ F4 ), (0.0799938237057527+1.1312076955513257j, F3^ F5 ), (0.11138656902183633+0.3380893725102996j, F4^ F0 ), (0.11138656902183633+0.3380893725102996j, F5^ F1 ), (-0.6378073443599778+0.08473450806257327j, F4^ F2 ), (-0.6378073443599778+0.08473450806257327j, F5^ F3 ), (0.057037317243711416+0.7995538108062838j, F4^ F4 ), (0.057037317243711416+0.7995538108062838j, F5^ F5 )
(0.002165953897558483-0.005944635760931628j, F0^ F0 ), (0.002165953897558483-0.005944635760931628j, F1^ F1 ), (-0.5667818952627056+0.08033281708487372j, F0^ F2 ), (-0.5667818952627056+0.08033281708487372j, F1^ F3 ), (-0.7806938566797863+0.008375225559272712j, F0^ F4 ), (-0.7806938566797863+0.008375225559272712j, F1^ F5 ), (-0.38358059039903575+0.02164733189057025j, F2^ F0 ), (-0.38358059039903575+0.02164733189057025j, F3^ F1 ), (-0.18951924122622935-0.5175643220754953j, F2^ F2 ), (-0.18951924122622935-0.5175643220754953j, F3^ F3 ), (0.39067878123749633+0.14105366840747063j, F2^ F4 ), (0.39067878123749633+0.14105366840747063j, F3^ F5 ), (0.3633037576320181+0.45991596424530234j, F4^ F0 ), (0.3633037576320181+0.45991596424530234j, F5^ F1 ), (-0.3948958613818514+0.10360791672209882j, F4^ F2 ), (-0.3948958613818514+0.10360791672209882j, F5^ F3 ), (0.2025074399411661+0.41092059234737977j, F4^ F4 ), (0.2025074399411661+0.41092059234737977j, F5^ F5 )
(-0.017840047182897188+0.022744956740089296j, F0^ F0 ), (-0.017840047182897188+0.022744956740089296j, F1^ F1 ), (3.806126291783216+1.332658212611577j, F0^ F2 ), (3.806126291783216+1.332658212611577j, F1^ F3 ), (4.621131902658994+0.9671995436795001j, F0^ F4 ), (4.621131902658994+0.9671995436795001j, F1^ F5 ), (0.05993966785070938+0.04310122860320857j, F2^ F0 ), (0.05993966785070938+0.04310122860320857j, F3^ F1 ), (0.6441688080331356+1.7220627585285808j, F2^ F2 ), (0.6441688080331356+1.7220627585285808j, F3^ F3 ), (-2.1965755386805927-2.655483790470051j, F2^ F4 ), (-2.1965755386805927-2.655483790470051j, F3^ F5 ), (0.1127899167896759+0.11659167840761259j, F4^ F0 ), (0.1127899167896759+0.11659167840761259j, F5^ F1 ), (1.809508151433246+1.2160491220244634j, F4^ F2 ), (1.809508151433246+1.2160491220244634j, F5^ F3 ), (-1.2874605040396814-0.7077883650219732j, F4^ F4 ), (-1.2874605040396814-0.7077883650219732j, F5^ F5 )
(0.0021294584990190677-0.01537836611697584j, F0^ F0 ), (0.0021294584990190677-0.01537836611697584j, F1^ F1 ), (0.8881021827827966+0.6217291428756166j, F0^ F2 ), (0.8881021827827966+0.6217291428756166j, F1^ F3 ), (-1.6634091829941275-0.85957877147374j, F0^ F4 ), (-1.6634091829941275-0.85957877147374j, F1^ F5 ), (-0.06072464916897717+0.025946744324903372j, F2^ F0 ), (-0.06072464916897717+0.025946744324903372j, F3^ F1 ), (-1.6336871970371127+2.515156393240569j, F2^ F2 ), (-1.6336871970371127+2.515156393240569j, F3^ F3 ), (0.8787624912303986+3.2406507977554675j, F2^ F4 ), (0.8787624912303986+3.2406507977554675j, F3^ F5 ), (-0.12020930798769339-0.055773317529686006j, F4^ F0 ), (-0.12020930798769339-0.055773317529686006j, F5^ F1 ), (-1.3286485705307103+1.7035098710284213j, F4^ F2 ), (-1.3286485705307103+1.7035098710284213j, F5^ F3 ), (1.6355067063551598+4.126046236307394j, F4^ F4 ), (1.6355067063551598+4.126046236307394j, F5^ F5 )
(-0.00020756753326981142-0.0016959811491862975j, F0^ F0 ), (-0.00020756753326981142-0.0016959811491862975j, F1^ F1 ), (-0.22283094986115085-0.7342082125387235j, F0^ F2 ), (-0.22283094986115085-0.7342082125387235j, F1^ F3 ), (-0.8502303263381792+0.6025252787670932j, F0^ F4 ), (-0.8502303263381792+0.6025252787670932j, F1^ F5 ), (-0.004028844274401662-0.054943191515560284j, F2^ F0 ), (-0.004028844274401662-0.054943191515560284j, F3^ F1 ), (-5.203599573643404+1.5592992892443864j, F2^ F2 ), (-5.203599573643404+1.5592992892443864j, F3^ F3 ), (-2.2427076382898403+2.550269786999596j, F2^ F4 ), (-2.2427076382898403+2.550269786999596j, F3^ F5 ), (-0.006964622239363893+0.040135082617393666j, F4^ F0 ), (-0.006964622239363893+0.040135082617393666j, F5^ F1 ), (1.878027835548134-1.18788450746501j, F4^ F2 ), (1.878027835548134-1.18788450746501j, F5^ F3 ), (3.2403778890630868-1.953712459189611j, F4^ F4 ), (3.2403778890630868-1.953712459189611j, F5^ F5 )
</pre></div>
</div>
</div>
</div>
<p>Alternatively, the Quantum Subspace Expansion algorithm implemented in InQuanto, known as <code class="docutils literal notranslate"><span class="pre">AlgorithmQSE</span></code>, can be employed. This is a black-box method enabling direct retrieval of eigenvalues and eigenvectors, stored as <code class="docutils literal notranslate"><span class="pre">final_value</span></code> and <code class="docutils literal notranslate"><span class="pre">final_states</span></code>, respectively. The algorithm addresses numerical instabilities during matrix diagonalization by eliminating near-linear dependencies in the basis. However, it’s worth noting that the user has less control over the specific details of the process. Some examples that cannot be executed include launching, retrieving, and performing PMSV.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inquanto.algorithms</span> <span class="kn">import</span> <span class="n">AlgorithmQSE</span>

<span class="n">algorithm</span> <span class="o">=</span> <span class="n">AlgorithmQSE</span><span class="p">(</span>
    <span class="n">computable_qse_matrices</span><span class="o">=</span><span class="n">qse</span><span class="p">,</span>
    <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">protocol_expression</span> <span class="o">=</span> <span class="n">PauliAveraging</span><span class="p">(</span>
    <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span>
    <span class="n">shots_per_circuit</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">pauli_partition_strategy</span><span class="o">=</span><span class="n">PauliPartitionStrat</span><span class="o">.</span><span class="n">CommutingSets</span><span class="p">,</span>
<span class="p">)</span>
    
<span class="n">algorithm</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">protocol</span><span class="o">=</span><span class="n">protocol_expression</span><span class="p">)</span>
    
<span class="c1">#algorithm.run() </span>

<span class="c1">#print(algorithm.generate_report())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;inquanto.algorithms.qse._algorithm_qse.AlgorithmQSE at 0x7fa0534b7850&gt;
</pre></div>
</div>
</div>
</div>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="quantinuum_hardware.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Quantinuum H-Series</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="InQ_htut_Hser_l%2Br.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Quantinuum H-Series -  Launching circuits and retrieving results</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
              Copyright &#169; 2024 Quantinuum Ltd. All rights reserved.
            </div>
            <div class="terms" style="display:flex; gap:0.5rem; align-items:center; margin: 0.25rem 0rem;">
              <a href="https://www.quantinuum.com/privacy-statement" target="_blank">Privacy Statement</a>
              <div role="separator">/</div>
              <a href="https://www.quantinuum.com/cookie-notice" target="_blank">Cookie Notice</a>
              <div role="separator">/</div>
              <a href="https://www.quantinuum.com/terms-conditions" target="_blank">Terms and Conditions</a>
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../_static/jquery.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>
    </body>
</html>