<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YPQ1FTGDL3"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-YPQ1FTGDL3');
    </script>
    <link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="GeneralState Tutorial" href="../examples/general_state_tutorial.html" /><link rel="prev" title="General state (exact) simulation" href="general_state.html" />

    <link rel="shortcut icon" href="../_static/quantinuum_favicon.svg"/><!-- Generated with Sphinx 8.0.2 and Furo 2024.08.06 -->
        <title>Structured state evolution - pytket-cutensornet 0.10.1 API documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style>
<link rel="stylesheet" href="../_static/tokens.css"/>
<link rel="stylesheet" href="../_static/styles.css"/>
<link rel="stylesheet" href="../_static/tailwind.css"/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="preload"
as="style">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">

<style>  
  .sidebar-sticky {
    top: calc(3.5rem - 0px);
    height: calc(100vh - 3.5rem);
  }
  
  @media (min-width: 97em) {
    html {
      font-size: 100% !important;
    }
  }
  
</style>
</head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>
<!-- <script type="text/javascript" src="../_static/syncTheme.global.js" ></script> -->
 <!--Force light mode -->
 <script>document.body.setAttribute('data-theme','light')</script>
<nav style="position:fixed;top:0;z-index:1021;width:100%;">
    <div class="nexus-nav"></div>
</nav>
<script type="text/javascript" src="../_static/injectNav.global.js"></script>
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">pytket-cutensornet 0.10.1 API documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">pytket-cutensornet 0.10.1 API documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../api.html">API documentation</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="general_state.html">General state (exact) simulation</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Structured state evolution</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example Notebooks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/general_state_tutorial.html"><code class="docutils literal notranslate"><span class="pre">GeneralState</span></code> Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/mps_tutorial.html">Matrix Product State (MPS) Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/ttn_tutorial.html">Tree Tensor Network (TTN) Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Changelog</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Useful links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/CQCL/pytket-cutensornet/issues">Issue tracker</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/pytket-cutensornet/">PyPi</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/modules/structured_state.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="module-pytket.extensions.cutensornet.structured_state">
<span id="structured-state-evolution"></span><h1>Structured state evolution<a class="headerlink" href="#module-pytket.extensions.cutensornet.structured_state" title="Link to this heading">¶</a></h1>
<p>Module for circuit simulation by state evolution, where the state is
represented by a tensor network with a predefined structure.
Approximate tensor network contraction is supported. Both <code class="docutils literal notranslate"><span class="pre">MPS</span></code> and <code class="docutils literal notranslate"><span class="pre">TTN</span></code>
methods are provided.
For an example of its use, see the <code class="docutils literal notranslate"><span class="pre">examples/</span></code> folder at
<a class="reference external" href="https://github.com/CQCL/pytket-cutensornet">https://github.com/CQCL/pytket-cutensornet</a>.</p>
<section id="library-handle">
<h2>Library handle<a class="headerlink" href="#library-handle" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.CuTensorNetHandle">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytket.extensions.cutensornet.</span></span><span class="sig-name descname"><span class="pre">CuTensorNetHandle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/general.html#CuTensorNetHandle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.CuTensorNetHandle" title="Link to this definition">¶</a></dt>
<dd><p>Initialise the cuTensorNet library with automatic workspace memory
management.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Always use as <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">CuTensorNetHandle()</span> <span class="pre">as</span> <span class="pre">libhandle:</span></code> so that cuTensorNet
handles are automatically destroyed at the end of execution.</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.CuTensorNetHandle.handle">
<span class="sig-name descname"><span class="pre">handle</span></span><a class="headerlink" href="#pytket.extensions.cutensornet.CuTensorNetHandle.handle" title="Link to this definition">¶</a></dt>
<dd><p>The cuTensorNet library handle created by this initialisation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.CuTensorNetHandle.device_id">
<span class="sig-name descname"><span class="pre">device_id</span></span><a class="headerlink" href="#pytket.extensions.cutensornet.CuTensorNetHandle.device_id" title="Link to this definition">¶</a></dt>
<dd><p>The ID of the device (GPU) where cuTensorNet is initialised.
If not provided, defaults to <code class="docutils literal notranslate"><span class="pre">cp.cuda.Device()</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.CuTensorNetHandle.destroy">
<span class="sig-name descname"><span class="pre">destroy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/general.html#CuTensorNetHandle.destroy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.CuTensorNetHandle.destroy" title="Link to this definition">¶</a></dt>
<dd><p>Destroys the memory handle, releasing memory.</p>
<p>Only call this method if you are initialising a <code class="docutils literal notranslate"><span class="pre">CuTensorNetHandle</span></code> outside
a <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">CuTensorNetHandle()</span> <span class="pre">as</span> <span class="pre">libhandle</span></code> statement.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="simulation">
<h2>Simulation<a class="headerlink" href="#simulation" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.simulate">
<span class="sig-prename descclassname"><span class="pre">pytket.extensions.cutensornet.structured_state.</span></span><span class="sig-name descname"><span class="pre">simulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">libhandle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">circuit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compilation_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/simulation.html#simulate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.simulate" title="Link to this definition">¶</a></dt>
<dd><p>Simulates the circuit and returns the <code class="docutils literal notranslate"><span class="pre">StructuredState</span></code> of the final state.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A <code class="docutils literal notranslate"><span class="pre">libhandle</span></code> is created via a <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">CuTensorNetHandle()</span> <span class="pre">as</span> <span class="pre">libhandle:</span></code>
statement. The device where the <code class="docutils literal notranslate"><span class="pre">StructuredState</span></code> is stored will match the one
specified by the library handle.</p>
<p>The input <code class="docutils literal notranslate"><span class="pre">circuit</span></code> must be composed of one-qubit and two-qubit gates only.
Any gateset supported by <code class="docutils literal notranslate"><span class="pre">pytket</span></code> can be used.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>libhandle</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pytket.extensions.cutensornet.CuTensorNetHandle" title="pytket.extensions.cutensornet.general.CuTensorNetHandle"><code class="xref py py-class docutils literal notranslate"><span class="pre">CuTensorNetHandle</span></code></a></span>) – The cuTensorNet library handle that will be used to carry out
tensor operations.</p></li>
<li><p><strong>circuit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/circuit_class.html#pytket.circuit.Circuit" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Circuit</span></code></a></span>) – The pytket circuit to be simulated.</p></li>
<li><p><strong>algorithm</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.SimulationAlgorithm" title="pytket.extensions.cutensornet.structured_state.simulation.SimulationAlgorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">SimulationAlgorithm</span></code></a></span>) – Choose between the values of the <code class="docutils literal notranslate"><span class="pre">SimulationAlgorithm</span></code> enum.</p></li>
<li><p><strong>config</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.Config" title="pytket.extensions.cutensornet.structured_state.general.Config"><code class="xref py py-class docutils literal notranslate"><span class="pre">Config</span></code></a></span>) – The configuration object for simulation.</p></li>
<li><p><strong>compilation_params</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]]</span>) – Experimental feature. Defaults to no compilation.
Parameters currently not documented.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState" title="pytket.extensions.cutensornet.structured_state.general.StructuredState"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuredState</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>An instance of <code class="docutils literal notranslate"><span class="pre">StructuredState</span></code> for (an approximation of) the final state
of the circuit. The instance be of the class matching <code class="docutils literal notranslate"><span class="pre">algorithm</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class enum">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.SimulationAlgorithm">
<em class="property"><span class="pre">enum</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytket.extensions.cutensornet.structured_state.</span></span><span class="sig-name descname"><span class="pre">SimulationAlgorithm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/simulation.html#SimulationAlgorithm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.SimulationAlgorithm" title="Link to this definition">¶</a></dt>
<dd><p>An enum to refer to the StructuredState contraction algorithm.</p>
<p>Each enum value corresponds to the class with the same name; see its docs for
information about the algorithm.</p>
<p>Valid values are as follows:</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.SimulationAlgorithm.TTNxGate">
<span class="sig-name descname"><span class="pre">TTNxGate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;SimulationAlgorithm.TTNxGate:</span> <span class="pre">0&gt;</span></em><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.SimulationAlgorithm.TTNxGate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.SimulationAlgorithm.MPSxGate">
<span class="sig-name descname"><span class="pre">MPSxGate</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;SimulationAlgorithm.MPSxGate:</span> <span class="pre">1&gt;</span></em><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.SimulationAlgorithm.MPSxGate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.SimulationAlgorithm.MPSxMPO">
<span class="sig-name descname"><span class="pre">MPSxMPO</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;SimulationAlgorithm.MPSxMPO:</span> <span class="pre">2&gt;</span></em><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.SimulationAlgorithm.MPSxMPO" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.Config">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytket.extensions.cutensornet.structured_state.</span></span><span class="sig-name descname"><span class="pre">Config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chi=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncation_fidelity=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float_precision=&lt;class</span> <span class="pre">'numpy.float64'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_of_zero=1e-16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_size=8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k=4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim_delta=1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglevel=30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#Config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.Config" title="Link to this definition">¶</a></dt>
<dd><p>Configuration class for simulation using <code class="docutils literal notranslate"><span class="pre">StructuredState</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.Config.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chi=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncation_fidelity=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">float_precision=&lt;class</span> <span class="pre">'numpy.float64'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_of_zero=1e-16</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leaf_size=8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k=4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optim_delta=1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loglevel=30</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#Config.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.Config.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Instantiate a configuration object for <code class="docutils literal notranslate"><span class="pre">StructuredState</span></code> simulation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Providing both a custom <code class="docutils literal notranslate"><span class="pre">chi</span></code> and <code class="docutils literal notranslate"><span class="pre">truncation_fidelity</span></code> will raise an
exception. Choose one or the other (or neither, for exact simulation).</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chi</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – The maximum value allowed for the dimension of the virtual
bonds. Higher implies better approximation but more
computational resources. If not provided, <code class="docutils literal notranslate"><span class="pre">chi</span></code> will be unbounded.</p></li>
<li><p><strong>truncation_fidelity</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]</span>) – Every time a two-qubit gate is applied, the virtual
bond will be truncated to the minimum dimension that satisfies
<code class="docutils literal notranslate"><span class="pre">|&lt;psi|phi&gt;|^2</span> <span class="pre">&gt;=</span> <span class="pre">trucantion_fidelity</span></code>, where <code class="docutils literal notranslate"><span class="pre">|psi&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">|phi&gt;</span></code>
are the states before and after truncation (both normalised).
If not provided, it will default to its maximum value 1.</p></li>
<li><p><strong>seed</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – Seed for the random number generator. Setting a seed provides
reproducibility across simulations using <code class="docutils literal notranslate"><span class="pre">StructuredState</span></code>, in the
sense that they will produce the same sequence of measurement outcomes.
Crucially, consecutive samples taken from the same <code class="docutils literal notranslate"><span class="pre">StructuredState</span></code>
can still be different from each other.</p></li>
<li><p><strong>float_precision</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Any</span></code></a>]</span>) – The floating point precision used in tensor calculations;
choose from <code class="docutils literal notranslate"><span class="pre">numpy</span></code> types: <code class="docutils literal notranslate"><span class="pre">np.float64</span></code> or <code class="docutils literal notranslate"><span class="pre">np.float32</span></code>.
Complex numbers are represented using two of such
<code class="docutils literal notranslate"><span class="pre">float</span></code> numbers. Default is <code class="docutils literal notranslate"><span class="pre">np.float64</span></code>.</p></li>
<li><p><strong>value_of_zero</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Any number below this value will be considered equal to zero.
Even when no <code class="docutils literal notranslate"><span class="pre">chi</span></code> or <code class="docutils literal notranslate"><span class="pre">truncation_fidelity</span></code> is provided, singular
values below this number will be truncated.
We suggest to use a value slightly below what your chosen
<code class="docutils literal notranslate"><span class="pre">float_precision</span></code> can reasonably achieve. For instance, <code class="docutils literal notranslate"><span class="pre">1e-16</span></code> for
<code class="docutils literal notranslate"><span class="pre">np.float64</span></code> precision (default) and <code class="docutils literal notranslate"><span class="pre">1e-7</span></code> for <code class="docutils literal notranslate"><span class="pre">np.float32</span></code>.</p></li>
<li><p><strong>leaf_size</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – For <code class="docutils literal notranslate"><span class="pre">TTN</span></code> simulation only. Sets the maximum number of
qubits in a leaf node when using <code class="docutils literal notranslate"><span class="pre">TTN</span></code>. Default is 8.</p></li>
<li><p><strong>k</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – For <code class="docutils literal notranslate"><span class="pre">MPSxMPO</span></code> simulation only. Sets the maximum number of layers
the MPO is allowed to have before being contracted. Increasing this
might increase fidelity, but it will also increase resource requirements
exponentially. Default value is 4.</p></li>
<li><p><strong>optim_delta</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – For <code class="docutils literal notranslate"><span class="pre">MPSxMPO</span></code> simulation only. Sets the stopping criteria for
the optimisation when contracting the <code class="docutils literal notranslate"><span class="pre">k</span></code> layers of MPO. Stops when
the increase of fidelity between iterations is smaller than this value.
Default value is <code class="docutils literal notranslate"><span class="pre">1e-5</span></code>.</p></li>
<li><p><strong>loglevel</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Internal logger output level. Use 30 for warnings only, 20 for
verbose and 10 for debug mode.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If both <code class="docutils literal notranslate"><span class="pre">chi</span></code> and <code class="docutils literal notranslate"><span class="pre">truncation_fidelity</span></code> are fixed.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the value of <code class="docutils literal notranslate"><span class="pre">chi</span></code> is set below 2.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the value of <code class="docutils literal notranslate"><span class="pre">truncation_fidelity</span></code> is not in [0,1].</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.StructuredState">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytket.extensions.cutensornet.structured_state.</span></span><span class="sig-name descname"><span class="pre">StructuredState</span></span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#StructuredState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.StructuredState" title="Link to this definition">¶</a></dt>
<dd><p>Class representing a Tensor Network state.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.StructuredState.is_valid">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_valid</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#StructuredState.is_valid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.StructuredState.is_valid" title="Link to this definition">¶</a></dt>
<dd><p>Verify that the tensor network state is valid.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>False if a violation was detected or True otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.StructuredState.apply_gate">
<span class="sig-name descname"><span class="pre">apply_gate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gate</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#StructuredState.apply_gate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.StructuredState.apply_gate" title="Link to this definition">¶</a></dt>
<dd><p>Apply the command to the <cite>StructuredState</cite>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only one-qubit gates and two-qubit gates are supported.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>gate</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/circuit.html#pytket.circuit.Command" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Command</span></code></a></span>) – The command to be applied.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState" title="pytket.extensions.cutensornet.structured_state.general.StructuredState"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuredState</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">self</span></code>, to allow for method chaining.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – If the <code class="docutils literal notranslate"><span class="pre">CuTensorNetHandle</span></code> is out of scope.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the command introduced is not a unitary gate.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the command acts on more than 2 qubits.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.StructuredState.apply_unitary">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">apply_unitary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unitary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qubits</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#StructuredState.apply_unitary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.StructuredState.apply_unitary" title="Link to this definition">¶</a></dt>
<dd><p>Applies the unitary to the specified qubits of the StructuredState.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is assumed that the matrix provided by the user is unitary. If this is
not the case, the program will still run, but its behaviour is undefined.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>unitary</strong> (<span class="sphinx_autodoc_typehints-type">cp.ndarray</span>) – The matrix to be applied as a CuPy ndarray. It should either be
a 2x2 matrix if acting on one qubit or a 4x4 matrix if acting on two.</p></li>
<li><p><strong>qubits</strong> (<span class="sphinx_autodoc_typehints-type">list[Qubit]</span>) – The qubits the unitary acts on. Only one qubit and two qubit
unitaries are supported.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type">StructuredState</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">self</span></code>, to allow for method chaining.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – If the <code class="docutils literal notranslate"><span class="pre">CuTensorNetHandle</span></code> is out of scope.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the number of qubits provided is not one or two.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the size of the matrix does not match with the number of
    qubits provided.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.StructuredState.apply_scalar">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">apply_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scalar</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#StructuredState.apply_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.StructuredState.apply_scalar" title="Link to this definition">¶</a></dt>
<dd><p>Multiplies the state by a complex number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scalar</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">complex</span></code></a></span>) – The complex number to be multiplied.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState" title="pytket.extensions.cutensornet.structured_state.general.StructuredState"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuredState</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">self</span></code>, to allow for method chaining.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.StructuredState.apply_qubit_relabelling">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">apply_qubit_relabelling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qubit_map</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#StructuredState.apply_qubit_relabelling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.StructuredState.apply_qubit_relabelling" title="Link to this definition">¶</a></dt>
<dd><p>Relabels each qubit <code class="docutils literal notranslate"><span class="pre">q</span></code> as <code class="docutils literal notranslate"><span class="pre">qubit_map[q]</span></code>.</p>
<p>This does not apply any SWAP gate, nor it changes the internal structure of the
state. It simply changes the label of the physical bonds of the tensor network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qubit_map</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/unit_id.html#pytket.unit_id.Qubit" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Qubit</span></code></a>, <a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/unit_id.html#pytket.unit_id.Qubit" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Qubit</span></code></a>]</span>) – Dictionary mapping each qubit to its new label.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState" title="pytket.extensions.cutensornet.structured_state.general.StructuredState"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuredState</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">self</span></code>, to allow for method chaining.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If any of the keys in <code class="docutils literal notranslate"><span class="pre">qubit_map</span></code> are not qubits in the state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.StructuredState.vdot">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vdot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#StructuredState.vdot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.StructuredState.vdot" title="Link to this definition">¶</a></dt>
<dd><p>Obtain the inner product of the two states: <code class="docutils literal notranslate"><span class="pre">&lt;self|other&gt;</span></code>.</p>
<p>It can be used to compute the squared norm of a state <code class="docutils literal notranslate"><span class="pre">state</span></code> as
<code class="docutils literal notranslate"><span class="pre">state.vdot(state)</span></code>. The tensors within the state are not modified.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The state that is conjugated is <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState" title="pytket.extensions.cutensornet.structured_state.general.StructuredState"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuredState</span></code></a></span>) – The other <code class="docutils literal notranslate"><span class="pre">StructuredState</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">complex</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The resulting complex number.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – If the two states do not have the same qubits.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – If the <code class="docutils literal notranslate"><span class="pre">CuTensorNetHandle</span></code> is out of scope.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.StructuredState.sample">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#StructuredState.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.StructuredState.sample" title="Link to this definition">¶</a></dt>
<dd><p>Returns a sample from a Z measurement applied on every qubit.</p>
<p class="rubric">Notes</p>
<p>The contents of <code class="docutils literal notranslate"><span class="pre">self</span></code> are not updated. This is equivalent to applying
<code class="docutils literal notranslate"><span class="pre">state</span> <span class="pre">=</span> <span class="pre">self.copy()</span></code> then <code class="docutils literal notranslate"><span class="pre">state.measure(state.get_qubits())</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/unit_id.html#pytket.unit_id.Qubit" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Qubit</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary mapping each qubit in the state to its 0 or 1 outcome.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.StructuredState.measure">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">measure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">destructive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#StructuredState.measure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.StructuredState.measure" title="Link to this definition">¶</a></dt>
<dd><p>Applies a Z measurement on each of the <code class="docutils literal notranslate"><span class="pre">qubits</span></code>.</p>
<p class="rubric">Notes</p>
<p>After applying this function, <code class="docutils literal notranslate"><span class="pre">self</span></code> will contain the normalised
projected state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qubits</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code></a>[<a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/unit_id.html#pytket.unit_id.Qubit" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Qubit</span></code></a>]</span>) – The subset of qubits to be measured.</p></li>
<li><p><strong>destructive</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the resulting state will not contain the
measured qubits. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, these qubits will appear on the
state corresponding to the measurement outcome. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/unit_id.html#pytket.unit_id.Qubit" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Qubit</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary mapping the given <code class="docutils literal notranslate"><span class="pre">qubits</span></code> to their measurement outcome,
i.e. either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If an element in <code class="docutils literal notranslate"><span class="pre">qubits</span></code> is not a qubit in the state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.StructuredState.postselect">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">postselect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qubit_outcomes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#StructuredState.postselect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.StructuredState.postselect" title="Link to this definition">¶</a></dt>
<dd><p>Applies a postselection, updates the states and returns its probability.</p>
<p class="rubric">Notes</p>
<p>After applying this function, <code class="docutils literal notranslate"><span class="pre">self</span></code> will contain the projected
state over the non-postselected qubits.</p>
<p>The resulting state has been normalised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qubit_outcomes</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/unit_id.html#pytket.unit_id.Qubit" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Qubit</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>]</span>) – A dictionary mapping a subset of qubits to their
desired outcome value (either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code>).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The probability of this postselection to occur in a measurement.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If a key in <code class="docutils literal notranslate"><span class="pre">qubit_outcomes</span></code> is not a qubit in the state.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If a value in <code class="docutils literal notranslate"><span class="pre">qubit_outcomes</span></code> is other than <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If all of the qubits in the state are being postselected.
    Instead, you may wish to use <code class="docutils literal notranslate"><span class="pre">get_amplitude()</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.StructuredState.expectation_value">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">expectation_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pauli_string</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#StructuredState.expectation_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.StructuredState.expectation_value" title="Link to this definition">¶</a></dt>
<dd><p>Obtains the expectation value of the Pauli string observable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pauli_string</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/pauli.html#pytket.pauli.QubitPauliString" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">QubitPauliString</span></code></a></span>) – A pytket object representing a tensor product of Paulis.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The expectation value.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If a key in <code class="docutils literal notranslate"><span class="pre">pauli_string</span></code> is not a qubit in the state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.StructuredState.get_fidelity">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_fidelity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#StructuredState.get_fidelity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.StructuredState.get_fidelity" title="Link to this definition">¶</a></dt>
<dd><p>Returns the current fidelity of the state.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.StructuredState.get_statevector">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_statevector</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#StructuredState.get_statevector"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.StructuredState.get_statevector" title="Link to this definition">¶</a></dt>
<dd><p>Returns the statevector with qubits in Increasing Lexicographic Order (ILO).</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If there are no qubits left in the state.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.StructuredState.get_amplitude">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_amplitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#StructuredState.get_amplitude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.StructuredState.get_amplitude" title="Link to this definition">¶</a></dt>
<dd><p>Returns the amplitude of the chosen computational state.</p>
<p class="rubric">Notes</p>
<p>The result is equivalent to <code class="docutils literal notranslate"><span class="pre">state.get_statevector[b]</span></code>, but this method
is faster when querying a single amplitude (or just a few).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>state</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – The integer whose bitstring describes the computational state.
The qubits in the bitstring are in increasing lexicographic order.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">complex</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The amplitude of the computational state in <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.StructuredState.get_bits">
<span class="sig-name descname"><span class="pre">get_bits</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#StructuredState.get_bits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.StructuredState.get_bits" title="Link to this definition">¶</a></dt>
<dd><p>Returns the dictionary of bits and their values.</p>
<p>A bit with value <code class="docutils literal notranslate"><span class="pre">False</span></code> corresponds to <code class="docutils literal notranslate"><span class="pre">0</span></code>, and <code class="docutils literal notranslate"><span class="pre">True</span></code> is <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/unit_id.html#pytket.unit_id.Bit" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bit</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.StructuredState.get_qubits">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_qubits</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#StructuredState.get_qubits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.StructuredState.get_qubits" title="Link to this definition">¶</a></dt>
<dd><p>Returns the set of qubits that <code class="docutils literal notranslate"><span class="pre">self</span></code> is defined on.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">set</span></code></a>[<a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/unit_id.html#pytket.unit_id.Qubit" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Qubit</span></code></a>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.StructuredState.get_byte_size">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_byte_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#StructuredState.get_byte_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.StructuredState.get_byte_size" title="Link to this definition">¶</a></dt>
<dd><p>Returns the number of bytes <code class="docutils literal notranslate"><span class="pre">self</span></code> currently occupies in GPU memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.StructuredState.get_device_id">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_device_id</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#StructuredState.get_device_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.StructuredState.get_device_id" title="Link to this definition">¶</a></dt>
<dd><p>Returns the identifier of the device (GPU) where the tensors are stored.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.StructuredState.update_libhandle">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">update_libhandle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">libhandle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#StructuredState.update_libhandle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.StructuredState.update_libhandle" title="Link to this definition">¶</a></dt>
<dd><p>Update the <code class="docutils literal notranslate"><span class="pre">CuTensorNetHandle</span></code> used by <code class="docutils literal notranslate"><span class="pre">self</span></code>. Multiple
objects may use the same handle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>libhandle</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pytket.extensions.cutensornet.CuTensorNetHandle" title="pytket.extensions.cutensornet.general.CuTensorNetHandle"><code class="xref py py-class docutils literal notranslate"><span class="pre">CuTensorNetHandle</span></code></a></span>) – The new cuTensorNet library handle.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.13)"><strong>RuntimeError</strong></a> – If the device (GPU) where <code class="docutils literal notranslate"><span class="pre">libhandle</span></code> was initialised
    does not match the one where the tensors of <code class="docutils literal notranslate"><span class="pre">self</span></code> are stored.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.StructuredState.copy">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/general.html#StructuredState.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.StructuredState.copy" title="Link to this definition">¶</a></dt>
<dd><p>Returns a deep copy of <code class="docutils literal notranslate"><span class="pre">self</span></code> on the same device.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState" title="pytket.extensions.cutensornet.structured_state.general.StructuredState"><code class="xref py py-class docutils literal notranslate"><span class="pre">StructuredState</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.TTNxGate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytket.extensions.cutensornet.structured_state.</span></span><span class="sig-name descname"><span class="pre">TTNxGate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">libhandle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qubit_partition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/ttn_gate.html#TTNxGate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.TTNxGate" title="Link to this definition">¶</a></dt>
<dd><p>Implements a gate-by-gate contraction algorithm to calculate the output state
of a circuit as a <code class="docutils literal notranslate"><span class="pre">TTN</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.TTNxGate.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">libhandle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qubit_partition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.TTNxGate.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialise a TTN on the computational state <code class="docutils literal notranslate"><span class="pre">|0&gt;</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A <code class="docutils literal notranslate"><span class="pre">libhandle</span></code> should be created via a <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">CuTensorNet()</span> <span class="pre">as</span> <span class="pre">libhandle:</span></code>
statement. The device where the TTN is stored will match the one specified
by the library handle.</p>
<p>The current implementation requires the keys of <code class="docutils literal notranslate"><span class="pre">qubit_partition</span></code> to be
integers from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">2^l</span> <span class="pre">-</span> <span class="pre">1</span></code> for some <code class="docutils literal notranslate"><span class="pre">l</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>libhandle</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pytket.extensions.cutensornet.CuTensorNetHandle" title="pytket.extensions.cutensornet.general.CuTensorNetHandle"><code class="xref py py-class docutils literal notranslate"><span class="pre">CuTensorNetHandle</span></code></a></span>) – The cuTensorNet library handle that will be used to carry out
tensor operations on the TTN.</p></li>
<li><p><strong>qubit_partition</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/unit_id.html#pytket.unit_id.Qubit" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Qubit</span></code></a>]]</span>) – A partition of the qubits in the circuit into disjoint
groups, describing the hierarchical structure of the TTN. Each key
identifies a leaf of the TTN, with its corresponding value indicating
the list of qubits represented by the leaf. The leaves are numbered
from left to right on a planar representation of the tree. Hence, the
smaller half of the keys correspond to leaves in the left subtree and
the rest are in the right subtree; providing recursive bipartitions.</p></li>
<li><p><strong>config</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.Config" title="pytket.extensions.cutensornet.structured_state.general.Config"><code class="xref py py-class docutils literal notranslate"><span class="pre">Config</span></code></a></span>) – The object describing the configuration for simulation.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the keys of <code class="docutils literal notranslate"><span class="pre">qubit_partition</span></code> do not range from <code class="docutils literal notranslate"><span class="pre">0</span></code> to
    <code class="docutils literal notranslate"><span class="pre">2^l</span> <span class="pre">-</span> <span class="pre">1</span></code> for some <code class="docutils literal notranslate"><span class="pre">l</span></code>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If a <code class="docutils literal notranslate"><span class="pre">Qubit</span></code> is repeated in <code class="docutils literal notranslate"><span class="pre">qubit_partition</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.MPSxGate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytket.extensions.cutensornet.structured_state.</span></span><span class="sig-name descname"><span class="pre">MPSxGate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">libhandle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/mps_gate.html#MPSxGate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.MPSxGate" title="Link to this definition">¶</a></dt>
<dd><p>Implements a gate-by-gate contraction algorithm to calculate the output state
of a circuit as an <code class="docutils literal notranslate"><span class="pre">MPS</span></code>. The algorithm is described in:
<a class="reference external" href="https://arxiv.org/abs/2002.07730">https://arxiv.org/abs/2002.07730</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.MPSxGate.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">libhandle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.MPSxGate.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialise an MPS on the computational state <code class="docutils literal notranslate"><span class="pre">|0&gt;</span></code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A <code class="docutils literal notranslate"><span class="pre">libhandle</span></code> should be created via a <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">CuTensorNet()</span> <span class="pre">as</span> <span class="pre">libhandle:</span></code>
statement. The device where the MPS is stored will match the one specified
by the library handle.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>libhandle</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pytket.extensions.cutensornet.CuTensorNetHandle" title="pytket.extensions.cutensornet.general.CuTensorNetHandle"><code class="xref py py-class docutils literal notranslate"><span class="pre">CuTensorNetHandle</span></code></a></span>) – The cuTensorNet library handle that will be used to carry out
tensor operations on the MPS.</p></li>
<li><p><strong>qubits</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/unit_id.html#pytket.unit_id.Qubit" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Qubit</span></code></a>]</span>) – The list of qubits in the circuit to be simulated.</p></li>
<li><p><strong>config</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.Config" title="pytket.extensions.cutensornet.structured_state.general.Config"><code class="xref py py-class docutils literal notranslate"><span class="pre">Config</span></code></a></span>) – The object describing the configuration for simulation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.MPSxGate.add_qubit">
<span class="sig-name descname"><span class="pre">add_qubit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_qubit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.MPSxGate.add_qubit" title="Link to this definition">¶</a></dt>
<dd><p>Adds a qubit at the specified position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_qubit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/unit_id.html#pytket.unit_id.Qubit" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Qubit</span></code></a></span>) – The identifier of the qubit to be added to the state.</p></li>
<li><p><strong>position</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – The location the new qubit should be inserted at in the MPS.
Qubits on this and later indexed have their position shifted by 1.</p></li>
<li><p><strong>state</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Choose either <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code> for the new qubit’s state.
Defaults to <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPS</span></code></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">self</span></code>, to allow for method chaining.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">new_qubit</span></code> already exists in the state.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">position</span></code> is negative or larger than <code class="docutils literal notranslate"><span class="pre">len(self)</span></code>.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If <code class="docutils literal notranslate"><span class="pre">state</span></code> is not <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.MPSxMPO">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pytket.extensions.cutensornet.structured_state.</span></span><span class="sig-name descname"><span class="pre">MPSxMPO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">libhandle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/mps_mpo.html#MPSxMPO"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.MPSxMPO" title="Link to this definition">¶</a></dt>
<dd><p>Implements a batched–gate contraction algorithm (DMRG-like) to calculate
the output state of a circuit as an <code class="docutils literal notranslate"><span class="pre">MPS</span></code>. The algorithm is described
in: <a class="reference external" href="https://arxiv.org/abs/2207.05612">https://arxiv.org/abs/2207.05612</a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.MPSxMPO.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">libhandle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qubits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/mps_mpo.html#MPSxMPO.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.MPSxMPO.__init__" title="Link to this definition">¶</a></dt>
<dd><p>Initialise an MPS on the computational state <code class="docutils literal notranslate"><span class="pre">|0&gt;</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A <code class="docutils literal notranslate"><span class="pre">libhandle</span></code> should be created via a <code class="docutils literal notranslate"><span class="pre">with</span> <span class="pre">CuTensorNet()</span> <span class="pre">as</span> <span class="pre">libhandle:</span></code>
statement. The device where the MPS is stored will match the one specified
by the library handle.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>libhandle</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pytket.extensions.cutensornet.CuTensorNetHandle" title="pytket.extensions.cutensornet.general.CuTensorNetHandle"><code class="xref py py-class docutils literal notranslate"><span class="pre">CuTensorNetHandle</span></code></a></span>) – The cuTensorNet library handle that will be used to carry out
tensor operations on the MPS.</p></li>
<li><p><strong>qubits</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/unit_id.html#pytket.unit_id.Qubit" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Qubit</span></code></a>]</span>) – The list of qubits in the circuit to be simulated.</p></li>
<li><p><strong>config</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.Config" title="pytket.extensions.cutensornet.structured_state.general.Config"><code class="xref py py-class docutils literal notranslate"><span class="pre">Config</span></code></a></span>) – The object describing the configuration for simulation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="miscellaneous">
<h2>Miscellaneous<a class="headerlink" href="#miscellaneous" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="pytket.extensions.cutensornet.structured_state.prepare_circuit_mps">
<span class="sig-prename descclassname"><span class="pre">pytket.extensions.cutensornet.structured_state.</span></span><span class="sig-name descname"><span class="pre">prepare_circuit_mps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">circuit</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pytket/extensions/cutensornet/structured_state/simulation.html#prepare_circuit_mps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pytket.extensions.cutensornet.structured_state.prepare_circuit_mps" title="Link to this definition">¶</a></dt>
<dd><p>Adds SWAP gates to the circuit so that all gates act on adjacent qubits.</p>
<p>The qubits in the output circuit will be renamed. Implicit SWAPs may be added
to the circuit, meaning that the logical qubit held at the <code class="docutils literal notranslate"><span class="pre">node[i]</span></code> qubit
at the beginning of the circuit may differ from the one it holds at the end.
Consider applying <code class="docutils literal notranslate"><span class="pre">apply_qubit_relabelling</span></code> on the MPS after simulation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This preprocessing is <em>not</em> required by the MPS algorithms we provide.
Shallow circuits tend to run faster if this preprocessing is <em>not</em> used.
In occassions, it has been shown to improve runtime for deep circuits.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>circuit</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/circuit_class.html#pytket.circuit.Circuit" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Circuit</span></code></a></span>) – The circuit to be simulated.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/circuit_class.html#pytket.circuit.Circuit" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Circuit</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/unit_id.html#pytket.unit_id.Qubit" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Qubit</span></code></a>, <a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/unit_id.html#pytket.unit_id.Qubit" title="(in Project name not set)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Qubit</span></code></a>]]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple with an equivalent circuit with the appropriate structure and a
map of qubit names at the end of the circuit to their corresponding
original names.</p>
</dd>
</dl>
</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../examples/general_state_tutorial.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><code class="docutils literal notranslate"><span class="pre">GeneralState</span></code> Tutorial</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="general_state.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">General state (exact) simulation</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
              Copyright &#169; 2024 Quantinuum Ltd. All rights reserved.
            </div>
            <div class="terms" style="display:flex; gap:0.5rem; align-items:center; margin: 0.25rem 0rem;">
              <a href="https://www.quantinuum.com/privacy-statement" target="_blank">Privacy Statement</a>
              <div role="separator">/</div>
              <a href="https://www.quantinuum.com/cookie-notice" target="_blank">Cookie Notice</a>
              <div role="separator">/</div>
              <a href="https://www.quantinuum.com/terms-conditions" target="_blank">Terms and Conditions</a>
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Structured state evolution</a><ul>
<li><a class="reference internal" href="#library-handle">Library handle</a><ul>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.CuTensorNetHandle"><code class="docutils literal notranslate"><span class="pre">CuTensorNetHandle</span></code></a><ul>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.CuTensorNetHandle.handle"><code class="docutils literal notranslate"><span class="pre">CuTensorNetHandle.handle</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.CuTensorNetHandle.device_id"><code class="docutils literal notranslate"><span class="pre">CuTensorNetHandle.device_id</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.CuTensorNetHandle.destroy"><code class="docutils literal notranslate"><span class="pre">CuTensorNetHandle.destroy()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#simulation">Simulation</a><ul>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.simulate"><code class="docutils literal notranslate"><span class="pre">simulate()</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.SimulationAlgorithm"><code class="docutils literal notranslate"><span class="pre">SimulationAlgorithm</span></code></a><ul>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.SimulationAlgorithm.TTNxGate"><code class="docutils literal notranslate"><span class="pre">SimulationAlgorithm.TTNxGate</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.SimulationAlgorithm.MPSxGate"><code class="docutils literal notranslate"><span class="pre">SimulationAlgorithm.MPSxGate</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.SimulationAlgorithm.MPSxMPO"><code class="docutils literal notranslate"><span class="pre">SimulationAlgorithm.MPSxMPO</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.Config"><code class="docutils literal notranslate"><span class="pre">Config</span></code></a><ul>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.Config.__init__"><code class="docutils literal notranslate"><span class="pre">Config.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#classes">Classes</a><ul>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState"><code class="docutils literal notranslate"><span class="pre">StructuredState</span></code></a><ul>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState.is_valid"><code class="docutils literal notranslate"><span class="pre">StructuredState.is_valid()</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState.apply_gate"><code class="docutils literal notranslate"><span class="pre">StructuredState.apply_gate()</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState.apply_unitary"><code class="docutils literal notranslate"><span class="pre">StructuredState.apply_unitary()</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState.apply_scalar"><code class="docutils literal notranslate"><span class="pre">StructuredState.apply_scalar()</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState.apply_qubit_relabelling"><code class="docutils literal notranslate"><span class="pre">StructuredState.apply_qubit_relabelling()</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState.vdot"><code class="docutils literal notranslate"><span class="pre">StructuredState.vdot()</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState.sample"><code class="docutils literal notranslate"><span class="pre">StructuredState.sample()</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState.measure"><code class="docutils literal notranslate"><span class="pre">StructuredState.measure()</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState.postselect"><code class="docutils literal notranslate"><span class="pre">StructuredState.postselect()</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState.expectation_value"><code class="docutils literal notranslate"><span class="pre">StructuredState.expectation_value()</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState.get_fidelity"><code class="docutils literal notranslate"><span class="pre">StructuredState.get_fidelity()</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState.get_statevector"><code class="docutils literal notranslate"><span class="pre">StructuredState.get_statevector()</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState.get_amplitude"><code class="docutils literal notranslate"><span class="pre">StructuredState.get_amplitude()</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState.get_bits"><code class="docutils literal notranslate"><span class="pre">StructuredState.get_bits()</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState.get_qubits"><code class="docutils literal notranslate"><span class="pre">StructuredState.get_qubits()</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState.get_byte_size"><code class="docutils literal notranslate"><span class="pre">StructuredState.get_byte_size()</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState.get_device_id"><code class="docutils literal notranslate"><span class="pre">StructuredState.get_device_id()</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState.update_libhandle"><code class="docutils literal notranslate"><span class="pre">StructuredState.update_libhandle()</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.StructuredState.copy"><code class="docutils literal notranslate"><span class="pre">StructuredState.copy()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.TTNxGate"><code class="docutils literal notranslate"><span class="pre">TTNxGate</span></code></a><ul>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.TTNxGate.__init__"><code class="docutils literal notranslate"><span class="pre">TTNxGate.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.MPSxGate"><code class="docutils literal notranslate"><span class="pre">MPSxGate</span></code></a><ul>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.MPSxGate.__init__"><code class="docutils literal notranslate"><span class="pre">MPSxGate.__init__()</span></code></a></li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.MPSxGate.add_qubit"><code class="docutils literal notranslate"><span class="pre">MPSxGate.add_qubit()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.MPSxMPO"><code class="docutils literal notranslate"><span class="pre">MPSxMPO</span></code></a><ul>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.MPSxMPO.__init__"><code class="docutils literal notranslate"><span class="pre">MPSxMPO.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#miscellaneous">Miscellaneous</a><ul>
<li><a class="reference internal" href="#pytket.extensions.cutensornet.structured_state.prepare_circuit_mps"><code class="docutils literal notranslate"><span class="pre">prepare_circuit_mps()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    </body>
</html>