<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YPQ1FTGDL3"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-YPQ1FTGDL3');
    </script>
    <link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" />

    <link rel="shortcut icon" href="../_static/quantinuum_favicon.svg"/><!-- Generated with Sphinx 6.2.1 and Furo 2024.08.06 -->
        <title>Hamiltonians for Embedding methods - InQuanto 4.2.0</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=04c057b233f3c8d71940eee6080f658a04e2027d" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=cf727022eb7470bc603c08d2e55c3247faec75c9" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style>
<link rel="stylesheet" href="../_static/tokens.css"/>
<link rel="stylesheet" href="../_static/styles.css"/>
<link rel="stylesheet" href="../_static/tailwind.css"/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="preload"
as="style">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">

<style>  
  .sidebar-sticky {
    top: calc(3.5rem - 0px);
    height: calc(100vh - 3.5rem);
  }
  
  @media (min-width: 97em) {
    html {
      font-size: 100% !important;
    }
  }
  
</style>
</head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>
<!-- <script type="text/javascript" src="../_static/syncTheme.global.js" ></script> -->
 <!--Force light mode -->
 <script>document.body.setAttribute('data-theme','light')</script>
<nav style="position:fixed;top:0;z-index:1021;width:100%;">
    <div class="nexus-nav"></div>
</nav>
<script type="text/javascript" src="../_static/injectNav.global.js"></script>
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">InQuanto 4.2.0</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/inquanto_short_logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">InQuanto 4.2.0</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction/overview.html">What is InQuanto?</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/installation.html">Installation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Installation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/system_requirements.html">System Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/troubleshooting.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/quickstart.html">Quick-start</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../manual/howto.html">How to use InQuanto</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../manual/algorithms_overview.html">Algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Algorithms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../manual/algorithms/variational_overview.html">Variational Algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Variational Algorithms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/algorithms_vqe.html">Variational Quantum Eigensolver <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmVQE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/algorithms_vqd.html">Variational Quantum Deflation <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmVQD</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/algorithms_adapt.html">ADAPT-VQE</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../manual/algorithms/non_variational_overview.html">Non-variational and Phase Estimation algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Non-variational and Phase Estimation algorithms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/algorithms_qse.html">Quantum Subspace Expansion <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmQSE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/algorithms_sceom.html">Quantum Self Consistent Equation of Motion <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmSCEOM</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/qpe_canonical.html">Canonical Quantum Phase Estimation <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmDeterministicQPE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/qpe_iterative.html">Iterative Phase Estimation Algorithms</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../manual/algorithms/time_evolution_overview.html">Time evolution algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Time evolution algorithms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/te_vqs.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmVQS</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmMcLachlanRealTime</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmMcLachlanImagTime</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../manual/computables_overview.html">Computables</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Computables</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../manual/computables/basic_usage.html">Basic Usage and Composability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/computables/evaluating_w_protocols.html">Evaluating Computables with Protocols</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../manual/computables/composite_computables.html">Composite Computables</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Composite Computables</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../manual/computables/greens_function.html">Krylov subspace &amp; Green’s functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/computables/rdms.html">Reduced Density Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/computables/overlap_matrix.html">Overlap Matrices &amp; Non-Orthogonal Subspaces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../manual/computables/primitives.html">Primitive Computables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/computables/custom_computables.html">Custom Computables &amp; Partial Evaluations</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../manual/protocols_overview.html">Protocols</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Protocols</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/expval.html">Protocols for expectation values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/overlap_squared.html">Protocols for overlap squared</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/overlap.html">Protocols for overlaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/derivative.html">Protocols for derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/other.html">Other averaging protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/phase_est.html">Protocols for Phase Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/resource_estimation.html">Resource estimation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../manual/errmit.html">Noise mitigation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/spaces.html">Spaces, Operators, and States</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../manual/ansatzae_overview.html">Ansatzes</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Ansatzes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/ucc_family.html">The UCC Family</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/chemically_aware.html">Chemically Aware Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/trotter_ansatz.html">Trotter Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/fermion_state_exp.html">Fermionic Exponentiated Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/circuit_ansatz.html">Circuit Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/composed_ansatz.html">Composed Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/hea.html">Hardware Efficient Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/multi_configurational.html">Multiconfiguration States Using Givens Rotations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/basis_rotation.html">Real Basis Rotation Ansatzes</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../manual/symmetry.html">Symmetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/geometry.html">Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/minimizers.html">Classical Minimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/dmet.html">Density Matrix Embedding Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/express.html">Express</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials &amp; Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tutorial_overview.html">Tutorials</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/tutorial_overview.html#core-tutorials">Core Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Core Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/InQ_tut_vqe_1.html">A basic VQE simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/InQ_tut_vqe_2.html">Extended VQE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/InQ_tut_vqd.html">Variational Quantum Deflation for excited states</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/InQ_tut_viz.html">Visualization with inquanto-nglview</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/tutorial_overview.html#backend-tutorials">Backend Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Backend Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/backends_overview.html">Backends Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/InQ_tut_Nexus_1.html"><b>Tutorial: InQuanto + qnexus</b></a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/InQ_htut_Aer_H2.html">Running on the Aer simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/InQ_htut_qsys_H2.html">Running on Quantinuum Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/InQ_htut_qsys_l%2Br.html">Quantinuum Systems -  Launching circuits and retrieving results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/InQ_htut_qsys_qse.html">Quantinuum Systems -  Quantum Subspace Expansion</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/tutorial_overview.html#case-study-tutorials-fe4n2">Case Study Tutorials - Fe4N2</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Case Study Tutorials - Fe4N2</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/InQ_tut_fe4n2_1.html">Fe4N2 - 1 - system construction with AVAS and CASSCF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/InQ_tut_fe4n2_2.html">Fe4N2 - 2 - circuit construction with ADAPT-VQE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/InQ_tut_fe4n2_3.html">Fe4N2 - 3 - calculations on Quantinuum hardware</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/tutorial_overview.html#fragmentation-tutorials">Fragmentation Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Fragmentation Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/InQ_tut_dmet.html">Tackling larger systems with fragmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/InQ_tut_wft_dft.html">Projection-based embedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/InQ_tut_nevpt2_AC0.html">NEVPT2 and AC0 energy corrections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/InQ_tut_wft_dft_2.html">Projection-based embedding with energy corrections</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/examples_overview.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extensions User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="extensions-overview.html">Extensions overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="inquanto-nexus.html">InQuanto-Nexus</a></li>
<li class="toctree-l1"><a class="reference internal" href="inquanto-pyscf.html">InQuanto-PySCF</a></li>
<li class="toctree-l1"><a class="reference internal" href="inquanto-nglview.html">InQuanto-NGLView</a></li>
<li class="toctree-l1"><a class="reference internal" href="inquanto-phayes.html">InQuanto-Phayes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="extensions_examples.html">Extensions examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/inquanto_api_intro.html">InQuanto</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of InQuanto</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/algorithms.html">inquanto.algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/ansatz.html">inquanto.ansatzes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/computables.html">inquanto.computables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/core.html">inquanto.core</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/embeddings.html">inquanto.embeddings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/express.html">inquanto.express</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/geometry.html">inquanto.geometries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/mappings.html">inquanto.mappings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/minimizers.html">inquanto.minimizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/operators.html">inquanto.operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/protocols.html">inquanto.protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/spaces.html">inquanto.spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/states.html">inquanto.states</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/symmetry.html">inquanto.symmetry</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/inquanto-ext_api_intro.html">InQuanto-Extensions</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of InQuanto-Extensions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/extensions/inquanto-nexus_api.html">InQuanto-Nexus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html">InQuanto-PySCF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/extensions/inquanto-nglview_api.html">InQuanto-NGLView</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/extensions/inquanto-phayes.html">InQuanto-Phayes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/extensions/inquanto-cutensornet_api.html">InQuanto-cuTensorNet</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../misc/changelog.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/contact.html">Contact Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/cite.html">How to cite InQuanto</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/licence.html">License and Notices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/opensource.html">Open-source Attribution</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="hamiltonians-for-embedding-methods">
<span id="embedding-hams"></span><h1>Hamiltonians for Embedding methods<a class="headerlink" href="#hamiltonians-for-embedding-methods" title="Permalink to this heading">¶</a></h1>
<p>PySCF drivers provide an interface to various orbital localization schemes and a wide range of high-level chemistry
methods. These can be utilized in a fragment solver for Density Matrix Embedding Theory (DMET) and Fragment
Molecular Orbital (FMO) embedding methods.</p>
<p>Prior to an embedding algorithm one needs to generate a Hamiltonian
with a localized and orthonormal basis or atomic orbitals, in which spatial fragments can
be specified. To this end, PySCF drivers can generate the Löwdin representation of a system
with the <a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.ChemistryDriverPySCFMolecularRHF.get_lowdin_system" title="inquanto.extensions.pyscf.ChemistryDriverPySCFMolecularRHF.get_lowdin_system"><code class="xref py py-class docutils literal notranslate"><span class="pre">get_lowdin_system</span></code></a> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">driver</span> <span class="o">=</span> <span class="n">ChemistryDriverPySCFMolecularRHF</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="s2">&quot;sto-3g&quot;</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">g</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">hamiltonian_operator_lowdin</span><span class="p">,</span> <span class="n">space</span><span class="p">,</span> <span class="n">rdm1_hf_lowdin</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">get_lowdin_system</span><span class="p">()</span>
</pre></div>
</div>
<p>which performs a full Hartree-Fock calculation, and returns the 1-RDM in the localized basis. This
representation is required for DMET calculations.</p>
<p>Additionally, for FMO calculations, one may use the <a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.ChemistryDriverPySCFMolecularRHF.get_system_ao" title="inquanto.extensions.pyscf.ChemistryDriverPySCFMolecularRHF.get_system_ao"><code class="xref py py-class docutils literal notranslate"><span class="pre">get_system_ao</span></code></a>
method to generate a <a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.PySCFChemistryRestrictedIntegralOperator" title="inquanto.extensions.pyscf.PySCFChemistryRestrictedIntegralOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PySCFChemistryRestrictedIntegralOperator</span></code></a> which,
internally, has access to the atomic orbitals for generating fragment Hamiltonians:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">driver</span> <span class="o">=</span> <span class="n">ChemistryDriverPySCFMolecularRHF</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="s2">&quot;sto-3g&quot;</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">g</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">hamiltonian_operator_pyscf</span><span class="p">,</span> <span class="n">space</span><span class="p">,</span> <span class="n">rdm1_hf_pyscf</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">get_system_ao</span><span class="p">(</span><span class="n">run_hf</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>where the <code class="docutils literal notranslate"><span class="pre">run_hf=False</span></code> option prevents a full Hartree-Fock calculation over the entire system.</p>
<p>The general API of both DMET and FMO has two types of classes that are necessary to perform a calculation:
one that is responsible for the total system with the embedding method itself,
and another that is responsible to compute the high-level solution of a particular fragment. For example,
as it is discussed in the <a class="reference internal" href="../manual/dmet.html#dmet"><span class="std std-ref">Density Matrix Embedding Theory section</span></a>, there is an
<a class="reference internal" href="../api/inquanto/embeddings.html#inquanto.embeddings.dmet.ImpurityDMETROHF" title="inquanto.embeddings.dmet.ImpurityDMETROHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImpurityDMETROHF</span></code></a> class driving the embedding method, and there are
fragment solver classes such as <a class="reference internal" href="../api/inquanto/embeddings.html#inquanto.embeddings.dmet.ImpurityDMETROHFFragmentED" title="inquanto.embeddings.dmet.ImpurityDMETROHFFragmentED"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImpurityDMETROHFFragmentED</span></code></a>. Similarly
for FMO we have the <a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.fmo.FMO" title="inquanto.extensions.pyscf.fmo.FMO"><code class="xref py py-class docutils literal notranslate"><span class="pre">inquanto.extensions.pyscf.fmo.FMO</span></code></a> and
<a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.fmo.FMOFragmentPySCFCCSD" title="inquanto.extensions.pyscf.fmo.FMOFragmentPySCFCCSD"><code class="xref py py-class docutils literal notranslate"><span class="pre">inquanto.extensions.pyscf.fmo.FMOFragmentPySCFCCSD</span></code></a>, for example.</p>
</section>
<section id="dmet-with-pyscf-fragment-solvers">
<h1>DMET with PySCF fragment solvers<a class="headerlink" href="#dmet-with-pyscf-fragment-solvers" title="Permalink to this heading">¶</a></h1>
<p>Here we outline the use of PySCF calculators as fragment solvers for both Impurity DMET and full DMET with InQuanto.
The reader is referred to the <a class="reference internal" href="../manual/dmet.html#dmet"><span class="std std-ref">main DMET section</span></a> for an introduction.</p>
<section id="impurity-dmet">
<h2>Impurity DMET<a class="headerlink" href="#impurity-dmet" title="Permalink to this heading">¶</a></h2>
<p>InQuanto’s core packages provide a simple exact diagonalization solver and a Hartree-Fock fragment solver for impurity
DMET. <a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#module-inquanto.extensions.pyscf" title="inquanto.extensions.pyscf"><code class="xref py py-mod docutils literal notranslate"><span class="pre">inquanto-pyscf</span></code></a> provides additional fragment solvers:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.ImpurityDMETROHFFragmentPySCFFCI" title="inquanto.extensions.pyscf.ImpurityDMETROHFFragmentPySCFFCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">inquanto.extensions.pyscf.ImpurityDMETROHFFragmentPySCFFCI</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.ImpurityDMETROHFFragmentPySCFMP2" title="inquanto.extensions.pyscf.ImpurityDMETROHFFragmentPySCFMP2"><code class="xref py py-class docutils literal notranslate"><span class="pre">inquanto.extensions.pyscf.ImpurityDMETROHFFragmentPySCFMP2</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.ImpurityDMETROHFFragmentPySCFCCSD" title="inquanto.extensions.pyscf.ImpurityDMETROHFFragmentPySCFCCSD"><code class="xref py py-class docutils literal notranslate"><span class="pre">inquanto.extensions.pyscf.ImpurityDMETROHFFragmentPySCFCCSD</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.ImpurityDMETROHFFragmentPySCFROHF" title="inquanto.extensions.pyscf.ImpurityDMETROHFFragmentPySCFROHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">inquanto.extensions.pyscf.ImpurityDMETROHFFragmentPySCFROHF</span></code></a></p></li>
</ul>
<p>Provided we have the Hamiltonian and the density matrix in a <a class="reference internal" href="inquanto-pyscf.html#embedding-hams"><span class="std std-ref">localized basis</span></a> we can run the
single fragment Impurity DMET method. Below we consider a Hamiltonian computed with the Löwdin transformation, with
6 spatial orbitals. The <a class="reference internal" href="../api/inquanto/embeddings.html#inquanto.embeddings.dmet.ImpurityDMETROHF" title="inquanto.embeddings.dmet.ImpurityDMETROHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImpurityDMETROHF</span></code></a> class is initialized as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.embeddings</span><span class="w"> </span><span class="kn">import</span> <span class="n">ImpurityDMETROHF</span>

<span class="n">dmet</span> <span class="o">=</span> <span class="n">ImpurityDMETROHF</span><span class="p">(</span>
    <span class="n">hamiltonian_operator_lowdin</span><span class="p">,</span> <span class="n">rdm1_hf_lowdin</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The class name of <a class="reference internal" href="../api/inquanto/embeddings.html#inquanto.embeddings.dmet.ImpurityDMETROHF" title="inquanto.embeddings.dmet.ImpurityDMETROHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImpurityDMETROHF</span></code></a> denotes that this method assumes the Hamiltonian
operator and the 1-RDM are spin restricted. After this initialization, a fragment and a corresponding fragment
solver are specified in the following way:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="kn">import</span> <span class="n">array</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.extensions.pyscf</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">ImpurityDMETROHFFragmentPySCFFCI</span><span class="p">,</span>
    <span class="n">ImpurityDMETROHFFragmentPySCFMP2</span><span class="p">,</span>
    <span class="n">ImpurityDMETROHFFragmentPySCFCCSD</span><span class="p">,</span>
    <span class="n">ImpurityDMETROHFFragmentPySCFROHF</span><span class="p">,</span>
    <span class="n">ImpurityDMETROHFFragmentPySCFActive</span>
 <span class="p">)</span>

<span class="n">mask</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
<span class="n">fragment</span> <span class="o">=</span> <span class="n">ImpurityDMETROHFFragmentPySCFFCI</span><span class="p">(</span><span class="n">dmet</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.ImpurityDMETROHFFragmentPySCFFCI" title="inquanto.extensions.pyscf.ImpurityDMETROHFFragmentPySCFFCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImpurityDMETROHFFragmentPySCFFCI</span></code></a> defines the high-level solver for the
fragment, which in this case is an FCI method. The fragment solver is initialized with the <code class="docutils literal notranslate"><span class="pre">dmet</span></code> object and the
fragment mask <code class="docutils literal notranslate"><span class="pre">mask</span></code>. The <code class="docutils literal notranslate"><span class="pre">mask</span></code> is a boolean array with the length of the number of localized spatial orbitals.
The <code class="docutils literal notranslate"><span class="pre">True</span></code> values in the mask select the indices of the localized spatial orbitals that belongs to the fragment.</p>
<p>Finally the embedding method can be run as usual:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">dmet</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fragment</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="one-shot-dmet-and-full-dmet">
<h2>One-shot DMET and full DMET<a class="headerlink" href="#one-shot-dmet-and-full-dmet" title="Permalink to this heading">¶</a></h2>
<p>In practice, we maybe want to deal with larger molecules, and with multiple fragments. To handle multiple fragments
we need to use the one-shot DMET or full DMET methods, both covered by the class <a class="reference internal" href="../api/inquanto/embeddings.html#inquanto.embeddings.dmet.DMETRHF" title="inquanto.embeddings.dmet.DMETRHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">inquanto.embeddings.dmet.DMETRHF</span></code></a>.
Similarly to impurity DMET, <a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#module-inquanto.extensions.pyscf" title="inquanto.extensions.pyscf"><code class="xref py py-mod docutils literal notranslate"><span class="pre">inquanto-pyscf</span></code></a> includes a range of PySCF-driven
fragment solvers:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.DMETRHFFragmentPySCFFCI" title="inquanto.extensions.pyscf.DMETRHFFragmentPySCFFCI"><code class="xref py py-class docutils literal notranslate"><span class="pre">inquanto.extensions.pyscf.DMETRHFFragmentPySCFFCI</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.DMETRHFFragmentPySCFRHF" title="inquanto.extensions.pyscf.DMETRHFFragmentPySCFRHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">inquanto.extensions.pyscf.DMETRHFFragmentPySCFRHF</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.DMETRHFFragmentPySCFCCSD" title="inquanto.extensions.pyscf.DMETRHFFragmentPySCFCCSD"><code class="xref py py-class docutils literal notranslate"><span class="pre">inquanto.extensions.pyscf.DMETRHFFragmentPySCFCCSD</span></code></a></p></li>
<li><p><a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.DMETRHFFragmentPySCFMP2" title="inquanto.extensions.pyscf.DMETRHFFragmentPySCFMP2"><code class="xref py py-class docutils literal notranslate"><span class="pre">inquanto.extensions.pyscf.DMETRHFFragmentPySCFMP2</span></code></a></p></li>
</ul>
<p>Here we consider the example of phenol:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.geometries</span><span class="w"> </span><span class="kn">import</span> <span class="n">GeometryMolecular</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.embeddings.dmet</span><span class="w"> </span><span class="kn">import</span> <span class="n">DMETRHF</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.extensions.pyscf</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">get_fragment_orbital_masks</span><span class="p">,</span>
    <span class="n">get_fragment_orbitals</span><span class="p">,</span>
    <span class="n">ChemistryDriverPySCFMolecularRHF</span><span class="p">,</span>
    <span class="n">DMETRHFFragmentPySCFCCSD</span><span class="p">,</span>
    <span class="n">DMETRHFFragmentPySCFMP2</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Phenol (C6H5OH)</span>

<span class="c1"># Setup the system - Phenol geometry</span>
<span class="n">geometry</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.921240800</span><span class="p">,</span>  <span class="mf">0.001254500</span><span class="p">,</span>  <span class="mf">0.000000000</span><span class="p">]],</span>
        <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.223482600</span><span class="p">,</span>  <span class="mf">1.216975000</span><span class="p">,</span>  <span class="mf">0.000000000</span><span class="p">]],</span>
        <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mf">1.176941000</span><span class="p">,</span>  <span class="mf">1.209145000</span><span class="p">,</span>  <span class="mf">0.000000000</span><span class="p">]],</span>
        <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mf">1.882124000</span><span class="p">,</span>  <span class="mf">0.000763689</span><span class="p">,</span>  <span class="mf">0.000000000</span><span class="p">]],</span>
        <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mf">1.171469000</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.208183000</span><span class="p">,</span>  <span class="mf">0.000000000</span><span class="p">]],</span>
        <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.225726600</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.216305000</span><span class="p">,</span>  <span class="mf">0.000000000</span><span class="p">]],</span>
        <span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.284492000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.060545780</span><span class="p">,</span>  <span class="mf">0.000000000</span><span class="p">]],</span>
        <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.771286100</span><span class="p">,</span>  <span class="mf">2.161194000</span><span class="p">,</span>  <span class="mf">0.000000000</span><span class="p">]],</span>
        <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mf">1.715459000</span><span class="p">,</span>  <span class="mf">2.156595000</span><span class="p">,</span>  <span class="mf">0.000000000</span><span class="p">]],</span>
        <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mf">2.970767000</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.000448048</span><span class="p">,</span>  <span class="mf">0.000000000</span><span class="p">]],</span>
        <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mf">1.709985000</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.155694000</span><span class="p">,</span>  <span class="mf">0.000000000</span><span class="p">]],</span>
        <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.792751600</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.145930000</span><span class="p">,</span>  <span class="mf">0.000000000</span><span class="p">]],</span>
        <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mf">2.630400000</span><span class="p">,</span>  <span class="mf">0.901564000</span><span class="p">,</span>  <span class="mf">0.000000000</span><span class="p">]]]</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">GeometryMolecular</span><span class="p">(</span><span class="n">geometry</span><span class="p">)</span>

<span class="n">driver</span> <span class="o">=</span> <span class="n">ChemistryDriverPySCFMolecularRHF</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="s2">&quot;sto-3g&quot;</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">g</span><span class="o">.</span><span class="n">xyz</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">hamiltonian_operator</span><span class="p">,</span> <span class="n">space</span><span class="p">,</span> <span class="n">rdm1</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">get_lowdin_system</span><span class="p">()</span>

<span class="n">maskOH</span><span class="p">,</span> <span class="n">maskCCH</span><span class="p">,</span> <span class="n">maskCHCH1</span><span class="p">,</span> <span class="n">maskCHCH2</span> <span class="o">=</span> <span class="n">get_fragment_orbital_masks</span><span class="p">(</span>
<span class="n">driver</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">dmet</span> <span class="o">=</span> <span class="n">DMETRHF</span><span class="p">(</span><span class="n">hamiltonian_operator</span><span class="p">,</span> <span class="n">rdm1</span><span class="p">)</span>

<span class="n">frOH</span> <span class="o">=</span> <span class="n">DMETRHFFragmentPySCFCCSD</span><span class="p">(</span><span class="n">dmet</span><span class="p">,</span> <span class="n">maskOH</span><span class="p">)</span>
<span class="n">frCCH</span> <span class="o">=</span> <span class="n">DMETRHFFragmentPySCFCCSD</span><span class="p">(</span><span class="n">dmet</span><span class="p">,</span> <span class="n">maskCCH</span><span class="p">)</span>
<span class="n">frCHCH1</span> <span class="o">=</span> <span class="n">DMETRHFFragmentPySCFMP2</span><span class="p">(</span><span class="n">dmet</span><span class="p">,</span> <span class="n">maskCHCH1</span><span class="p">)</span>
<span class="n">frCHCH2</span> <span class="o">=</span> <span class="n">DMETRHFFragmentPySCFCCSD</span><span class="p">(</span><span class="n">dmet</span><span class="p">,</span> <span class="n">maskCHCH2</span><span class="p">)</span>

<span class="n">fragments</span> <span class="o">=</span> <span class="p">[</span><span class="n">frOH</span><span class="p">,</span> <span class="n">frCCH</span><span class="p">,</span> <span class="n">frCHCH1</span><span class="p">,</span> <span class="n">frCHCH2</span><span class="p">]</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">dmet</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fragments</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span># STARTING CHEMICAL POTENTIAL 0.0
# STARTING CORR POTENTIAL PARAMETERS []

# FULL SCF ITERATION 0
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span># NEWTON ITERATION - CHEMICAL POTENTIAL 0.0
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span># FRAGMENT 0 - None: &lt;H&gt;=-301.7956772445181  EFR=-114.78345837272906  Q=-0.04983881865461548 
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span># FRAGMENT 1 - None: &lt;H&gt;=-301.90654101502673  EFR=-152.88306683468312  Q=-0.005690013606134414 
# FRAGMENT 2 - None: &lt;H&gt;=-301.9101535819722  EFR=-150.83827026648902  Q=-0.0014970562587297565 
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span># FRAGMENT 3 - None: &lt;H&gt;=-301.9444865391345  EFR=-153.44135729451497  Q=-0.00474978212665178 
# NEWTON ITERATION - CHEMICAL POTENTIAL 0.0001
# FRAGMENT 0 - None: &lt;H&gt;=-301.7965762435461  EFR=-114.78406015411964  Q=-0.04973186128699858 
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span># FRAGMENT 1 - None: &lt;H&gt;=-301.90783538929065  EFR=-152.88478642548097  Q=-0.005423346447392063 
# FRAGMENT 2 - None: &lt;H&gt;=-301.9115539401097  EFR=-150.8396128507567  Q=-0.0012572548814251405 
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span># FRAGMENT 3 - None: &lt;H&gt;=-301.9458871008677  EFR=-153.44262085160915  Q=-0.004532549349265835 
# NEWTON ITERATION - CHEMICAL POTENTIAL 0.007436949983843826
# FRAGMENT 0 - None: &lt;H&gt;=-301.86256397736537  EFR=-114.82804988189312  Q=-0.04191500418032135 
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span># FRAGMENT 1 - None: &lt;H&gt;=-302.0028761208724  EFR=-153.01088118923417  Q=0.014138160575985381 
# FRAGMENT 2 - None: &lt;H&gt;=-302.01436028232087  EFR=-150.93805407032525  Q=0.016332731510205534 
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span># FRAGMENT 3 - None: &lt;H&gt;=-302.04870529436  EFR=-153.53530162450303  Q=0.011407964500683931 
# NEWTON ITERATION - CHEMICAL POTENTIAL 0.007441304209973311
# FRAGMENT 0 - None: &lt;H&gt;=-301.8626031555275  EFR=-114.82807589346396  Q=-0.041910382966175774 
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span># FRAGMENT 1 - None: &lt;H&gt;=-302.0029325671195  EFR=-153.01095598148763  Q=0.01414976761886777 
# FRAGMENT 2 - None: &lt;H&gt;=-302.01442133109555  EFR=-150.9381124557619  Q=0.016343168387422224 
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span># FRAGMENT 3 - None: &lt;H&gt;=-302.04876634836893  EFR=-153.53535661374343  Q=0.011417426261559172 
# CHEMICAL POTENTIAL 0.007441306704657513
# FINAL PARAMETERS: []
# FINAL CHEMICAL POTENTIAL: 0.007441306704657513
# FINAL ENERGY: -302.2589134315257
(-302.2589134315257, np.float64(0.007441306704657513), array([], dtype=float64))
</pre></div>
</div>
</div>
</div>
<p>The utility function <a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.get_fragment_orbital_masks" title="inquanto.extensions.pyscf.get_fragment_orbital_masks"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_fragment_orbital_masks()</span></code></a> helps to create
the orbital masks from atom indices. In this particular examples, the 4
fragments are specified by lists of atom indices defined in the <code class="docutils literal notranslate"><span class="pre">geometry</span></code>.
Consequently, <a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.get_fragment_orbital_masks" title="inquanto.extensions.pyscf.get_fragment_orbital_masks"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_fragment_orbital_masks()</span></code></a> returns 4
masks. Note however, that one could in principle define their own masks
which selects spatial orbitals within atoms or across multiple intra
atomic orbitals. Howeverm for <a class="reference internal" href="../api/inquanto/embeddings.html#inquanto.embeddings.dmet.DMETRHF" title="inquanto.embeddings.dmet.DMETRHF"><code class="xref py py-class docutils literal notranslate"><span class="pre">DMETRHF</span></code></a> it is important the the set of
fragments completely cover the entire molecule.</p>
</section>
</section>
<section id="dmet-with-a-custom-solver">
<h1>DMET with a custom solver<a class="headerlink" href="#dmet-with-a-custom-solver" title="Permalink to this heading">¶</a></h1>
<p>Running a VQE calculation on a DMET fragment of a large system requires the definition of a bespoke fragment solver.
There are many type of ansatze and strategies to perform VQE; instead of providing a corresponding range of many
black-box VQE fragment solvers, <a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#module-inquanto.extensions.pyscf" title="inquanto.extensions.pyscf"><code class="xref py py-mod docutils literal notranslate"><span class="pre">inquanto-pyscf</span></code></a> provides an easy way for a user to
define a fragment solver class.</p>
<p>To create a DMET fragment, we subclass the <a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.DMETRHFFragmentPySCFActive" title="inquanto.extensions.pyscf.DMETRHFFragmentPySCFActive"><code class="xref py py-class docutils literal notranslate"><span class="pre">inquanto.extensions.pyscf.DMETRHFFragmentPySCFActive</span></code></a> class, which
requires us to implement the <a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.DMETRHFFragmentPySCFActive.solve_active" title="inquanto.extensions.pyscf.DMETRHFFragmentPySCFActive.solve_active"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve_active()</span></code></a> method. This
method assumes that the Hamiltonian, Fragment Energy operator and other arguments are only for the active
space specified when the fragment solver is constructed. The mandatory return is the expectation value of the
Hamiltonian and the Fragment Energy operator with the ground state (<code class="docutils literal notranslate"><span class="pre">energy</span></code> and <code class="docutils literal notranslate"><span class="pre">fragment_energy</span></code>) and the 1-RDM
of the ground state. Below, we outline the structure of these calculations, but full examples can be found on the examples
page.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MyFragment</span><span class="p">(</span><span class="n">DMETRHFFragmentPySCFActive</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">solve_active</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span>
        <span class="n">hamiltonian_operator</span><span class="p">,</span> <span class="n">fragment_energy_operator</span><span class="p">,</span> <span class="n">fermion_space</span><span class="p">,</span> <span class="n">fermion_state</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="c1"># ... your VQE solution ...</span>

        <span class="k">return</span> <span class="n">energy</span><span class="p">,</span> <span class="n">fragment_energy</span><span class="p">,</span> <span class="n">vqe_rdm1</span>
</pre></div>
</div>
<p>The active space can be specified with the CAS notation via the <a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.FromActiveSpace" title="inquanto.extensions.pyscf.FromActiveSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">FromActiveSpace</span></code></a> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fr</span> <span class="o">=</span> <span class="n">MyFragment</span><span class="p">(</span><span class="n">dmet</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="n">FromActiveSpace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>or one can also provide the explicit list of indices of the frozen
orbitals of the fragment embedding system. Note that the fragment solver
in the case of DMET is solving the embedding system that is the fragment
orbitals and the bath orbitals together.</p>
<p>For Impurity DMET the implementation is even simpler, only the energy is required as an output:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.extensions.pyscf</span><span class="w"> </span><span class="kn">import</span> <span class="n">ImpurityDMETROHFFragmentPySCFActive</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.operators</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChemistryRestrictedIntegralOperator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.spaces</span><span class="w"> </span><span class="kn">import</span> <span class="n">FermionSpace</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.states</span><span class="w"> </span><span class="kn">import</span> <span class="n">FermionState</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.mappings</span><span class="w"> </span><span class="kn">import</span> <span class="n">QubitMappingJordanWigner</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.ansatzes</span><span class="w"> </span><span class="kn">import</span> <span class="n">FermionSpaceAnsatzUCCSD</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.computables</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExpectationValue</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.minimizers</span><span class="w"> </span><span class="kn">import</span> <span class="n">MinimizerScipy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">AlgorithmVQE</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.protocols</span><span class="w"> </span><span class="kn">import</span> <span class="n">SparseStatevectorProtocol</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.extensions.qiskit</span><span class="w"> </span><span class="kn">import</span> <span class="n">AerStateBackend</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyFragment</span><span class="p">(</span><span class="n">ImpurityDMETROHFFragmentPySCFActive</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">solve_active</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">hamiltonian_operator</span><span class="p">:</span> <span class="n">ChemistryRestrictedIntegralOperator</span><span class="p">,</span>
        <span class="n">fermion_space</span><span class="p">:</span> <span class="n">FermionSpace</span><span class="p">,</span>
        <span class="n">fermion_state</span><span class="p">:</span> <span class="n">FermionState</span><span class="p">,</span>
    <span class="p">):</span>

        <span class="n">jw</span> <span class="o">=</span> <span class="n">QubitMappingJordanWigner</span><span class="p">()</span>
        <span class="n">ansatz</span> <span class="o">=</span> <span class="n">FermionSpaceAnsatzUCCSD</span><span class="p">(</span><span class="n">fermion_space</span><span class="p">,</span> <span class="n">fermion_state</span><span class="p">,</span> <span class="n">jw</span><span class="p">)</span>

        <span class="n">h_op</span> <span class="o">=</span> <span class="n">jw</span><span class="o">.</span><span class="n">operator_map</span><span class="p">(</span><span class="n">hamiltonian_operator</span><span class="p">)</span>

        <span class="n">objective_expression</span> <span class="o">=</span> <span class="n">ExpectationValue</span><span class="p">(</span><span class="n">ansatz</span><span class="p">,</span> <span class="n">h_op</span><span class="p">)</span>

        <span class="n">vqe</span> <span class="o">=</span> <span class="n">AlgorithmVQE</span><span class="p">(</span>
            <span class="n">objective_expression</span><span class="o">=</span><span class="n">objective_expression</span><span class="p">,</span>
            <span class="n">minimizer</span><span class="o">=</span><span class="n">MinimizerScipy</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;COBYLA&quot;</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
            <span class="n">initial_parameters</span><span class="o">=</span><span class="n">ansatz</span><span class="o">.</span><span class="n">state_symbols</span><span class="o">.</span><span class="n">construct_random</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="n">vqe</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="n">AerStateBackend</span><span class="p">(),</span> <span class="n">protocol_objective</span><span class="o">=</span><span class="n">SparseStatevectorProtocol</span><span class="p">())</span>

        <span class="n">vqe</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="n">energy</span> <span class="o">=</span> <span class="n">vqe</span><span class="o">.</span><span class="n">final_value</span>

        <span class="k">return</span> <span class="n">energy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</section>
<section id="other-pyscf-hamiltonians-for-dmet">
<h1>Other PySCF Hamiltonians for DMET<a class="headerlink" href="#other-pyscf-hamiltonians-for-dmet" title="Permalink to this heading">¶</a></h1>
<p>The API of DMET based embedding methods does not restrict the origin
of the Hamiltonian. As long as it is in a localized orthonormal basis
and its type is <a class="reference internal" href="../api/inquanto/operators.html#inquanto.operators.ChemistryRestrictedIntegralOperator" title="inquanto.operators.ChemistryRestrictedIntegralOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChemistryRestrictedIntegralOperator</span></code></a> the Hamiltonian can be
constructed for a periodic system, or it can be a model Hamiltonian from the
Hubbard driver, or it can be generated with COSMO.</p>
<p>For example, if one would like to perform an embedding with a COSMO
calculation, then the Hamiltonian and the 1-RDM should be computed with
the <a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.ChemistryDriverPySCFMolecularRHFQMMMCOSMO" title="inquanto.extensions.pyscf.ChemistryDriverPySCFMolecularRHFQMMMCOSMO"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChemistryDriverPySCFMolecularRHFQMMMCOSMO</span></code></a> driver:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.extensions.pyscf</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChemistryDriverPySCFMolecularRHFQMMMCOSMO</span>

<span class="n">driver</span> <span class="o">=</span> <span class="n">ChemistryDriverPySCFMolecularRHFQMMMCOSMO</span><span class="p">(</span>
    <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;sto-3g&quot;</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">do_cosmo</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">hamiltonian</span><span class="p">,</span> <span class="n">fermion_space</span><span class="p">,</span> <span class="n">dm</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">get_lowdin_system</span><span class="p">()</span>

<span class="c1"># ... dmet and fragment definitions ...</span>

<span class="n">energy</span><span class="p">,</span> <span class="n">chemical_potential</span><span class="p">,</span> <span class="n">parameters</span> <span class="o">=</span> <span class="n">dmet</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fragments</span><span class="p">)</span>

<span class="n">energy_water_frozen</span> <span class="o">=</span> <span class="n">energy</span> <span class="o">+</span> <span class="n">driver</span><span class="o">.</span><span class="n">cosmo_correction</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On the last line above, the COSMO energy is calculated by correcting
the ground state energy of the Hamiltonian (which in this case is computed
approximately by DMET) with the COSMO correction. This type of
calculation assumes non self-consistent COSMO correction.</p>
</div>
<p>The COSMO method will be discussed in more detail <a class="reference internal" href="inquanto-pyscf.html#cosmo"><span class="std std-ref">below</span></a>.</p>
</section>
<section id="fmo-with-a-custom-solver">
<h1>FMO with a custom solver<a class="headerlink" href="#fmo-with-a-custom-solver" title="Permalink to this heading">¶</a></h1>
<p>In addition to DMET embedding methods, InQuanto supports FMO based embedding calculations
with the important difference that the Hamiltonian needs access to the atomic orbital basis:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hamiltonian_operator_ao</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">get_system_ao</span><span class="p">(</span><span class="n">run_hf</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>To run an FMO simulation, one needs to instantiate an <a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.fmo.FMO" title="inquanto.extensions.pyscf.fmo.FMO"><code class="xref py py-class docutils literal notranslate"><span class="pre">inquanto.extensions.pyscf.fmo.FMO</span></code></a> class and, similarly to
DMET, define fragment solvers before finally calling the <a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html#inquanto.extensions.pyscf.fmo.FMO.run" title="inquanto.extensions.pyscf.fmo.FMO.run"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run()</span></code></a> method. In the
example below we create a custom FMO class and perform VQE on the fragment Hamiltonians.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.extensions.pyscf.fmo</span><span class="w"> </span><span class="kn">import</span> <span class="n">FMOFragmentPySCFActive</span><span class="p">,</span> <span class="n">FMO</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.extensions.pyscf</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChemistryDriverPySCFMolecularRHF</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.extensions.qiskit</span><span class="w"> </span><span class="kn">import</span> <span class="n">AerStateBackend</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyFMOFragmentVQE</span><span class="p">(</span><span class="n">FMOFragmentPySCFActive</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">solve_final_active</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">hamiltonian_operator</span><span class="p">,</span>
        <span class="n">fermion_space</span><span class="p">,</span>
        <span class="n">fermion_state</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.ansatzes</span><span class="w"> </span><span class="kn">import</span> <span class="n">FermionSpaceAnsatzUCCSD</span>
        <span class="n">qubit_operator</span> <span class="o">=</span> <span class="n">hamiltonian_operator</span><span class="o">.</span><span class="n">qubit_encode</span><span class="p">()</span>

        <span class="n">ansatz</span> <span class="o">=</span> <span class="n">FermionSpaceAnsatzUCCSD</span><span class="p">(</span><span class="n">fermion_space</span><span class="p">,</span> <span class="n">fermion_state</span><span class="p">)</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.express</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_vqe</span>

        <span class="n">vqe</span> <span class="o">=</span> <span class="n">run_vqe</span><span class="p">(</span><span class="n">ansatz</span><span class="p">,</span> <span class="n">hamiltonian_operator</span><span class="p">,</span> <span class="n">AerStateBackend</span><span class="p">())</span>

        <span class="k">return</span> <span class="n">vqe</span><span class="o">.</span><span class="n">final_value</span>


<span class="n">driver</span> <span class="o">=</span> <span class="n">ChemistryDriverPySCFMolecularRHF</span><span class="p">(</span>
    <span class="n">geometry</span><span class="o">=</span><span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">2.8</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">]],</span>
        <span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">4.8</span><span class="p">]],</span>
    <span class="p">],</span>
    <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;sto3g&quot;</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">full_integral_operator</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">get_system_ao</span><span class="p">(</span><span class="n">run_hf</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">fmo</span> <span class="o">=</span> <span class="n">FMO</span><span class="p">(</span><span class="n">full_integral_operator</span><span class="p">)</span>

<span class="n">fragments</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">MyFMOFragmentVQE</span><span class="p">(</span>
        <span class="n">fmo</span><span class="p">,</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;H2-1&quot;</span>
    <span class="p">),</span>
    <span class="n">MyFMOFragmentVQE</span><span class="p">(</span>
        <span class="n">fmo</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;H2-2&quot;</span>
    <span class="p">),</span>
    <span class="n">MyFMOFragmentVQE</span><span class="p">(</span>
        <span class="n">fmo</span><span class="p">,</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;H2-3&quot;</span>
    <span class="p">),</span>
<span class="p">]</span>

<span class="n">fmo</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">fragments</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span># FIRST MONOMER ENERGIES: [np.float64(-3.5180388948642456), np.float64(-2.886013952482359), np.float64(-1.6863458716694648)]
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span># CONVERGENCE REACHED!
# CONVERGED MONOMER ENERGIES: [np.float64(-1.8009644337834727), np.float64(-1.8134981363881528), np.float64(-1.8009642542761397)]
# TIMER BLOCK-0 BEGINS AT 2025-03-08 00:24:34.581189
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span># TIMER BLOCK-0 ENDS - DURATION (s):  0.2955512 [0:00:00.295551]
# TIMER BLOCK-1 BEGINS AT 2025-03-08 00:24:34.970206
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span># TIMER BLOCK-1 ENDS - DURATION (s):  0.1783989 [0:00:00.178399]
# TIMER BLOCK-2 BEGINS AT 2025-03-08 00:24:35.253570
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span># TIMER BLOCK-2 ENDS - DURATION (s):  0.3109393 [0:00:00.310939]
# FINAL MONOMER ENERGIES: [np.float64(-1.8244970693393998), np.float64(-1.8373292776161891), np.float64(-1.824497051962278)]
# TIMER BLOCK-3 BEGINS AT 2025-03-08 00:24:35.760260
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span># TIMER BLOCK-3 ENDS - DURATION (s):  5.6219965 [0:00:05.621997]
# TIMER BLOCK-4 BEGINS AT 2025-03-08 00:24:41.532461
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span># TIMER BLOCK-4 ENDS - DURATION (s):  4.3588854 [0:00:04.358885]
# TIMER BLOCK-5 BEGINS AT 2025-03-08 00:24:46.045830
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span># TIMER BLOCK-5 ENDS - DURATION (s):  5.5383734 [0:00:05.538373]
# FINAL DIMER ENERGIES: [np.float64(-4.745456689215107), np.float64(-4.189591290931858), np.float64(-4.7454566624264505)]
# FINAL DIMER CORRECTION ENERGIES: [np.float64(-1.083630342259518), np.float64(-0.5405971696301801), np.float64(-1.0836303328479833)]
# TOTAL ENERGY: -3.3512648044323345
</pre></div>
</div>
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>np.float64(-3.3512648044323345)
</pre></div>
</div>
</div>
</div>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
              Copyright &#169; 2024 Quantinuum Ltd. All rights reserved.
            </div>
            <div class="terms" style="display:flex; gap:0.5rem; align-items:center; margin: 0.25rem 0rem;">
              <a href="https://www.quantinuum.com/privacy-statement" target="_blank">Privacy Statement</a>
              <div role="separator">/</div>
              <a href="https://www.quantinuum.com/cookie-notice" target="_blank">Cookie Notice</a>
              <div role="separator">/</div>
              <a href="https://www.quantinuum.com/terms-conditions" target="_blank">Terms and Conditions</a>
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../_static/jquery.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    </body>
</html>