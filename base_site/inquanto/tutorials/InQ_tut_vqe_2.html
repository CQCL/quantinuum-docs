<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YPQ1FTGDL3"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-YPQ1FTGDL3');
    </script>
    <link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Variational Quantum Deflation for excited states" href="InQ_tut_vqd.html" /><link rel="prev" title="A basic VQE simulation" href="InQ_tut_vqe_1.html" />

    <link rel="shortcut icon" href="../_static/quantinuum_favicon.svg"/><!-- Generated with Sphinx 6.2.1 and Furo 2024.08.06 -->
        <title>Extended VQE - InQuanto 4.2.0</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=04c057b233f3c8d71940eee6080f658a04e2027d" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=cf727022eb7470bc603c08d2e55c3247faec75c9" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style>
<link rel="stylesheet" href="../_static/tokens.css"/>
<link rel="stylesheet" href="../_static/styles.css"/>
<link rel="stylesheet" href="../_static/tailwind.css"/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="preload"
as="style">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">

<style>  
  .sidebar-sticky {
    top: calc(3.5rem - 0px);
    height: calc(100vh - 3.5rem);
  }
  
  @media (min-width: 97em) {
    html {
      font-size: 100% !important;
    }
  }
  
</style>
</head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>
<!-- <script type="text/javascript" src="../_static/syncTheme.global.js" ></script> -->
 <!--Force light mode -->
 <script>document.body.setAttribute('data-theme','light')</script>
<nav style="position:fixed;top:0;z-index:1021;width:100%;">
    <div class="nexus-nav"></div>
</nav>
<script type="text/javascript" src="../_static/injectNav.global.js"></script>
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">InQuanto 4.2.0</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/inquanto_short_logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">InQuanto 4.2.0</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction/overview.html">What is InQuanto?</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../introduction/installation.html">Installation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Installation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/system_requirements.html">System Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/troubleshooting.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/quickstart.html">Quick-start</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../manual/howto.html">How to use InQuanto</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../manual/algorithms_overview.html">Algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Algorithms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../manual/algorithms/variational_overview.html">Variational Algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Variational Algorithms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/algorithms_vqe.html">Variational Quantum Eigensolver <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmVQE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/algorithms_vqd.html">Variational Quantum Deflation <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmVQD</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/algorithms_adapt.html">ADAPT-VQE</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../manual/algorithms/non_variational_overview.html">Non-variational and Phase Estimation algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Non-variational and Phase Estimation algorithms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/algorithms_qse.html">Quantum Subspace Expansion <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmQSE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/algorithms_sceom.html">Quantum Self Consistent Equation of Motion <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmSCEOM</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/qpe_canonical.html">Canonical Quantum Phase Estimation <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmDeterministicQPE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/qpe_iterative.html">Iterative Phase Estimation Algorithms</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../manual/algorithms/time_evolution_overview.html">Time evolution algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Time evolution algorithms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../manual/algorithms/te_vqs.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmVQS</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmMcLachlanRealTime</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmMcLachlanImagTime</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../manual/computables_overview.html">Computables</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Computables</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../manual/computables/basic_usage.html">Basic Usage and Composability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/computables/evaluating_w_protocols.html">Evaluating Computables with Protocols</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../manual/computables/composite_computables.html">Composite Computables</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Composite Computables</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../manual/computables/greens_function.html">Krylov subspace &amp; Green’s functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/computables/rdms.html">Reduced Density Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../manual/computables/overlap_matrix.html">Overlap Matrices &amp; Non-Orthogonal Subspaces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../manual/computables/primitives.html">Primitive Computables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/computables/custom_computables.html">Custom Computables &amp; Partial Evaluations</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../manual/protocols_overview.html">Protocols</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Protocols</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/expval.html">Protocols for expectation values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/overlap_squared.html">Protocols for overlap squared</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/overlap.html">Protocols for overlaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/derivative.html">Protocols for derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/other.html">Other averaging protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/phase_est.html">Protocols for Phase Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/protocols/resource_estimation.html">Resource estimation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../manual/errmit.html">Noise mitigation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/spaces.html">Spaces, Operators, and States</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../manual/ansatzae_overview.html">Ansatzes</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Ansatzes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/ucc_family.html">The UCC Family</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/chemically_aware.html">Chemically Aware Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/trotter_ansatz.html">Trotter Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/fermion_state_exp.html">Fermionic Exponentiated Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/circuit_ansatz.html">Circuit Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/composed_ansatz.html">Composed Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/hea.html">Hardware Efficient Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/multi_configurational.html">Multiconfiguration States Using Givens Rotations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manual/ansatze/basis_rotation.html">Real Basis Rotation Ansatzes</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../manual/symmetry.html">Symmetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/geometry.html">Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/minimizers.html">Classical Minimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/dmet.html">Density Matrix Embedding Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/express.html">Express</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials &amp; Examples</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial_overview.html">Tutorials</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="tutorial_overview.html#core-tutorials">Core Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Core Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_vqe_1.html">A basic VQE simulation</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Extended VQE</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_vqd.html">Variational Quantum Deflation for excited states</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_viz.html">Visualization with inquanto-nglview</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial_overview.html#backend-tutorials">Backend Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Backend Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="backends_overview.html">Backends Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_Nexus_1.html"><b>Tutorial: InQuanto + qnexus</b></a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_htut_Aer_H2.html">Running on the Aer simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_htut_qsys_H2.html">Running on Quantinuum Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_htut_qsys_l%2Br.html">Quantinuum Systems -  Launching circuits and retrieving results</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_htut_qsys_qse.html">Quantinuum Systems -  Quantum Subspace Expansion</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial_overview.html#case-study-tutorials-fe4n2">Case Study Tutorials - Fe4N2</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Case Study Tutorials - Fe4N2</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_fe4n2_1.html">Fe4N2 - 1 - system construction with AVAS and CASSCF</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_fe4n2_2.html">Fe4N2 - 2 - circuit construction with ADAPT-VQE</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_fe4n2_3.html">Fe4N2 - 3 - calculations on Quantinuum hardware</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="tutorial_overview.html#fragmentation-tutorials">Fragmentation Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Fragmentation Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_dmet.html">Tackling larger systems with fragmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_wft_dft.html">Projection-based embedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_nevpt2_AC0.html">NEVPT2 and AC0 energy corrections</a></li>
<li class="toctree-l2"><a class="reference internal" href="InQ_tut_wft_dft_2.html">Projection-based embedding with energy corrections</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples_overview.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extensions User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../extensions/extensions-overview.html">Extensions overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extensions/inquanto-nexus.html">InQuanto-Nexus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extensions/inquanto-pyscf.html">InQuanto-PySCF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extensions/inquanto-nglview.html">InQuanto-NGLView</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extensions/inquanto-phayes.html">InQuanto-Phayes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../extensions/extensions_examples.html">Extensions examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/inquanto_api_intro.html">InQuanto</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of InQuanto</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/algorithms.html">inquanto.algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/ansatz.html">inquanto.ansatzes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/computables.html">inquanto.computables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/core.html">inquanto.core</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/embeddings.html">inquanto.embeddings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/express.html">inquanto.express</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/geometry.html">inquanto.geometries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/mappings.html">inquanto.mappings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/minimizers.html">inquanto.minimizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/operators.html">inquanto.operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/protocols.html">inquanto.protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/spaces.html">inquanto.spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/states.html">inquanto.states</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/inquanto/symmetry.html">inquanto.symmetry</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/inquanto-ext_api_intro.html">InQuanto-Extensions</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of InQuanto-Extensions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/extensions/inquanto-nexus_api.html">InQuanto-Nexus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/extensions/inquanto-pyscf_api.html">InQuanto-PySCF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/extensions/inquanto-nglview_api.html">InQuanto-NGLView</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/extensions/inquanto-phayes.html">InQuanto-Phayes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/extensions/inquanto-cutensornet_api.html">InQuanto-cuTensorNet</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../misc/changelog.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/contact.html">Contact Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/cite.html">How to cite InQuanto</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/licence.html">License and Notices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc/opensource.html">Open-source Attribution</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="extended-vqe">
<h1>Extended VQE<a class="headerlink" href="#extended-vqe" title="Permalink to this heading">¶</a></h1>
<p>In <a class="reference external" href="https://docs.quantinuum.com/inquanto/tutorials/InQ_tut_vqe_1.html">Tutorial 1</a>, we considered a canonical VQE calculation at a single geometry with no resource optimization.  However, in general, this will only be the first step in an analysis of the quantum algorithm.  We may wish to expand on this analysis by considering more molecular geometries or systems – for example, looking at the energetics of bond dissociation.  We also may wish to compare optimization methods in order to assess their effectiveness at reducing the overall cost with regards to quantum computational resources.</p>
<p>In this tutorial, we will look at how to achieve these goals using InQuanto.  We start by examining bond dissociation in molecular hydrogen using a canonical VQE approach.  Then, we will look at a slightly larger system – the bending and stretching of water.  As this is a larger system, we will have to introduce optimizations to enable the simulations to run on a standard laptop.  Specifically, we introduce how to reduce the active space (and thus the number of qubits in the quantum computation) by freezing orbitals using the <a class="reference external" href="https://docs.quantinuum.com/inquanto/extensions/inquanto-pyscf.html">inquanto-pyscf</a> driver.  Finally, we look at one optimization strategy in InQuanto - Ansatz parameter reduction by point group symmetry.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pytket.extensions.qiskit</span><span class="w"> </span><span class="kn">import</span> <span class="n">AerStateBackend</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.express</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_vqe</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.minimizers</span><span class="w"> </span><span class="kn">import</span> <span class="n">MinimizerScipy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.ansatzes</span><span class="w"> </span><span class="kn">import</span> <span class="n">FermionSpaceAnsatzUCCSD</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.mappings</span><span class="w"> </span><span class="kn">import</span> <span class="n">QubitMappingJordanWigner</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.extensions.pyscf</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChemistryDriverPySCFMolecularRHF</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<section id="h2-bond-stretching">
<h2>H2 Bond Stretching<a class="headerlink" href="#h2-bond-stretching" title="Permalink to this heading">¶</a></h2>
<p>After imports, we start by examining bond dissociation in molecular hydrogen in order to present a general workflow.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">hydrogen_vqe_energy</span><span class="p">(</span><span class="n">bond_length</span><span class="p">):</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;STO-3G&#39;</span>
    <span class="n">geometry</span> <span class="o">=</span> <span class="p">[[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">bond_length</span><span class="p">]]]</span>
    <span class="n">charge</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="n">driver</span> <span class="o">=</span> <span class="n">ChemistryDriverPySCFMolecularRHF</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">basis</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="n">charge</span><span class="p">)</span>
    <span class="n">fermionic_hamiltonian</span><span class="p">,</span> <span class="n">fock_space</span><span class="p">,</span> <span class="n">fock_state</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">get_system</span><span class="p">()</span>
    <span class="n">jw</span> <span class="o">=</span> <span class="n">QubitMappingJordanWigner</span>
    <span class="n">qubit_hamiltonian</span> <span class="o">=</span> <span class="n">jw</span><span class="o">.</span><span class="n">operator_map</span><span class="p">(</span><span class="n">fermionic_hamiltonian</span><span class="p">)</span>
    <span class="n">ansatz</span> <span class="o">=</span> <span class="n">FermionSpaceAnsatzUCCSD</span><span class="p">(</span><span class="n">fock_space</span><span class="p">,</span> <span class="n">fock_state</span><span class="p">,</span> <span class="n">jw</span><span class="p">)</span>
    <span class="n">backend</span> <span class="o">=</span> <span class="n">AerStateBackend</span><span class="p">()</span>
    <span class="n">minimizer</span> <span class="o">=</span> <span class="n">MinimizerScipy</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;L-BFGS-B&quot;</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">vqe</span> <span class="o">=</span> <span class="n">run_vqe</span><span class="p">(</span><span class="n">ansatz</span><span class="p">,</span> <span class="n">qubit_hamiltonian</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span> <span class="n">with_gradient</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">minimizer</span><span class="o">=</span><span class="n">minimizer</span><span class="p">)</span>

    <span class="n">ground_state_energy</span> <span class="o">=</span> <span class="n">vqe</span><span class="o">.</span><span class="n">generate_report</span><span class="p">()[</span><span class="s2">&quot;final_value&quot;</span><span class="p">]</span>
    <span class="n">hartree_fock_energy</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">mf_energy</span>
    <span class="k">return</span> <span class="n">ground_state_energy</span><span class="p">,</span> <span class="n">hartree_fock_energy</span>

<span class="nb">print</span><span class="p">(</span><span class="n">hydrogen_vqe_energy</span><span class="p">(</span><span class="mf">0.741</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># TIMER BLOCK-0 BEGINS AT 2025-02-10 10:51:59.387681
# TIMER BLOCK-0 ENDS - DURATION (s):  0.1024388 [0:00:00.102439]
(-1.1372744055294368, np.float64(-1.1167061372361056))
</pre></div>
</div>
</div>
</div>
<p>The code here does all that is necessary to generate a ground state energy using canonical VQE for the hydrogen molecule, as in <a class="reference external" href="https://docs.quantinuum.com/inquanto/tutorials/InQ_tut_vqe_1.html">Tutorial 1</a>.  Here, we have wrapped it in a function to allow us to easily view the change with bond length:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">h2_bond_lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">2.0</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">h2_results</span> <span class="o">=</span> <span class="p">[</span><span class="n">hydrogen_vqe_energy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">h2_bond_lengths</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">h2_results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># TIMER BLOCK-1 BEGINS AT 2025-02-10 10:51:59.516722
# TIMER BLOCK-1 ENDS - DURATION (s):  0.1263202 [0:00:00.126320]
# TIMER BLOCK-2 BEGINS AT 2025-02-10 10:51:59.660937
# TIMER BLOCK-2 ENDS - DURATION (s):  0.0957963 [0:00:00.095796]
# TIMER BLOCK-3 BEGINS AT 2025-02-10 10:51:59.774026
# TIMER BLOCK-3 ENDS - DURATION (s):  0.0900062 [0:00:00.090006]
# TIMER BLOCK-4 BEGINS AT 2025-02-10 10:51:59.881539
# TIMER BLOCK-4 ENDS - DURATION (s):  0.0899459 [0:00:00.089946]
# TIMER BLOCK-5 BEGINS AT 2025-02-10 10:51:59.989165
# TIMER BLOCK-5 ENDS - DURATION (s):  0.0870455 [0:00:00.087045]
# TIMER BLOCK-6 BEGINS AT 2025-02-10 10:52:00.093389
# TIMER BLOCK-6 ENDS - DURATION (s):  0.1026133 [0:00:00.102613]
# TIMER BLOCK-7 BEGINS AT 2025-02-10 10:52:00.217503
# TIMER BLOCK-7 ENDS - DURATION (s):  0.0936890 [0:00:00.093689]
# TIMER BLOCK-8 BEGINS AT 2025-02-10 10:52:00.328489
# TIMER BLOCK-8 ENDS - DURATION (s):  0.0886705 [0:00:00.088671]
# TIMER BLOCK-9 BEGINS AT 2025-02-10 10:52:00.434608
# TIMER BLOCK-9 ENDS - DURATION (s):  0.0876303 [0:00:00.087630]
# TIMER BLOCK-10 BEGINS AT 2025-02-10 10:52:00.539554
# TIMER BLOCK-10 ENDS - DURATION (s):  0.0860837 [0:00:00.086084]
# TIMER BLOCK-11 BEGINS AT 2025-02-10 10:52:00.643547
# TIMER BLOCK-11 ENDS - DURATION (s):  0.0866043 [0:00:00.086604]
# TIMER BLOCK-12 BEGINS AT 2025-02-10 10:52:00.747837
# TIMER BLOCK-12 ENDS - DURATION (s):  0.0848817 [0:00:00.084882]
# TIMER BLOCK-13 BEGINS AT 2025-02-10 10:52:00.850098
# TIMER BLOCK-13 ENDS - DURATION (s):  0.0854067 [0:00:00.085407]
# TIMER BLOCK-14 BEGINS AT 2025-02-10 10:52:00.952653
# TIMER BLOCK-14 ENDS - DURATION (s):  0.0870666 [0:00:00.087067]
# TIMER BLOCK-15 BEGINS AT 2025-02-10 10:52:01.058093
# TIMER BLOCK-15 ENDS - DURATION (s):  0.0925660 [0:00:00.092566]
# TIMER BLOCK-16 BEGINS AT 2025-02-10 10:52:01.169151
# TIMER BLOCK-16 ENDS - DURATION (s):  0.0846613 [0:00:00.084661]
# TIMER BLOCK-17 BEGINS AT 2025-02-10 10:52:01.271012
# TIMER BLOCK-17 ENDS - DURATION (s):  0.0849042 [0:00:00.084904]
# TIMER BLOCK-18 BEGINS AT 2025-02-10 10:52:01.374293
# TIMER BLOCK-18 ENDS - DURATION (s):  0.0841311 [0:00:00.084131]
# TIMER BLOCK-19 BEGINS AT 2025-02-10 10:52:01.474812
# TIMER BLOCK-19 ENDS - DURATION (s):  0.0838539 [0:00:00.083854]
# TIMER BLOCK-20 BEGINS AT 2025-02-10 10:52:01.575913
# TIMER BLOCK-20 ENDS - DURATION (s):  0.0837162 [0:00:00.083716]
[(-0.9141497046270834, np.float64(-0.9043613941635402)), (-1.0396441933684193, np.float64(-1.0278952240485912)), (-1.102723451217337, np.float64(-1.0885821110334761)), (-1.1303984654811363, np.float64(-1.1133931546411704)), (-1.1373027360323484, np.float64(-1.1169158055488673)), (-1.1320031440770355, np.float64(-1.107658602337548)), (-1.1196476526566383, np.float64(-1.0906923776852)), (-1.103357320131611, np.float64(-1.0690432214496193)), (-1.085088560549943, np.float64(-1.0445649211858916)), (-1.0661536707290789, np.float64(-1.0184750668009022)), (-1.0474923241943452, np.float64(-0.9916426659510074)), (-1.0297900705318146, np.float64(-0.9647203151980037)), (-1.0135255910407293, np.float64(-0.9382014307919537)), (-0.9989959202496171, np.float64(-0.9124510069368061)), (-0.9863403143934901, np.float64(-0.8877296363816175)), (-0.9755678355211708, np.float64(-0.8642149983652554)), (-0.9665878877681976, np.float64(-0.8420201240601859)), (-0.9592413973101772, np.float64(-0.8212077601664912)), (-0.953330033975642, np.float64(-0.8018012103709646)), (-0.9486411121756362, np.float64(-0.7837926542773532))]
</pre></div>
</div>
</div>
</div>
<p>We have successfully generated a potential energy curve for the dissociation of the H2 molecule using VQE and, as a reference, Hartree-Fock.  We can now separate the VQE and HF results and plot them:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">h2_vqe_results</span><span class="p">,</span><span class="n">h2_hf_results</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">h2_results</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">h2_bond_lengths</span><span class="p">,</span><span class="n">h2_vqe_results</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;VQE&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">h2_bond_lengths</span><span class="p">,</span><span class="n">h2_hf_results</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;HF&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;H-H Bond Length/Å&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ground state energy/Ha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x14d890490&gt;
</pre></div>
</div>
<img alt="../_images/d8722a6c70aaeb052c524e200bb66f0434269136112dc08d65f92fe8545e537b.png" src="../_images/d8722a6c70aaeb052c524e200bb66f0434269136112dc08d65f92fe8545e537b.png" />
</div>
</div>
<p>Here we can see the improvement obtained by using UCCSD VQE – indeed, this system is sufficiently low in number of spin-orbitals that UCCSD is exact (i.e. FCI-level).  On the other hand, we can also observe the increasing inaccuracy of (restricted) Hartree-Fock at higher bond lengths.</p>
</section>
<section id="h2o-bending-active-space-reduction">
<h2>H2O Bending - active space reduction<a class="headerlink" href="#h2o-bending-active-space-reduction" title="Permalink to this heading">¶</a></h2>
<p>H2O in an STO-3G basis is a 14 spin-orbital (and thus 14 qubit for conventional qubit mappings) system.  This is within the capacity of a classical computer to simulate, but such a simulation may perhaps require more resources than is practical for this tutorial.  We can reduce the active spin-orbital space by freezing orbitals.  While our purpose here is to demonstrate, in a real experiment it may be necessary to freeze orbitals in order to reduce the (exponentially growing) resources to a level that is actually implementable.  In InQuanto, orbital freezing is performed by passing the <code class="docutils literal notranslate"><span class="pre">frozen</span></code> parameter to the driver:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">water_bending_vqe_energy</span><span class="p">(</span><span class="n">bond_angle</span><span class="p">):</span>
    
    <span class="n">x_h2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">bond_angle</span> <span class="o">/</span> <span class="mi">360</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">x_h1</span> <span class="o">=</span> <span class="o">-</span><span class="n">x_h2</span>
    <span class="n">y_h1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">bond_angle</span> <span class="o">/</span> <span class="mi">360</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">y_h2</span> <span class="o">=</span> <span class="n">y_h1</span>
    
    <span class="n">geometry</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">x_h1</span><span class="p">,</span> <span class="n">y_h1</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">x_h2</span><span class="p">,</span> <span class="n">y_h2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]]]</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;STO-3G&#39;</span>
    <span class="n">charge</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">frozen</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">driver</span> <span class="o">=</span> <span class="n">ChemistryDriverPySCFMolecularRHF</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">basis</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="n">charge</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="n">frozen</span><span class="p">)</span>
    <span class="n">fermionic_hamiltonian</span><span class="p">,</span> <span class="n">fock_space</span><span class="p">,</span> <span class="n">fock_state</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">get_system</span><span class="p">()</span>
    <span class="n">jw</span> <span class="o">=</span> <span class="n">QubitMappingJordanWigner</span>
    <span class="n">qubit_hamiltonian</span> <span class="o">=</span> <span class="n">jw</span><span class="o">.</span><span class="n">operator_map</span><span class="p">(</span><span class="n">fermionic_hamiltonian</span><span class="p">)</span>
    <span class="n">ansatz</span> <span class="o">=</span> <span class="n">FermionSpaceAnsatzUCCSD</span><span class="p">(</span><span class="n">fock_space</span><span class="p">,</span> <span class="n">fock_state</span><span class="p">,</span> <span class="n">jw</span><span class="p">)</span>
    <span class="n">backend</span> <span class="o">=</span> <span class="n">AerStateBackend</span><span class="p">()</span>
    <span class="n">minimizer</span> <span class="o">=</span> <span class="n">MinimizerScipy</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;L-BFGS-B&quot;</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">vqe</span> <span class="o">=</span> <span class="n">run_vqe</span><span class="p">(</span><span class="n">ansatz</span><span class="p">,</span> <span class="n">qubit_hamiltonian</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span> <span class="n">with_gradient</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">minimizer</span><span class="o">=</span><span class="n">minimizer</span><span class="p">)</span>

    <span class="n">ground_state_energy</span> <span class="o">=</span> <span class="n">vqe</span><span class="o">.</span><span class="n">generate_report</span><span class="p">()[</span><span class="s2">&quot;final_value&quot;</span><span class="p">]</span>
    <span class="n">hartree_fock_energy</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">mf_energy</span>
    <span class="k">return</span> <span class="n">ground_state_energy</span><span class="p">,</span> <span class="n">hartree_fock_energy</span>

<span class="nb">print</span><span class="p">(</span><span class="n">water_bending_vqe_energy</span><span class="p">(</span><span class="mf">104.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># TIMER BLOCK-21 BEGINS AT 2025-02-10 10:52:02.031413
# TIMER BLOCK-21 ENDS - DURATION (s): 14.9251390 [0:00:14.925139]
(-75.01966834467402, np.float64(-74.96466253913081))
</pre></div>
</div>
</div>
</div>
<p>This block may take up to a minute to run, as the system is a bit bigger than molecular hydrogen.  Here, we have asked the driver to freeze the lowest energy spatial orbital (i.e. the core electrons).  Note that frozen orbitals are specified as a list of indices of spatial orbitals, not spin-orbitals - so every orbital frozen in this way will save two qubits.  Note that for consistency, we have here specified the geometry in Cartesian co-ordinates by explicitly calculating the position of each atom.  It is also possible in InQuanto to specify geometries in z-matrix format.</p>
<p>As before, we have successfully calculated the VQE and HF energy at (roughly) the equilibrium geometry.  We can again calculate the effect of changing the bond angle and plot the results (this may take a few minutes to run - reducing the amount of data points generated will speed it up if needed):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">h2o_bond_angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">45.</span><span class="p">,</span><span class="mf">180.</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">h2o_bending_results</span> <span class="o">=</span> <span class="p">[</span><span class="n">water_bending_vqe_energy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">h2o_bond_angles</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># TIMER BLOCK-22 BEGINS AT 2025-02-10 10:52:17.209756
# TIMER BLOCK-22 ENDS - DURATION (s): 15.1244008 [0:00:15.124401]
# TIMER BLOCK-23 BEGINS AT 2025-02-10 10:52:32.584561
# TIMER BLOCK-23 ENDS - DURATION (s): 15.3592692 [0:00:15.359269]
# TIMER BLOCK-24 BEGINS AT 2025-02-10 10:52:48.196833
# TIMER BLOCK-24 ENDS - DURATION (s): 15.5988085 [0:00:15.598809]
# TIMER BLOCK-25 BEGINS AT 2025-02-10 10:53:04.051584
# TIMER BLOCK-25 ENDS - DURATION (s): 15.6882947 [0:00:15.688295]
# TIMER BLOCK-26 BEGINS AT 2025-02-10 10:53:20.000201
# TIMER BLOCK-26 ENDS - DURATION (s): 15.5837241 [0:00:15.583724]
# TIMER BLOCK-27 BEGINS AT 2025-02-10 10:53:35.840415
# TIMER BLOCK-27 ENDS - DURATION (s): 17.2890410 [0:00:17.289041]
# TIMER BLOCK-28 BEGINS AT 2025-02-10 10:53:53.384321
# TIMER BLOCK-28 ENDS - DURATION (s): 17.2213630 [0:00:17.221363]
# TIMER BLOCK-29 BEGINS AT 2025-02-10 10:54:10.860683
# TIMER BLOCK-29 ENDS - DURATION (s): 18.9819929 [0:00:18.981993]
# TIMER BLOCK-30 BEGINS AT 2025-02-10 10:54:30.097516
# TIMER BLOCK-30 ENDS - DURATION (s): 20.5509953 [0:00:20.550995]
# TIMER BLOCK-31 BEGINS AT 2025-02-10 10:54:50.894670
# TIMER BLOCK-31 ENDS - DURATION (s): 12.8023447 [0:00:12.802345]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">h2o_angle_vqe_results</span><span class="p">,</span><span class="n">h2o_angle_hf_results</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">h2o_bending_results</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">h2o_bond_angles</span><span class="p">,</span><span class="n">h2o_angle_vqe_results</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;VQE&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">h2o_bond_angles</span><span class="p">,</span><span class="n">h2o_angle_hf_results</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;HF&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;HOH bond angle /°&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ground state energy/Ha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x14f932090&gt;
</pre></div>
</div>
<img alt="../_images/8b9c2e13df88bcc6190272df689b10551f03a0662e0e9b294e4cfc82c60e9840.png" src="../_images/8b9c2e13df88bcc6190272df689b10551f03a0662e0e9b294e4cfc82c60e9840.png" />
</div>
</div>
</section>
<section id="h2o-stretching-symmetry-allowed-excitations">
<h2>H2O Stretching - symmetry-allowed excitations<a class="headerlink" href="#h2o-stretching-symmetry-allowed-excitations" title="Permalink to this heading">¶</a></h2>
<p>In larger systems, we may be interested in benchmarking the cost of VQE with various optimization schemes.  Choosing optimization schemes is a question of balancing the need for accuracy and resource constraints.  Several resource constraints occur when performing quantum algorithms – for instance, the number of qubits and the circuit length.  Similar to space and time in classical computing, certain optimization schemes may reduce cost in one metric while having a detrimental effect on others.  Such  tradeoff in resources applies to VQE itself; VQE as an algorithm is designed to replace the (extremely) long quantum circuits of the phase estimation algorithm with significantly more but much shorter circuits.</p>
<p>Many such optimization schemes are available in InQuanto and examples of their use can be found in the examples directory.  In this tutorial, we will look at the use of point group symmetry to exclude unphysical symmetry-violating excitations.  This is a technique commonly used in quantum chemistry codes on classical computers, and can substantially reduce the number of Ansatz parameters.  In turn, the quantum circuit length can be reduced, as is the difficulty of classical optimization (and consequentially the number of individual VQE shots required, and thus the overall runtime).  As this technique is simply removing excitations that are unphysical, it is essentially “free” with regards to other computational resources.</p>
<p>First, we modify our VQE routine to incorporate point group symmetry – this time, in the context of symmetric bond stretching:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">water_stretching_vqe_energy</span><span class="p">(</span><span class="n">bond_length</span><span class="p">):</span>
    
    <span class="n">x_h2</span> <span class="o">=</span> <span class="n">bond_length</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">104.45</span> <span class="o">/</span> <span class="mi">360</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">x_h1</span> <span class="o">=</span> <span class="o">-</span><span class="n">x_h2</span>
    <span class="n">y_h1</span> <span class="o">=</span> <span class="n">bond_length</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">104.45</span> <span class="o">/</span> <span class="mi">360</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">y_h2</span> <span class="o">=</span> <span class="n">y_h1</span>
    
    <span class="n">geometry</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">x_h1</span><span class="p">,</span> <span class="n">y_h1</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">x_h2</span><span class="p">,</span> <span class="n">y_h2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]]]</span>
    <span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;STO-3G&#39;</span>
    <span class="n">charge</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">frozen</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="n">driver</span> <span class="o">=</span> <span class="n">ChemistryDriverPySCFMolecularRHF</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">basis</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="n">charge</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="n">frozen</span><span class="p">,</span><span class="n">point_group_symmetry</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fermionic_hamiltonian</span><span class="p">,</span> <span class="n">fock_space</span><span class="p">,</span> <span class="n">fock_state</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">get_system</span><span class="p">()</span>
    <span class="n">jw</span> <span class="o">=</span> <span class="n">QubitMappingJordanWigner</span>
    <span class="n">qubit_hamiltonian</span> <span class="o">=</span> <span class="n">jw</span><span class="o">.</span><span class="n">operator_map</span><span class="p">(</span><span class="n">fermionic_hamiltonian</span><span class="p">)</span>
    <span class="n">ansatz</span> <span class="o">=</span> <span class="n">FermionSpaceAnsatzUCCSD</span><span class="p">(</span><span class="n">fock_space</span><span class="p">,</span> <span class="n">fock_state</span><span class="p">,</span> <span class="n">jw</span><span class="p">)</span>
    <span class="n">backend</span> <span class="o">=</span> <span class="n">AerStateBackend</span><span class="p">()</span>
    <span class="n">minimizer</span> <span class="o">=</span> <span class="n">MinimizerScipy</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s2">&quot;L-BFGS-B&quot;</span><span class="p">,</span> <span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">vqe</span> <span class="o">=</span> <span class="n">run_vqe</span><span class="p">(</span><span class="n">ansatz</span><span class="p">,</span> <span class="n">qubit_hamiltonian</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">backend</span><span class="p">,</span> <span class="n">with_gradient</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">minimizer</span><span class="o">=</span><span class="n">minimizer</span><span class="p">)</span>

    <span class="n">ground_state_energy</span> <span class="o">=</span> <span class="n">vqe</span><span class="o">.</span><span class="n">generate_report</span><span class="p">()[</span><span class="s2">&quot;final_value&quot;</span><span class="p">]</span>
    <span class="n">hartree_fock_energy</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">mf_energy</span>
    <span class="k">return</span> <span class="n">ground_state_energy</span><span class="p">,</span> <span class="n">hartree_fock_energy</span>
<span class="nb">print</span><span class="p">(</span><span class="n">water_stretching_vqe_energy</span><span class="p">(</span><span class="mf">1.</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># TIMER BLOCK-32 BEGINS AT 2025-02-10 10:55:03.907195
# TIMER BLOCK-32 ENDS - DURATION (s):  8.9264397 [0:00:08.926440]
(-75.01969733754345, np.float64(-74.96468314023913))
</pre></div>
</div>
</div>
</div>
<p>Here, incorporating point group symmetry is as simple as passing <code class="docutils literal notranslate"><span class="pre">point_group_symmetry=True</span></code> to the driver.  Note that the ability to use point group symmetry is reliant on the capacity of the underlying classical quantum chemistry package (in this case, <a class="reference external" href="https://pyscf.org/">PySCF</a>).  We then generate a plot of the change in the ground state energy as the bonds stretch:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">h2o_bond_lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">h2o_stretching_results</span> <span class="o">=</span> <span class="p">[</span><span class="n">water_stretching_vqe_energy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">h2o_bond_lengths</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># TIMER BLOCK-33 BEGINS AT 2025-02-10 10:55:12.972942
# TIMER BLOCK-33 ENDS - DURATION (s):  7.8683482 [0:00:07.868348]
# TIMER BLOCK-34 BEGINS AT 2025-02-10 10:55:20.972439
# TIMER BLOCK-34 ENDS - DURATION (s):  7.9162048 [0:00:07.916205]
# TIMER BLOCK-35 BEGINS AT 2025-02-10 10:55:29.021266
# TIMER BLOCK-35 ENDS - DURATION (s):  9.1032581 [0:00:09.103258]
# TIMER BLOCK-36 BEGINS AT 2025-02-10 10:55:38.256649
# TIMER BLOCK-36 ENDS - DURATION (s):  9.3349239 [0:00:09.334924]
# TIMER BLOCK-37 BEGINS AT 2025-02-10 10:55:47.724597
# TIMER BLOCK-37 ENDS - DURATION (s): 10.0443827 [0:00:10.044383]
# TIMER BLOCK-38 BEGINS AT 2025-02-10 10:55:57.903892
# TIMER BLOCK-38 ENDS - DURATION (s): 12.2326116 [0:00:12.232612]
# TIMER BLOCK-39 BEGINS AT 2025-02-10 10:56:10.269669
# TIMER BLOCK-39 ENDS - DURATION (s): 10.8213116 [0:00:10.821312]
# TIMER BLOCK-40 BEGINS AT 2025-02-10 10:56:21.227220
# TIMER BLOCK-40 ENDS - DURATION (s): 13.5665152 [0:00:13.566515]
# TIMER BLOCK-41 BEGINS AT 2025-02-10 10:56:34.929382
# TIMER BLOCK-41 ENDS - DURATION (s): 17.8237549 [0:00:17.823755]
# TIMER BLOCK-42 BEGINS AT 2025-02-10 10:56:52.902077
# TIMER BLOCK-42 ENDS - DURATION (s): 19.4317444 [0:00:19.431744]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">h2o_lengths_vqe_results</span><span class="p">,</span><span class="n">h2o_lengths_hf_results</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">h2o_stretching_results</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">h2o_bond_lengths</span><span class="p">,</span><span class="n">h2o_lengths_vqe_results</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;VQE&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">h2o_bond_lengths</span><span class="p">,</span><span class="n">h2o_lengths_hf_results</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;HF&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;OH bond length /Å&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ground state energy/Ha&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x14ee5c5d0&gt;
</pre></div>
</div>
<img alt="../_images/48cf32602d5dba48cbcf73dc4256a2c7cf26de7e21383bfe645d1c1bcd0df02f.png" src="../_images/48cf32602d5dba48cbcf73dc4256a2c7cf26de7e21383bfe645d1c1bcd0df02f.png" />
</div>
</div>
<p>We have successfully demonstrated that the point group symmetry reductions yield the correct ground state energy. However, we have not yet looked at the resource reductions obtained.  We can adapt our VQE wrapper functions to return this, but for simplicity here we just look at one configuration:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x_h2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mf">104.45</span> <span class="o">/</span> <span class="mi">360</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">x_h1</span> <span class="o">=</span> <span class="o">-</span><span class="n">x_h2</span>
<span class="n">y_h1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">104.45</span> <span class="o">/</span> <span class="mi">360</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">y_h2</span> <span class="o">=</span> <span class="n">y_h1</span>

<span class="n">geometry</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">x_h1</span><span class="p">,</span> <span class="n">y_h1</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">x_h2</span><span class="p">,</span> <span class="n">y_h2</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]]]</span>
<span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;STO-3G&#39;</span>
<span class="n">charge</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">frozen</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    
<span class="n">driver_with_symmetry</span> <span class="o">=</span> <span class="n">ChemistryDriverPySCFMolecularRHF</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">basis</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="n">charge</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="n">frozen</span><span class="p">,</span><span class="n">point_group_symmetry</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">driver_without_symmetry</span> <span class="o">=</span> <span class="n">ChemistryDriverPySCFMolecularRHF</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">basis</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">geometry</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="n">charge</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="n">frozen</span><span class="p">,</span><span class="n">point_group_symmetry</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fermionic_hamiltonian_with_symmetry</span><span class="p">,</span> <span class="n">fock_space_with_symmetry</span><span class="p">,</span> <span class="n">fock_state_with_symmetry</span> <span class="o">=</span> <span class="n">driver_with_symmetry</span><span class="o">.</span><span class="n">get_system</span><span class="p">()</span>
<span class="n">fermionic_hamiltonian_without_symmetry</span><span class="p">,</span> <span class="n">fock_space_without_symmetry</span><span class="p">,</span> <span class="n">fock_state_without_symmetry</span> <span class="o">=</span> <span class="n">driver_without_symmetry</span><span class="o">.</span><span class="n">get_system</span><span class="p">()</span>
<span class="n">jw</span> <span class="o">=</span> <span class="n">QubitMappingJordanWigner</span><span class="p">()</span>

<span class="n">ansatz_with_symmetry</span> <span class="o">=</span> <span class="n">FermionSpaceAnsatzUCCSD</span><span class="p">(</span><span class="n">fock_space_with_symmetry</span><span class="p">,</span> <span class="n">fock_state_with_symmetry</span><span class="p">,</span> <span class="n">jw</span><span class="p">)</span>
<span class="n">ansatz_without_symmetry</span> <span class="o">=</span> <span class="n">FermionSpaceAnsatzUCCSD</span><span class="p">(</span><span class="n">fock_space_without_symmetry</span><span class="p">,</span> <span class="n">fock_state_without_symmetry</span><span class="p">,</span> <span class="n">jw</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For simplicity, we restrict ourselves to looking at the impact on the resources required for generating the Ansatz state.  Note that many quantum resources can be estimated without actually running VQE in this manner; this dramatically decreases the resources necessary to perform an experiment.</p>
<p>We can get an idea of the ansatz resources via the <code class="docutils literal notranslate"><span class="pre">circuit_resources()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;### ANSATZ RESOURCES WITH SYMMETRY REDUCTION ###&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ansatz_with_symmetry</span><span class="o">.</span><span class="n">circuit_resources</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">### ANSATZ RESOURCES WITHOUT SYMMETRY REDUCTION ###&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ansatz_without_symmetry</span><span class="o">.</span><span class="n">circuit_resources</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>### ANSATZ RESOURCES WITH SYMMETRY REDUCTION ###
{&#39;depth&#39;: 1629, &#39;gates&#39;: 3684, &#39;qubits&#39;: 12, &#39;gates_2q&#39;: 1888, &#39;gates_1q&#39;: 1796}

### ANSATZ RESOURCES WITHOUT SYMMETRY REDUCTION ###
{&#39;depth&#39;: 5553, &#39;gates&#39;: 12616, &#39;qubits&#39;: 12, &#39;gates_2q&#39;: 6976, &#39;gates_1q&#39;: 5640}
</pre></div>
</div>
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="InQ_tut_vqd.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Variational Quantum Deflation for excited states</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="InQ_tut_vqe_1.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">A basic VQE simulation</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
              Copyright &#169; 2024 Quantinuum Ltd. All rights reserved.
            </div>
            <div class="terms" style="display:flex; gap:0.5rem; align-items:center; margin: 0.25rem 0rem;">
              <a href="https://www.quantinuum.com/privacy-statement" target="_blank">Privacy Statement</a>
              <div role="separator">/</div>
              <a href="https://www.quantinuum.com/cookie-notice" target="_blank">Cookie Notice</a>
              <div role="separator">/</div>
              <a href="https://www.quantinuum.com/terms-conditions" target="_blank">Terms and Conditions</a>
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Extended VQE</a><ul>
<li><a class="reference internal" href="#h2-bond-stretching">H2 Bond Stretching</a></li>
<li><a class="reference internal" href="#h2o-bending-active-space-reduction">H2O Bending - active space reduction</a></li>
<li><a class="reference internal" href="#h2o-stretching-symmetry-allowed-excitations">H2O Stretching - symmetry-allowed excitations</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/jquery.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    </body>
</html>