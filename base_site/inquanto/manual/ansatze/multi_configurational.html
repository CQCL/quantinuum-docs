<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YPQ1FTGDL3"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-YPQ1FTGDL3');
    </script>
    <link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Real Basis Rotation Ansatzes" href="basis_rotation.html" /><link rel="prev" title="Hardware Efficient Ansatz" href="hea.html" />

    <link rel="shortcut icon" href="../../_static/quantinuum_favicon.svg"/><!-- Generated with Sphinx 6.2.1 and Furo 2024.08.06 -->
        <title>Multiconfiguration States Using Givens Rotations - InQuanto 4.2.0</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=04c057b233f3c8d71940eee6080f658a04e2027d" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=cf727022eb7470bc603c08d2e55c3247faec75c9" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style>
<link rel="stylesheet" href="../../_static/tokens.css"/>
<link rel="stylesheet" href="../../_static/styles.css"/>
<link rel="stylesheet" href="../../_static/tailwind.css"/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="preload"
as="style">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">

<style>  
  .sidebar-sticky {
    top: calc(3.5rem - 0px);
    height: calc(100vh - 3.5rem);
  }
  
  @media (min-width: 97em) {
    html {
      font-size: 100% !important;
    }
  }
  
</style>
</head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>
<!-- <script type="text/javascript" src="../../_static/syncTheme.global.js" ></script> -->
 <!--Force light mode -->
 <script>document.body.setAttribute('data-theme','light')</script>
<nav style="position:fixed;top:0;z-index:1021;width:100%;">
    <div class="nexus-nav"></div>
</nav>
<script type="text/javascript" src="../../_static/injectNav.global.js"></script>
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">InQuanto 4.2.0</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/inquanto_short_logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">InQuanto 4.2.0</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/overview.html">What is InQuanto?</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../introduction/installation.html">Installation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Installation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/system_requirements.html">System Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../introduction/troubleshooting.html">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../introduction/quickstart.html">Quick-start</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../howto.html">How to use InQuanto</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../algorithms_overview.html">Algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Algorithms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../algorithms/variational_overview.html">Variational Algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Variational Algorithms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../algorithms/algorithms_vqe.html">Variational Quantum Eigensolver <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmVQE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../algorithms/algorithms_vqd.html">Variational Quantum Deflation <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmVQD</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../algorithms/algorithms_adapt.html">ADAPT-VQE</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../algorithms/non_variational_overview.html">Non-variational and Phase Estimation algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Non-variational and Phase Estimation algorithms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../algorithms/algorithms_qse.html">Quantum Subspace Expansion <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmQSE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../algorithms/algorithms_sceom.html">Quantum Self Consistent Equation of Motion <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmSCEOM</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../algorithms/qpe_canonical.html">Canonical Quantum Phase Estimation <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmDeterministicQPE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../algorithms/qpe_iterative.html">Iterative Phase Estimation Algorithms</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../algorithms/time_evolution_overview.html">Time evolution algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Time evolution algorithms</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../algorithms/te_vqs.html"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmVQS</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmMcLachlanRealTime</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmMcLachlanImagTime</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../computables_overview.html">Computables</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Computables</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../computables/basic_usage.html">Basic Usage and Composability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../computables/evaluating_w_protocols.html">Evaluating Computables with Protocols</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../computables/composite_computables.html">Composite Computables</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Composite Computables</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../computables/greens_function.html">Krylov subspace &amp; Green’s functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computables/rdms.html">Reduced Density Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../computables/overlap_matrix.html">Overlap Matrices &amp; Non-Orthogonal Subspaces</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../computables/primitives.html">Primitive Computables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../computables/custom_computables.html">Custom Computables &amp; Partial Evaluations</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../protocols_overview.html">Protocols</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Protocols</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../protocols/expval.html">Protocols for expectation values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/overlap_squared.html">Protocols for overlap squared</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/overlap.html">Protocols for overlaps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/derivative.html">Protocols for derivatives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/other.html">Other averaging protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/phase_est.html">Protocols for Phase Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../protocols/resource_estimation.html">Resource estimation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../errmit.html">Noise mitigation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spaces.html">Spaces, Operators, and States</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../ansatzae_overview.html">Ansatzes</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Ansatzes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ucc_family.html">The UCC Family</a></li>
<li class="toctree-l2"><a class="reference internal" href="chemically_aware.html">Chemically Aware Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="trotter_ansatz.html">Trotter Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="fermion_state_exp.html">Fermionic Exponentiated Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="circuit_ansatz.html">Circuit Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="composed_ansatz.html">Composed Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="hea.html">Hardware Efficient Ansatz</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Multiconfiguration States Using Givens Rotations</a></li>
<li class="toctree-l2"><a class="reference internal" href="basis_rotation.html">Real Basis Rotation Ansatzes</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../symmetry.html">Symmetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../geometry.html">Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../minimizers.html">Classical Minimizers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dmet.html">Density Matrix Embedding Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../express.html">Express</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials &amp; Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/tutorial_overview.html">Tutorials</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/tutorial_overview.html#core-tutorials">Core Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Core Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/InQ_tut_vqe_1.html">A basic VQE simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/InQ_tut_vqe_2.html">Extended VQE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/InQ_tut_vqd.html">Variational Quantum Deflation for excited states</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/InQ_tut_viz.html">Visualization with inquanto-nglview</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/tutorial_overview.html#backend-tutorials">Backend Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Backend Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/backends_overview.html">Backends Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/InQ_tut_Nexus_1.html"><b>Tutorial: InQuanto + qnexus</b></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/InQ_htut_Aer_H2.html">Running on the Aer simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/InQ_htut_qsys_H2.html">Running on Quantinuum Hardware</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/InQ_htut_qsys_l%2Br.html">Quantinuum Systems -  Launching circuits and retrieving results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/InQ_htut_qsys_qse.html">Quantinuum Systems -  Quantum Subspace Expansion</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/tutorial_overview.html#case-study-tutorials-fe4n2">Case Study Tutorials - Fe4N2</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Case Study Tutorials - Fe4N2</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/InQ_tut_fe4n2_1.html">Fe4N2 - 1 - system construction with AVAS and CASSCF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/InQ_tut_fe4n2_2.html">Fe4N2 - 2 - circuit construction with ADAPT-VQE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/InQ_tut_fe4n2_3.html">Fe4N2 - 3 - calculations on Quantinuum hardware</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorials/tutorial_overview.html#fragmentation-tutorials">Fragmentation Tutorials</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of Fragmentation Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/InQ_tut_dmet.html">Tackling larger systems with fragmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/InQ_tut_wft_dft.html">Projection-based embedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/InQ_tut_nevpt2_AC0.html">NEVPT2 and AC0 energy corrections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials/InQ_tut_wft_dft_2.html">Projection-based embedding with energy corrections</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/examples_overview.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extensions User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../extensions/extensions-overview.html">Extensions overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extensions/inquanto-nexus.html">InQuanto-Nexus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extensions/inquanto-pyscf.html">InQuanto-PySCF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extensions/inquanto-nglview.html">InQuanto-NGLView</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extensions/inquanto-phayes.html">InQuanto-Phayes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../extensions/extensions_examples.html">Extensions examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/inquanto_api_intro.html">InQuanto</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of InQuanto</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/inquanto/algorithms.html">inquanto.algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/inquanto/ansatz.html">inquanto.ansatzes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/inquanto/computables.html">inquanto.computables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/inquanto/core.html">inquanto.core</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/inquanto/embeddings.html">inquanto.embeddings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/inquanto/express.html">inquanto.express</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/inquanto/geometry.html">inquanto.geometries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/inquanto/mappings.html">inquanto.mappings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/inquanto/minimizers.html">inquanto.minimizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/inquanto/operators.html">inquanto.operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/inquanto/protocols.html">inquanto.protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/inquanto/spaces.html">inquanto.spaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/inquanto/states.html">inquanto.states</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/inquanto/symmetry.html">inquanto.symmetry</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/inquanto-ext_api_intro.html">InQuanto-Extensions</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of InQuanto-Extensions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/extensions/inquanto-nexus_api.html">InQuanto-Nexus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/extensions/inquanto-pyscf_api.html">InQuanto-PySCF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/extensions/inquanto-nglview_api.html">InQuanto-NGLView</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/extensions/inquanto-phayes.html">InQuanto-Phayes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/extensions/inquanto-cutensornet_api.html">InQuanto-cuTensorNet</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../misc/changelog.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/contact.html">Contact Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/cite.html">How to cite InQuanto</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/licence.html">License and Notices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/opensource.html">Open-source Attribution</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="multiconfiguration-states-using-givens-rotations">
<span id="multiconf"></span><h1>Multiconfiguration States Using Givens Rotations<a class="headerlink" href="#multiconfiguration-states-using-givens-rotations" title="Permalink to this heading">¶</a></h1>
<p>In InQuanto, Givens rotations can be used to prepare a quantum circuit corresponding to a linear combination of
determinants, where the latter are selected by the user and represented by the terms (occupation configurations) of
an InQuanto <a class="reference internal" href="../../api/inquanto/states.html#inquanto.states.QubitState" title="inquanto.states.QubitState"><code class="xref py py-class docutils literal notranslate"><span class="pre">QubitState</span></code></a>. The resulting object can be used as i) an ansatz itself, or ii)
a multiconfigurational generalization of a mean-field single reference, to which another ansatz (that allows for
multireference initial states) can be applied. In both of these cases, InQuanto allows for fixed and variational
configuration coefficients.</p>
<p>The methodology of preparing these circuits is based on proofs that multicontrolled Givens rotations are universal
for quantum chemistry <span id="id1">[<a class="reference internal" href="../../misc/bibliography.html#id40" title="Juan Miguel Arrazola, Olivia Di Matteo, Nicolás Quesada, Soran Jahangiri, Alain Delgado, and Nathan Killoran. Universal quantum circuits for quantum chemistry. Quantum, 6:742, June 2022. URL: https://doi.org/10.22331/q-2022-06-20-742, doi:10.22331/q-2022-06-20-742.">49</a>]</span>. A Givens rotation is a unitary operation that linearly mixes between
two configurations. Restricting to real coefficients, a 2-qubit (1-body) Givens unitary can be written in the
2-qubit computational basis as</p>
<div class="math-wrapper docutils container" id="equation-manual-ansatze-multi-configurational-0">
<div class="math notranslate nohighlight" id="equation-manual-ansatze-multi-configurational-0">
<span class="eqno">(99)<a class="headerlink" href="#equation-manual-ansatze-multi-configurational-0" title="Permalink to this equation">¶</a></span>\[\begin{split}G_1(\theta) = \begin{pmatrix}
1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; \cos(\theta) &amp; -\sin(\theta) &amp; 0 \\
0 &amp; \sin(\theta) &amp; \cos(\theta) &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1
\end{pmatrix}\end{split}\]</div>
</div>
<p>which corresponds to a rotation between the <span class="math notranslate nohighlight">\(|10\rangle\)</span> and <span class="math notranslate nohighlight">\(|01\rangle\)</span> basis states. This has a
straight-forward generalization to <span class="math notranslate nohighlight">\(n\)</span> qubits <span id="id2">[<a class="reference internal" href="../../misc/bibliography.html#id40" title="Juan Miguel Arrazola, Olivia Di Matteo, Nicolás Quesada, Soran Jahangiri, Alain Delgado, and Nathan Killoran. Universal quantum circuits for quantum chemistry. Quantum, 6:742, June 2022. URL: https://doi.org/10.22331/q-2022-06-20-742, doi:10.22331/q-2022-06-20-742.">49</a>]</span>. For example, if one chooses to
mix <span class="math notranslate nohighlight">\(|1100\rangle\)</span> and <span class="math notranslate nohighlight">\(|0011\rangle\)</span>, this can be done using a 4-qubit (2-body) Givens rotation
<span class="math notranslate nohighlight">\(G_2\)</span> applied to either <span class="math notranslate nohighlight">\(|1100\rangle\)</span> or <span class="math notranslate nohighlight">\(|0011\rangle\)</span> (and where <span class="math notranslate nohighlight">\(G_2\)</span> is a
4 <span class="math notranslate nohighlight">\(\times\)</span> 4 generalization of <span class="math notranslate nohighlight">\(G_1\)</span>, with appropriate lexicographical ordering)</p>
<div class="math-wrapper docutils container" id="equation-manual-ansatze-multi-configurational-1">
<div class="math notranslate nohighlight" id="equation-manual-ansatze-multi-configurational-1">
<span class="eqno">(100)<a class="headerlink" href="#equation-manual-ansatze-multi-configurational-1" title="Permalink to this equation">¶</a></span>\[\begin{split}G_2(\theta)|1100\rangle = \cos(\theta)|1100\rangle + \sin(\theta)|0011\rangle \\
G_2(\theta)|0011\rangle = \cos(\theta)|0011\rangle - \sin(\theta)|1100\rangle\end{split}\]</div>
</div>
<p>Hence the configuration coefficients correspond to elements of the unitary, are tied to the rotation angles
of the corresponding gates that implement the unitary, and must be normalized to unity. In InQuanto,
the gate decompositions previously reported in the literature for particle-number preserving forms of the <span class="math notranslate nohighlight">\(G_1\)</span>
and <span class="math notranslate nohighlight">\(G_2\)</span> <span id="id3">[<a class="reference internal" href="../../misc/bibliography.html#id40" title="Juan Miguel Arrazola, Olivia Di Matteo, Nicolás Quesada, Soran Jahangiri, Alain Delgado, and Nathan Killoran. Universal quantum circuits for quantum chemistry. Quantum, 6:742, June 2022. URL: https://doi.org/10.22331/q-2022-06-20-742, doi:10.22331/q-2022-06-20-742.">49</a>, <a class="reference internal" href="../../misc/bibliography.html#id41" title="Gian-Luca R Anselmetti, David Wierichs, Christian Gogolin, and Robert M Parrish. Local, expressive, quantum-number-preserving vqe ansätze for fermionic systems. New Journal of Physics, 23(11):113010, nov 2021. URL: https://dx.doi.org/10.1088/1367-2630/ac2cb3, doi:10.1088/1367-2630/ac2cb3.">50</a>]</span> are used in the Ansatz classes
<a class="reference internal" href="../../api/inquanto/ansatz.html#inquanto.ansatzes.MultiConfigurationState" title="inquanto.ansatzes.MultiConfigurationState"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiConfigurationState</span></code></a> and <a class="reference internal" href="../../api/inquanto/ansatz.html#inquanto.ansatzes.MultiConfigurationAnsatz" title="inquanto.ansatzes.MultiConfigurationAnsatz"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiConfigurationAnsatz</span></code></a>.</p>
<p>The following example shows how to use InQuanto to prepare a circuit in a quantum state corresponding to an equal
mixing of 2 occupation configurations:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.ansatzes</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiConfigurationState</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.states</span><span class="w"> </span><span class="kn">import</span> <span class="n">QubitState</span><span class="p">,</span> <span class="n">QubitStateString</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.extensions.qiskit</span><span class="w"> </span><span class="kn">import</span> <span class="n">AerStateBackend</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">sqrt</span>

<span class="n">config1</span><span class="p">,</span> <span class="n">c_1</span> <span class="o">=</span> <span class="n">QubitStateString</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">config2</span><span class="p">,</span> <span class="n">c_2</span> <span class="o">=</span> <span class="n">QubitStateString</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">qubit_states</span> <span class="o">=</span> <span class="n">QubitState</span><span class="p">({</span><span class="n">config1</span><span class="p">:</span> <span class="n">c_1</span><span class="p">,</span> <span class="n">config2</span><span class="p">:</span> <span class="n">c_2</span><span class="p">})</span>

<span class="n">multi_state</span> <span class="o">=</span> <span class="n">MultiConfigurationState</span><span class="p">(</span><span class="n">qubit_states</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">multi_state</span><span class="o">.</span><span class="n">circuit_resources</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;depth&#39;: 20, &#39;gates&#39;: 30, &#39;qubits&#39;: 4, &#39;gates_2q&#39;: 14, &#39;gates_1q&#39;: 16}
</pre></div>
</div>
</div>
</div>
<p>Here we have chosen the coefficients of both configurations <span class="math notranslate nohighlight">\(c_1 = c_2 = 1/\sqrt{2}\)</span>, but any real values
<span class="math notranslate nohighlight">\(c_i\)</span> are accepted as long as <span class="math notranslate nohighlight">\(\sum_i |c_i|^2 = 1\)</span>.</p>
<p>When linearly combining more than two determinants, all rotations must end up in the desired Fock space sector.
This conserves spin and particle numbers, and prevents
unwanted configurations from entering the full expansion of the rotated state vector. One way to
accomplish this is to apply Givens rotations in a sequence corresponding to the order of input configurations (i.e.
the order of <a class="reference internal" href="../../api/inquanto/states.html#inquanto.states.QubitStateString" title="inquanto.states.QubitStateString"><code class="xref py py-class docutils literal notranslate"><span class="pre">QubitStateString</span></code></a> objects used to instantiate
<a class="reference internal" href="../../api/inquanto/states.html#inquanto.states.QubitState" title="inquanto.states.QubitState"><code class="xref py py-class docutils literal notranslate"><span class="pre">QubitState</span></code></a>). A Givens rotation at the <span class="math notranslate nohighlight">\(j^{\text{th}}\)</span> configuration in the sequence is
then controlled on certain qubits only if necessary; the necessity depending on whether it can also rotate any of the <span class="math notranslate nohighlight">\(i&lt;j\)</span>
configurations. In InQuanto, this is implemented in a general way that guarantees the state of the circuit will be
the user-defined linear combination of configurations (with user-defined coefficients for
<a class="reference internal" href="../../api/inquanto/ansatz.html#inquanto.ansatzes.MultiConfigurationState" title="inquanto.ansatzes.MultiConfigurationState"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiConfigurationState</span></code></a>). However, the size of the circuits can increase significantly
when these extra controls are present. Consider adding a third configuration <span class="math notranslate nohighlight">\(|1001\rangle\)</span> to the example above,
such that the second Givens rotation to mix <span class="math notranslate nohighlight">\(|1100\rangle\)</span> and <span class="math notranslate nohighlight">\(|1001\rangle\)</span> can also act on the basis
state <span class="math notranslate nohighlight">\(|0011\rangle\)</span>. This more than doubles the circuit size since that single excitation (second Givens
rotation) needs to be controlled on a qubit of the first configuration:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.ansatzes</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiConfigurationState</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.states</span><span class="w"> </span><span class="kn">import</span> <span class="n">QubitState</span><span class="p">,</span> <span class="n">QubitStateString</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.extensions.qiskit</span><span class="w"> </span><span class="kn">import</span> <span class="n">AerStateBackend</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">sqrt</span>

<span class="n">config1</span><span class="p">,</span> <span class="n">c_1</span> <span class="o">=</span> <span class="n">QubitStateString</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">config2</span><span class="p">,</span> <span class="n">c_2</span> <span class="o">=</span> <span class="n">QubitStateString</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">config3</span><span class="p">,</span> <span class="n">c_3</span> <span class="o">=</span> <span class="n">QubitStateString</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">qubit_states</span> <span class="o">=</span> <span class="n">QubitState</span><span class="p">({</span><span class="n">config1</span><span class="p">:</span> <span class="n">c_1</span><span class="p">,</span> <span class="n">config2</span><span class="p">:</span> <span class="n">c_2</span><span class="p">,</span> <span class="n">config3</span><span class="p">:</span> <span class="n">c_3</span><span class="p">,})</span>

<span class="n">multi_state</span> <span class="o">=</span> <span class="n">MultiConfigurationState</span><span class="p">(</span><span class="n">qubit_states</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">multi_state</span><span class="o">.</span><span class="n">circuit_resources</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;depth&#39;: 72, &#39;gates&#39;: 98, &#39;qubits&#39;: 4, &#39;gates_2q&#39;: 42, &#39;gates_1q&#39;: 56}
</pre></div>
</div>
</div>
</div>
<p>However, adding a configuration with an associated Givens rotation that can not act on previous configurations
(in the sense that the two Givens rotations act on disjoint qubit subspaces) leads to only a linear (with respect to
the number of configurations) increase in circuit size. By keeping this in mind, the same state vector as above can
be obtained with less gates by changing the order so that <span class="math notranslate nohighlight">\(|1001\rangle\)</span> is “before” <span class="math notranslate nohighlight">\(|0011\rangle\)</span>,
since no extra controls of the Givens rotations are needed in this in order:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.ansatzes</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiConfigurationState</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.states</span><span class="w"> </span><span class="kn">import</span> <span class="n">QubitState</span><span class="p">,</span> <span class="n">QubitStateString</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.extensions.qiskit</span><span class="w"> </span><span class="kn">import</span> <span class="n">AerStateBackend</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">sqrt</span>

<span class="n">config1</span><span class="p">,</span> <span class="n">c_1</span> <span class="o">=</span> <span class="n">QubitStateString</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">config2</span><span class="p">,</span> <span class="n">c_2</span> <span class="o">=</span> <span class="n">QubitStateString</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">config3</span><span class="p">,</span> <span class="n">c_3</span> <span class="o">=</span> <span class="n">QubitStateString</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">qubit_states</span> <span class="o">=</span> <span class="n">QubitState</span><span class="p">({</span><span class="n">config1</span><span class="p">:</span> <span class="n">c_1</span><span class="p">,</span> <span class="n">config2</span><span class="p">:</span> <span class="n">c_2</span><span class="p">,</span> <span class="n">config3</span><span class="p">:</span> <span class="n">c_3</span><span class="p">,})</span>

<span class="n">multi_state</span> <span class="o">=</span> <span class="n">MultiConfigurationState</span><span class="p">(</span><span class="n">qubit_states</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">multi_state</span><span class="o">.</span><span class="n">circuit_resources</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;depth&#39;: 27, &#39;gates&#39;: 36, &#39;qubits&#39;: 4, &#39;gates_2q&#39;: 18, &#39;gates_1q&#39;: 18}
</pre></div>
</div>
</div>
</div>
<p>Basis states separated by more than two-body rotations (e.g. a rotation corresponding to a
triples excitation) can also be linearly combined. For this, a sequence of multicontrolled SWAPs combined with a
multicontrolled <span class="math notranslate nohighlight">\(G_1\)</span> rotation <span id="id4">[<a class="reference internal" href="../../misc/bibliography.html#id40" title="Juan Miguel Arrazola, Olivia Di Matteo, Nicolás Quesada, Soran Jahangiri, Alain Delgado, and Nathan Killoran. Universal quantum circuits for quantum chemistry. Quantum, 6:742, June 2022. URL: https://doi.org/10.22331/q-2022-06-20-742, doi:10.22331/q-2022-06-20-742.">49</a>]</span> is utilized. This multicontrolled
“SWAP+rotation ladder” can represent a general chemical excitation to any order. However, again due to the use of extra controls,
a large increase in circuit depth is observed when comparing a 2-body mixing to e.g. 3-body mixing. The following
example shows this by first preparing
<span class="math notranslate nohighlight">\(|\psi \rangle = \frac{1}{\sqrt{2}}|111000\rangle + \frac{1}{\sqrt{2}}|100011\rangle\)</span> (separated by a
2-body excitation), then preparing
<span class="math notranslate nohighlight">\(|\psi \rangle = \frac{1}{\sqrt{2}}|111000\rangle + \frac{1}{\sqrt{2}}|000111\rangle\)</span> (separated by a
3-body excitation), and then comparing the size of the corresponding circuits:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.ansatzes</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiConfigurationState</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.states</span><span class="w"> </span><span class="kn">import</span> <span class="n">QubitState</span><span class="p">,</span> <span class="n">QubitStateString</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.extensions.qiskit</span><span class="w"> </span><span class="kn">import</span> <span class="n">AerStateBackend</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">sqrt</span>

<span class="n">backend</span> <span class="o">=</span> <span class="n">AerStateBackend</span><span class="p">()</span>

<span class="n">config1</span><span class="p">,</span> <span class="n">c_1</span> <span class="o">=</span> <span class="n">QubitStateString</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">config2</span><span class="p">,</span> <span class="n">c_2</span> <span class="o">=</span> <span class="n">QubitStateString</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">qs_2bodyrot</span> <span class="o">=</span> <span class="n">QubitState</span><span class="p">({</span><span class="n">config1</span><span class="p">:</span> <span class="n">c_1</span><span class="p">,</span> <span class="n">config2</span><span class="p">:</span> <span class="n">c_2</span><span class="p">})</span>

<span class="n">ms_2bodyrot</span> <span class="o">=</span> <span class="n">MultiConfigurationState</span><span class="p">(</span><span class="n">qs_2bodyrot</span><span class="p">)</span>
<span class="n">ms_circ_2bodyrot</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">get_compiled_circuit</span><span class="p">(</span><span class="n">ms_2bodyrot</span><span class="o">.</span><span class="n">get_circuit</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Circuit depth, configs separated by 2-body excitation:&quot;</span><span class="p">,</span> <span class="n">ms_circ_2bodyrot</span><span class="o">.</span><span class="n">depth</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of gates, configs separated by 2-body excitation:&quot;</span><span class="p">,</span> <span class="n">ms_circ_2bodyrot</span><span class="o">.</span><span class="n">n_gates</span><span class="p">)</span>

<span class="n">config1</span><span class="p">,</span> <span class="n">c_1</span> <span class="o">=</span> <span class="n">QubitStateString</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">config2</span><span class="p">,</span> <span class="n">c_2</span> <span class="o">=</span> <span class="n">QubitStateString</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">qs_3bodyrot</span> <span class="o">=</span> <span class="n">QubitState</span><span class="p">({</span><span class="n">config1</span><span class="p">:</span> <span class="n">c_1</span><span class="p">,</span> <span class="n">config2</span><span class="p">:</span> <span class="n">c_2</span><span class="p">})</span>

<span class="n">ms_3bodyrot</span> <span class="o">=</span> <span class="n">MultiConfigurationState</span><span class="p">(</span><span class="n">qs_3bodyrot</span><span class="p">)</span>
<span class="n">ms_circ_3bodyrot</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">get_compiled_circuit</span><span class="p">(</span><span class="n">ms_3bodyrot</span><span class="o">.</span><span class="n">get_circuit</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Circuit depth, configs separated by 3-body excitation:&quot;</span><span class="p">,</span> <span class="n">ms_circ_3bodyrot</span><span class="o">.</span><span class="n">depth</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of gates, configs separated by 3-body excitation:&quot;</span><span class="p">,</span> <span class="n">ms_circ_3bodyrot</span><span class="o">.</span><span class="n">n_gates</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Circuit depth, configs separated by 2-body excitation: 21
Number of gates, configs separated by 2-body excitation: 35
</pre></div>
</div>
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>
Circuit depth, configs separated by 3-body excitation: 321
Number of gates, configs separated by 3-body excitation: 347
</pre></div>
</div>
</div>
</div>
<p>How much the circuit size increases due to the presence of (multi)controls depends crucially on their decomposition
to a particular gate set. The well-known approach based on recursive decomposition of Toffoli gates yields quadratic
scaling with respect to the number of control qubits <span id="id5">[<a class="reference internal" href="../../misc/bibliography.html#id43" title="Adriano Barenco, Charles H. Bennett, Richard Cleve, David P. DiVincenzo, Norman Margolus, Peter Shor, Tycho Sleator, John A. Smolin, and Harald Weinfurter. Elementary gates for quantum computation. Phys. Rev. A, 52:3457–3467, Nov 1995. URL: https://link.aps.org/doi/10.1103/PhysRevA.52.3457, doi:10.1103/PhysRevA.52.3457.">51</a>]</span>. Currently,
pytket utilizes a linear depth scaling approach for
decomposing multicontrols <span id="id6">[<a class="reference internal" href="../../misc/bibliography.html#id44" title="Adenilton J. da Silva and Daniel K. Park. Linear-depth quantum circuits for multiqubit controlled gates. Phys. Rev. A, 106:042602, Oct 2022. URL: https://link.aps.org/doi/10.1103/PhysRevA.106.042602, doi:10.1103/PhysRevA.106.042602.">52</a>]</span> during circuit compilation for intermediate (<span class="math notranslate nohighlight">\(6 \le n \le 50\)</span>)
numbers of control qubits. However, the user should in general be cautious of large circuits when mixing
of a large number of basis configurations and/or mixing configurations that are separated by (<span class="math notranslate nohighlight">\(N&gt;2\)</span>)-body rotations.</p>
<section id="symbolic-multiconfiguration-ansatz">
<h2>Symbolic Multiconfiguration Ansatz<a class="headerlink" href="#symbolic-multiconfiguration-ansatz" title="Permalink to this heading">¶</a></h2>
<p>In all the examples shown above, the resulting ansatz object corresponds to a multiconfiguration state with fixed
coefficients. In the next example we show how to prepare an ansatz object with variational coefficients. For this we
use the InQuanto ansatz class <a class="reference internal" href="../../api/inquanto/ansatz.html#inquanto.ansatzes.MultiConfigurationAnsatz" title="inquanto.ansatzes.MultiConfigurationAnsatz"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiConfigurationAnsatz</span></code></a>. An instance of this class
can be used in an InQuanto computable which in turn can be plugged into an InQuanto algorithm in the usual ways
(see <a class="reference internal" href="../algorithms_overview.html#algorithms"><span class="std std-ref">Algorithms</span></a> and <a class="reference internal" href="../computables_overview.html#computables"><span class="std std-ref">Computables</span></a> sections) to optimize the coefficients and
obtain the ground state:</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.ansatzes</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiConfigurationAnsatz</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.states</span><span class="w"> </span><span class="kn">import</span> <span class="n">QubitStateString</span>

<span class="n">qss_ref</span> <span class="o">=</span> <span class="n">QubitStateString</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">qss_2</span> <span class="o">=</span> <span class="n">QubitStateString</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">qss_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">qss_ref</span><span class="p">,</span> <span class="n">qss_2</span><span class="p">]</span>
<span class="n">ansatz</span> <span class="o">=</span> <span class="n">MultiConfigurationAnsatz</span><span class="p">(</span><span class="n">qss_list</span><span class="p">)</span>
<span class="c1"># |psi&gt; = a|1100&gt; + b|0011&gt; , b = SQRT(1 - |a|^2) =&gt; only 1 parameter in VQE</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ansatz parameter info&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;symbols:&quot;</span><span class="p">,</span> <span class="n">ansatz</span><span class="o">.</span><span class="n">state_symbols</span><span class="o">.</span><span class="n">symbols</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;N_parameters:&quot;</span><span class="p">,</span> <span class="n">ansatz</span><span class="o">.</span><span class="n">n_symbols</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Ansatz parameter info
symbols: [theta0]
N_parameters: 1
</pre></div>
</div>
</div>
</div>
<p>Then, by optimizing the rotation angles of the Givens unitaries via VQE, a quantum circuit version of configuration
interaction is achieved in which the determinants are selected <em>a-priori</em> followed by a variational optimization of
their coefficients.</p>
<p>Note that <a class="reference internal" href="../../api/inquanto/ansatz.html#inquanto.ansatzes.MultiConfigurationAnsatz" title="inquanto.ansatzes.MultiConfigurationAnsatz"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiConfigurationAnsatz</span></code></a> takes a list of
<a class="reference internal" href="../../api/inquanto/states.html#inquanto.states.QubitStateString" title="inquanto.states.QubitStateString"><code class="xref py py-class docutils literal notranslate"><span class="pre">QubitStateString</span></code></a> objects (representing Slater determinants) as its input argument. This
differs from <a class="reference internal" href="../../api/inquanto/ansatz.html#inquanto.ansatzes.MultiConfigurationState" title="inquanto.ansatzes.MultiConfigurationState"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiConfigurationState</span></code></a> which needs a <a class="reference internal" href="../../api/inquanto/states.html#inquanto.states.QubitState" title="inquanto.states.QubitState"><code class="xref py py-class docutils literal notranslate"><span class="pre">QubitState</span></code></a>
object containing occupations states and their coefficients (so that gate angles are calculated for a given set of
coefficients during instantiation of <a class="reference internal" href="../../api/inquanto/ansatz.html#inquanto.ansatzes.MultiConfigurationState" title="inquanto.ansatzes.MultiConfigurationState"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiConfigurationState</span></code></a>). On the other hand,
<a class="reference internal" href="../../api/inquanto/ansatz.html#inquanto.ansatzes.MultiConfigurationAnsatz" title="inquanto.ansatzes.MultiConfigurationAnsatz"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiConfigurationAnsatz</span></code></a> only needs occupation states to construct the variational ansatz
(in this case the rotation angles of the object returned by <a class="reference internal" href="../../api/inquanto/ansatz.html#inquanto.ansatzes.MultiConfigurationAnsatz" title="inquanto.ansatzes.MultiConfigurationAnsatz"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiConfigurationAnsatz</span></code></a> are
symbolic). However, the symbols representing these coefficients are related by normalization, hence in this example
there is only 1 variational parameter.</p>
</section>
<section id="multiconfiguration-states-without-givens-rotations">
<h2>Multiconfiguration states without Givens rotations<a class="headerlink" href="#multiconfiguration-states-without-givens-rotations" title="Permalink to this heading">¶</a></h2>
<p>In addition to <a class="reference internal" href="../../api/inquanto/ansatz.html#inquanto.ansatzes.MultiConfigurationState" title="inquanto.ansatzes.MultiConfigurationState"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiConfigurationState</span></code></a> which uses Givens rotations, a user can also prepare
arbitrary multiconfigurational states with fixed coefficients by utilizing pytket’s
<a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/circuit.html#pytket.circuit.StatePreparationBox">StatePreparationBox</a> via
InQuanto. This can be done using the InQuanto Ansatz class <a class="reference internal" href="../../api/inquanto/ansatz.html#inquanto.ansatzes.MultiConfigurationStateBox" title="inquanto.ansatzes.MultiConfigurationStateBox"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiConfigurationStateBox</span></code></a>,
which serves as a wrapper of
<a class="reference external" href="https://docs.quantinuum.com/tket/api-docs/circuit.html#pytket.circuit.StatePreparationBox">StatePreparationBox</a>. The API
is similar to <a class="reference internal" href="../../api/inquanto/ansatz.html#inquanto.ansatzes.MultiConfigurationState" title="inquanto.ansatzes.MultiConfigurationState"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiConfigurationState</span></code></a>. The major differences between
<a class="reference internal" href="../../api/inquanto/ansatz.html#inquanto.ansatzes.MultiConfigurationState" title="inquanto.ansatzes.MultiConfigurationState"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiConfigurationState</span></code></a> and <a class="reference internal" href="../../api/inquanto/ansatz.html#inquanto.ansatzes.MultiConfigurationStateBox" title="inquanto.ansatzes.MultiConfigurationStateBox"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiConfigurationStateBox</span></code></a> is that
the latter does not use Given’s rotations specifically, but rather multiplexed <span class="math notranslate nohighlight">\(R_y\)</span> and <span class="math notranslate nohighlight">\(R_z\)</span> gates which
prepare a circuit from a statevector provided in the computational basis (see <span id="id8">[<a class="reference internal" href="../../misc/bibliography.html#id42" title="Philipp Niemann, Rhitam Datta, and Robert Wille. Logic synthesis for quantum state generation. In 2016 IEEE 46th International Symposium on Multiple-Valued Logic (ISMVL), volume, 247-252. 2016. doi:10.1109/ISMVL.2016.30.">53</a>]</span> for more details on the
circuit synthesis method). This means that, unlike in <a class="reference internal" href="../../api/inquanto/ansatz.html#inquanto.ansatzes.MultiConfigurationState" title="inquanto.ansatzes.MultiConfigurationState"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiConfigurationState</span></code></a>, for
<a class="reference internal" href="../../api/inquanto/ansatz.html#inquanto.ansatzes.MultiConfigurationStateBox" title="inquanto.ansatzes.MultiConfigurationStateBox"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiConfigurationStateBox</span></code></a> the input <a class="reference internal" href="../../api/inquanto/states.html#inquanto.states.QubitState" title="inquanto.states.QubitState"><code class="xref py py-class docutils literal notranslate"><span class="pre">QubitState</span></code></a> (which specifies
the chemical occuptations) has to be converted to a computational statevector in <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> format,
<em>before</em> the circuit is built. This is akin to first solving an exponentially scaling classical problem before
preparing the state circuit. Hence, <a class="reference internal" href="../../api/inquanto/ansatz.html#inquanto.ansatzes.MultiConfigurationStateBox" title="inquanto.ansatzes.MultiConfigurationStateBox"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiConfigurationStateBox</span></code></a> is considered a tool for exploring
and debugging state preparation schemes, rather than a scalable state preparation method. An example showing its usage
is given below.</p>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.ansatzes</span><span class="w"> </span><span class="kn">import</span> <span class="n">MultiConfigurationStateBox</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inquanto.states</span><span class="w"> </span><span class="kn">import</span> <span class="n">QubitState</span><span class="p">,</span> <span class="n">QubitStateString</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.extensions.qiskit</span><span class="w"> </span><span class="kn">import</span> <span class="n">AerStateBackend</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="n">sqrt</span>

<span class="n">config1</span><span class="p">,</span> <span class="n">c_1</span> <span class="o">=</span> <span class="n">QubitStateString</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">config2</span><span class="p">,</span> <span class="n">c_2</span> <span class="o">=</span> <span class="n">QubitStateString</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">qubit_states</span> <span class="o">=</span> <span class="n">QubitState</span><span class="p">({</span><span class="n">config1</span><span class="p">:</span> <span class="n">c_1</span><span class="p">,</span> <span class="n">config2</span><span class="p">:</span> <span class="n">c_2</span><span class="p">})</span>

<span class="n">multi_state</span> <span class="o">=</span> <span class="n">MultiConfigurationStateBox</span><span class="p">(</span><span class="n">qubit_states</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">multi_state</span><span class="o">.</span><span class="n">circuit_resources</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;depth&#39;: 26, &#39;gates&#39;: 29, &#39;qubits&#39;: 4, &#39;gates_2q&#39;: 14, &#39;gates_1q&#39;: 15}
</pre></div>
</div>
</div>
</div>
<p>Note that in <a class="reference internal" href="../../api/inquanto/ansatz.html#inquanto.ansatzes.MultiConfigurationStateBox" title="inquanto.ansatzes.MultiConfigurationStateBox"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiConfigurationStateBox</span></code></a> coefficients must be fixed and non-symbolic,
hence the use of this class to variationally optimize the configuration coefficients is currently not
supported.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="basis_rotation.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Real Basis Rotation Ansatzes</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="hea.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Hardware Efficient Ansatz</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
              Copyright &#169; 2024 Quantinuum Ltd. All rights reserved.
            </div>
            <div class="terms" style="display:flex; gap:0.5rem; align-items:center; margin: 0.25rem 0rem;">
              <a href="https://www.quantinuum.com/privacy-statement" target="_blank">Privacy Statement</a>
              <div role="separator">/</div>
              <a href="https://www.quantinuum.com/cookie-notice" target="_blank">Cookie Notice</a>
              <div role="separator">/</div>
              <a href="https://www.quantinuum.com/terms-conditions" target="_blank">Terms and Conditions</a>
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Multiconfiguration States Using Givens Rotations</a><ul>
<li><a class="reference internal" href="#symbolic-multiconfiguration-ansatz">Symbolic Multiconfiguration Ansatz</a></li>
<li><a class="reference internal" href="#multiconfiguration-states-without-givens-rotations">Multiconfiguration states without Givens rotations</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/jquery.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>
    </body>
</html>