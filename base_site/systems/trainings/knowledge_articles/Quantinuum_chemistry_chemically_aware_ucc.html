<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YPQ1FTGDL3"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-YPQ1FTGDL3');
    </script>
    <link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="High Energy Physics: Implementing \(SU(2)\) Lattice Gauge Theory Trotter Circuits" href="Quantinuum_high_energy_physics_experiment.html" /><link rel="prev" title="Knowledge Articles" href="ka_index.html" />

    <link rel="shortcut icon" href="../../_static/quantinuum_favicon.svg"/><!-- Generated with Sphinx 8.2.1 and Furo 2024.08.06 -->
        <title>Quantum Chemistry Calculations with Arbitrary Angle 2-Qubit Gates - Quantinuum Systems</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=d7660fb1" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style>
<link rel="stylesheet" href="../../_static/tokens.css"/>
<link rel="stylesheet" href="../../_static/styles.css"/>
<link rel="stylesheet" href="../../_static/tailwind.css"/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="preload"
as="style">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">

<style>  
  .sidebar-sticky {
    top: calc(3.5rem - 0px);
    height: calc(100vh - 3.5rem);
  }
  
  @media (min-width: 97em) {
    html {
      font-size: 100% !important;
    }
  }
  
</style>
</head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>
<!-- <script type="text/javascript" src="../../_static/syncTheme.global.js" ></script> -->
 <!--Force light mode -->
 <script>document.body.setAttribute('data-theme','light')</script>
<nav style="position:fixed;top:0;z-index:1021;width:100%;">
    <div class="nexus-nav"></div>
</nav>
<script type="text/javascript" src="../../_static/injectNav.global.js"></script>
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Quantinuum Systems</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/systems.svg" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User Guides</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../user_guide/hardware_user_guide/access.html">Hardware User Guide</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Hardware User Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/hardware_user_guide/access.html">Quantinuum Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/hardware_user_guide/system_operation.html">System Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/hardware_user_guide/workflow.html">System Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/hardware_user_guide/fair_queue.html">Fair Queue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/hardware_user_guide/error_measurements.html">Error Measurements</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../user_guide/emulator_user_guide/introduction.html">Emulator User Guide</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Emulator User Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/emulator_user_guide/introduction.html">Quantinuum Emulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/emulator_user_guide/noise_model.html">Noise Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/emulator_user_guide/emulators/h1_emulators.html">H1 Emulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/emulator_user_guide/emulators/h2_emulators.html">H2 Emulators</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://docs.quantinuum.com/nexus/user_guide/user_guide.html">Nexus User Guide</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.quantinuum.com/nexus/admin_guide/admin_guide.html">Nexus Admin Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Trainings</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../getting_started/getting_started_index.html">Getting Started</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Getting Started</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/getting_started_index.html">Unique Capabilities</a></li>
<li class="toctree-l2"><a class="reference external" href="https://docs.quantinuum.com/nexus/trainings/getting_started.html">Quantinuum Nexus</a></li>
<li class="toctree-l2"><a class="reference external" href="https://docs.quantinuum.com/tket/user-guide/index.html">TKET</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/emulators.html">Quantinuum Emulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/mcmr.html">Mid-Circuit Measurement &amp; Reset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/arbitrary_angle_2_qubit_gates.html">Native Arbitrary Angle Hardware Gates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/conditional_operations_and_classical_logic.html">Conditional Operations &amp; Classical Logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/batch_jobs.html">Batch Jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/api_options.html">Quantinuum Systems API Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/access_systems_with_qiskit.html">Using Qiskit with Quantinuum Devices</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../getting_started/qec_decoder_toolkit/qec_decoder_toolkit.html">QEC Decoder Toolkit</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of QEC Decoder Toolkit</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/qec_decoder_toolkit/qec_decoder_toolkit.html">QEC Decoder Toolkit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/qec_decoder_toolkit/repeat_until_success/rus_index.html">Repeat Until Success</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/qec_decoder_toolkit/repetition_code/repetition_code_index.html">Repetition Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/qec_decoder_toolkit/surface_code/surface_code_index.html">Surface Code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/pytket_quantinuum/pytket_quantinuum.html"><code class="docutils literal notranslate"><span class="pre">pytket-quantinuum</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="ka_index.html">Knowledge Articles</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Knowledge Articles</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Quantum Chemistry Calculations with Arbitrary Angle 2-Qubit Gates</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quantinuum_high_energy_physics_experiment.html">High Energy Physics: Implementing <span class="math notranslate nohighlight">\(SU(2)\)</span> Lattice Gauge Theory Trotter Circuits</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quantinuum_leakage_detection.html">Automatic Leakage Error Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quantinuum_toric_code.html">Topological Order from Measurements and Feed-Forward</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quantinuum_variational_experiment_with_batching.html">Variational Experiment with Batching</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quantinuum_n56_ghz_state_fidelity.html">GHZ State Fidelity</a></li>
<li class="toctree-l2"><a class="reference internal" href="circuit_stitching.html">Circuit Stitching</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../support/product_change_notifications.html">Product Change Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support/faqs.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support/quantinuum_systems_citations.html">How to Cite Quantinuum Systems</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="quantum-chemistry-calculations-with-arbitrary-angle-2-qubit-gates">
<h1>Quantum Chemistry Calculations with Arbitrary Angle 2-Qubit Gates<a class="headerlink" href="#quantum-chemistry-calculations-with-arbitrary-angle-2-qubit-gates" title="Link to this heading">¶</a></h1>
<p>This notebook demonstrates a Hamiltonian Avaraging procedure for a 6-qubit  electronic structure chemistry problem on an Quantinuum machines with the  Chemically-Aware Unitary Coupled Cluster (UCC) Ansatz.</p>
<p>The aim is to estimate the energy of the <span class="math notranslate nohighlight">\(\textrm{CH}_4\)</span> molecule. The Hamiltonian Averaging procedure is used to estimate this quantity.</p>
<p>VQE uses Hamiltonian Averaging, aiming to optimise an initial  parameter set to obtain the lowest energy. In this use case, only one iteration of VQE is executed on Quantinuum emulators. The optimal parameters characterising the ground-state of <span class="math notranslate nohighlight">\(\textrm{CH}_4\)</span> are obtained from  a noiseless statevector simulator on a classical computer - VQE is performed on a classical computer as  a pre-processing step. These parameters are substituted into the Chemically-Aware UCC circuit. This circuit is then combined with the measurement operations necessary to measure the <span class="math notranslate nohighlight">\(\textrm{CH}_4\)</span> Hamiltonian and executed on hardware.</p>
<p>To minimise the 2-qubit gate resources, approximations are made to represent this molecule with 6-qubits. The Chemically Aware UCC Ansatz can be defined with both arbitrary-angle 2-qubit gates and fixed-angle 2-qubit gates. With arbitrary-angle 2-qubit gates, a higher quality output is
expected.</p>
<p>For further information on Quantinuum’s computational chemistry capabilities, please see Quantinuum’s premium Python-based R&amp;D platform, <a class="reference external" href="https://www.quantinuum.com/computationalchemistry/inquanto">InQuanto</a>. Capabilities include, but are not limited to, ground-state and excited-state calculations with the proprietary Chemically-Aware UCC method, additional productivity tools to improve result quality, and resource cost for calculations on Quantinuum hardware.</p>
<p>The <span class="math notranslate nohighlight">\(\textrm{CH}_4\)</span> problem was simulated on Quantinuum hardware to estimate (1) optical spectra and (2) a chemical reaction to remove <span class="math notranslate nohighlight">\(\textrm{CH}_4\)</span>, a greenhouse gas from the atmosphere <a class="reference external" href="https://pubs.aip.org/aip/jcp/article-abstract/158/21/214114/2893956/Chemically-aware-unitary-coupled-cluster-with-ab?redirectedFrom=fulltext">Link</a>.</p>
<p>The following software packages are required by this notebook:</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Package</p></th>
<th class="head"><p>Version</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pytket</span></code></p></td>
<td><p>v1.22.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">numpy</span></code></p></td>
<td><p>v1.26.2</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sympy</span></code></p></td>
<td><p>v1.12.0</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">pandas</span></code></p></td>
<td><p>v2.1.3</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">seaborn</span></code></p></td>
<td><p>v0.13.0</p></td>
</tr>
</tbody>
</table>
</div>
<section id="links">
<h2>Links<a class="headerlink" href="#links" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://www.quantinuum.com/computationalchemistry/inquanto">InQuanto Chemistry R&amp;D Platform</a></p></li>
<li><p><a class="reference external" href="https://pubs.aip.org/aip/jcp/article-abstract/158/21/214114/2893956/Chemically-aware-unitary-coupled-cluster-with-ab?redirectedFrom=fulltext">Chemically aware unitary coupled cluster with ab initio calculations on an ion trap quantum computer: A refrigerant chemicals’ application</a></p></li>
</ul>
</section>
<section id="hamiltonian-specification">
<h2>Hamiltonian Specification<a class="headerlink" href="#hamiltonian-specification" title="Link to this heading">¶</a></h2>
<p>First we load in a 6-qubit <span class="math notranslate nohighlight">\(\textrm{CH}_4\)</span> Hamiltonian from the <code class="docutils literal notranslate"><span class="pre">data</span></code> subdirectory. The Hamiltonian data is stored in a <code class="docutils literal notranslate"><span class="pre">json</span></code> file. This is loaded into the <code class="docutils literal notranslate"><span class="pre">QubitPauliOperator</span></code> instance using the class method <code class="docutils literal notranslate"><span class="pre">from_list</span></code>.</p>
<p>This Hamiltonian is generated using InQuanto. For more information, please contact <a class="reference external" href="mailto:inquanto-support&#37;&#52;&#48;quantinuum&#46;com">inquanto-support<span>&#64;</span>quantinuum<span>&#46;</span>com</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">json</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.utils.operators</span><span class="w"> </span><span class="kn">import</span> <span class="n">QubitPauliOperator</span>

<span class="n">json_io</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;data/hamiltonian_ch4_6qb.json&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">hamiltonian_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">json_io</span><span class="p">)</span>

<span class="n">hamiltonian</span> <span class="o">=</span> <span class="n">QubitPauliOperator</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">hamiltonian_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="chemically-aware-ucc-circuit-with-fixed-angle-2-qubit-gates">
<h2>Chemically-Aware UCC Circuit with Fixed-Angle 2-Qubit Gates<a class="headerlink" href="#chemically-aware-ucc-circuit-with-fixed-angle-2-qubit-gates" title="Link to this heading">¶</a></h2>
<p>The Chemically-Aware UCC state-preparation method for this <span class="math notranslate nohighlight">\(\textrm{CH}_4\)</span> consists of applying exponentiated Qubit Pauli operations to a reference input state. Our input state is <span class="math notranslate nohighlight">\(| 100000 \rangle\)</span>. The aim is to generate the parameteric wavefunction,</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{equation*}
|\psi\rangle = |110000\rangle + \alpha |001100\rangle + \beta |000011\rangle,
\end{equation*}\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> are related to gate angles on the state-preparation circuit.</p>
<p>In this problem, four operations are applied, the top equation first and the bottom equation last,
$<span class="math notranslate nohighlight">\(\begin{align*}
e^{+\theta_0 \frac{\pi}{2} \hat{Y}_{q[0]} \hat{X}_{q[2]}}, \\
e^{-\theta_0 \frac{\pi}{2} \hat{X}_{q[0]} \hat{Y}_{q[2]}}, \\
e^{+\theta_1 \frac{\pi}{2} \hat{Y}_{q[0]} \hat{X}_{q[4]}}, \\
e^{-\theta_1 \frac{\pi}{2} \hat{X}_{q[0]} \hat{Y}_{q[4]}}.
\end{align*}\)</span>$</p>
<p>This will generate the state, <span class="math notranslate nohighlight">\(|100000\rangle + \alpha |001000\rangle + \beta |000010\rangle\)</span>. Subsequently, three <code class="docutils literal notranslate"><span class="pre">CX</span></code> gates can be applied to generate the final target state, <span class="math notranslate nohighlight">\(|\psi\rangle\)</span>.</p>
<p>This operation can be seen as exciting a pair of electrons from the least energetic spatial orbital to a higher energy spatial orbital. In  this problem, we have three spatial orbitals: one double occupied orbital, and two unoccupied or virtual orbitals. Each even-odd qubit pair  in the circuit corresponds to the spatial orbitals. Each spatial orbital consists of alpha (beta) spin orbitals or spin-up (spin-down) spin-orbitals. If the orbital is occupied, the qubit is toggled to a <span class="math notranslate nohighlight">\(|1\rangle\)</span> (<span class="math notranslate nohighlight">\(|0\rangle\)</span>), the spin-orbital is occupied (unoccupied).</p>
<p>InQuanto provides the Chemically Aware UCC method which can be used to synthesise pytket circuits for electronic structure problems involving single excitations, double excitations, including double excitations of pairs of electrons from spatial orbital to spatial orbital. Additionally, InQuanto uses system specific data, such as point-group symmetry, to improve the number of single and double excitations to synthesise in the state-preparation method.</p>
<p>In the code cell below, the function generates the subcircuit for the  exponentiated operations. For the case of two spatial to spatial double excitations, 4 primitives are required with two symbols, <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>. These primitives are returned as <code class="docutils literal notranslate"><span class="pre">pytket.circuit.CircBox</span></code> objects which can be appended onto the <code class="docutils literal notranslate"><span class="pre">pytket.circuit.Circuit</span></code> state-preparation instance.</p>
<p>The primitive defined below is know as the Pauli-gadget primitive. For spatial to spatial double excitations, each Pauli-Gadget requires two <code class="docutils literal notranslate"><span class="pre">CX</span></code> gates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pytket.circuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Circuit</span><span class="p">,</span> <span class="n">CircBox</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.circuit.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">render_circuit_jupyter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">Symbol</span>


<span class="k">def</span><span class="w"> </span><span class="nf">YX_primitive</span><span class="p">(</span><span class="n">symbol</span><span class="p">:</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">reverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Circuit</span><span class="p">:</span>
    <span class="n">circuit</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">reverse</span><span class="p">:</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">H</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">V</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">H</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">circuit</span><span class="o">.</span><span class="n">CX</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">reverse</span><span class="p">:</span>
        <span class="n">symbol</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">circuit</span><span class="o">.</span><span class="n">Rz</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">circuit</span><span class="o">.</span><span class="n">CX</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">reverse</span><span class="p">:</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">H</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">Vdg</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">Vdg</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">H</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">CircBox</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">symbols</span> <span class="o">=</span> <span class="p">[</span><span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">),</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">)]</span>
<span class="n">n_qubits</span> <span class="o">=</span> <span class="mi">6</span>

<span class="n">yx_0</span> <span class="o">=</span> <span class="n">YX_primitive</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">xy_0</span> <span class="o">=</span> <span class="n">YX_primitive</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">yx_1</span> <span class="o">=</span> <span class="n">YX_primitive</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">xy_1</span> <span class="o">=</span> <span class="n">YX_primitive</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">render_circuit_jupyter</span><span class="p">(</span><span class="n">yx_0</span><span class="o">.</span><span class="n">get_circuit</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>To map the state, <span class="math notranslate nohighlight">\(|100000\rangle + \alpha |001000\rangle + \beta |000010\rangle\)</span>, to the final state, <span class="math notranslate nohighlight">\(|110000\rangle + \alpha |001100\rangle + \beta |000011\rangle\)</span>, three <code class="docutils literal notranslate"><span class="pre">CX</span></code> operations are required. Each of these <code class="docutils literal notranslate"><span class="pre">CX</span></code> gates uses the even qubit as a control and the odd qubit as a target. In prior cells, the concept of spatial orbitals and electrons were introduced. This will now be expanded upon. There are three tuples of qubits, each representing spatial orbitals:</p>
<ul class="simple">
<li><p>(<code class="docutils literal notranslate"><span class="pre">q[0]</span></code>, <code class="docutils literal notranslate"><span class="pre">q[1]</span></code>)</p></li>
<li><p>(<code class="docutils literal notranslate"><span class="pre">q[2]</span></code>, <code class="docutils literal notranslate"><span class="pre">q[3]</span></code>)</p></li>
<li><p>(<code class="docutils literal notranslate"><span class="pre">q[4]</span></code>, <code class="docutils literal notranslate"><span class="pre">q[5]</span></code>)</p></li>
</ul>
<p>The even-index (odd-index) qubit refers to the alpha (beta) spin-orbitals or spin-up (spin-down) orbitals. The purpose of the CX is to toggle the occupation of the beta spin-orbital, if the alpha-spin orbital is occupied.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circuit_cx</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">)</span>
<span class="n">circuit_cx</span><span class="o">.</span><span class="n">CX</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">CX</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">CX</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">render_circuit_jupyter</span><span class="p">(</span><span class="n">circuit_cx</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pytket.circuit.CircBox</span></code> instances will be appended to the circuit encoding the initial state. The extra CX operations will be added last. A <code class="docutils literal notranslate"><span class="pre">pytket</span></code> compilation pass, <code class="docutils literal notranslate"><span class="pre">pytket.passes.DecomposeBoxes</span></code> needs to be used to decompose the appended <code class="docutils literal notranslate"><span class="pre">pytket.circuit.CircBox</span></code> commands on the circuits into native <code class="docutils literal notranslate"><span class="pre">CX</span></code>, <code class="docutils literal notranslate"><span class="pre">Rz</span></code>, <code class="docutils literal notranslate"><span class="pre">H</span></code>, <code class="docutils literal notranslate"><span class="pre">V</span></code> and <code class="docutils literal notranslate"><span class="pre">Vdg</span></code> gates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pytket.passes</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecomposeBoxes</span>

<span class="n">decompose_boxes</span> <span class="o">=</span> <span class="n">DecomposeBoxes</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circ_fixed</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">)</span>
<span class="n">qubits</span> <span class="o">=</span> <span class="n">circ_fixed</span><span class="o">.</span><span class="n">qubits</span>

<span class="n">circ_fixed</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># intial state |100000&gt;</span>

<span class="n">circ_fixed</span><span class="o">.</span><span class="n">add_circbox</span><span class="p">(</span><span class="n">yx_0</span><span class="p">,</span> <span class="p">[</span><span class="n">qubits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qubits</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">circ_fixed</span><span class="o">.</span><span class="n">add_circbox</span><span class="p">(</span><span class="n">xy_0</span><span class="p">,</span> <span class="p">[</span><span class="n">qubits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qubits</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">circ_fixed</span><span class="o">.</span><span class="n">add_circbox</span><span class="p">(</span><span class="n">yx_1</span><span class="p">,</span> <span class="p">[</span><span class="n">qubits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qubits</span><span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
<span class="n">circ_fixed</span><span class="o">.</span><span class="n">add_circbox</span><span class="p">(</span><span class="n">xy_1</span><span class="p">,</span> <span class="p">[</span><span class="n">qubits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qubits</span><span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
<span class="n">circ_fixed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">circuit_cx</span><span class="p">)</span>
<span class="n">decompose_boxes</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">circ_fixed</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">render_circuit_jupyter</span><span class="p">(</span><span class="n">circ_fixed</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="chemically-aware-unitary-coupled-cluster-circuit-with-fixed-angle-2-qubit-gates-synthesised-with-pytket-pauliexpbox">
<h2>Chemically-Aware Unitary Coupled Cluster Circuit with Fixed-Angle 2-Qubit Gates synthesised with <code class="docutils literal notranslate"><span class="pre">pytket</span></code> <code class="docutils literal notranslate"><span class="pre">PauliExpBox</span></code><a class="headerlink" href="#chemically-aware-unitary-coupled-cluster-circuit-with-fixed-angle-2-qubit-gates-synthesised-with-pytket-pauliexpbox" title="Link to this heading">¶</a></h2>
<p>The Chemically-Aware UCC circuit from the previous section can also be synthesised with <code class="docutils literal notranslate"><span class="pre">PauliExpBox</span></code> and <code class="docutils literal notranslate"><span class="pre">CircBox</span></code>. The motivation is to perform <a class="reference external" href="https://arxiv.org/abs/1906.01734">Pauli-Gadget Synthesis</a> to synthesise the UCC state-preparation circuit. The benefit is that the circuit primitives from the previous section are now automatically created with <code class="docutils literal notranslate"><span class="pre">pytket</span></code> and there are additional savings in fixed-angle 2-qubit gates. The user is required to input the Qubit Pauli exponents as a sequence of Paulis (<code class="docutils literal notranslate"><span class="pre">List[pytket.pauli.Pauli]</span></code>) alongside a symbolic parameter.</p>
<p>Each spatial to spatial excitation consists of two exponeniated operations. In the code cell below, this would correspond to two <code class="docutils literal notranslate"><span class="pre">PauliExpBox</span></code> instances with the same symbolic parameter. Each pair of <code class="docutils literal notranslate"><span class="pre">PauliExpBox</span></code> instances belonging to the same excitation is appended to a <code class="docutils literal notranslate"><span class="pre">pytket.circuit.Circuit</span></code> instance and isolated with a <code class="docutils literal notranslate"><span class="pre">pytket.circuit.CircBox</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pytket.circuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">PauliExpBox</span><span class="p">,</span> <span class="n">Circuit</span><span class="p">,</span> <span class="n">CircBox</span><span class="p">,</span> <span class="n">fresh_symbol</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.pauli</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pauli</span>

<span class="n">circ_0_1</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">yx_0_1</span> <span class="o">=</span> <span class="n">PauliExpBox</span><span class="p">([</span><span class="n">Pauli</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">Pauli</span><span class="o">.</span><span class="n">X</span><span class="p">],</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">xy_0_1</span> <span class="o">=</span> <span class="n">PauliExpBox</span><span class="p">([</span><span class="n">Pauli</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">Pauli</span><span class="o">.</span><span class="n">Y</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">circ_0_1</span><span class="o">.</span><span class="n">add_pauliexpbox</span><span class="p">(</span><span class="n">yx_0_1</span><span class="p">,</span> <span class="n">circ_0_1</span><span class="o">.</span><span class="n">qubits</span><span class="p">)</span><span class="o">.</span><span class="n">add_pauliexpbox</span><span class="p">(</span>
    <span class="n">xy_0_1</span><span class="p">,</span> <span class="n">circ_0_1</span><span class="o">.</span><span class="n">qubits</span>
<span class="p">)</span>
<span class="n">circbox_0_1</span> <span class="o">=</span> <span class="n">CircBox</span><span class="p">(</span><span class="n">circ_0_1</span><span class="p">)</span>

<span class="n">circ_1_1</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">yx_1_1</span> <span class="o">=</span> <span class="n">PauliExpBox</span><span class="p">([</span><span class="n">Pauli</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">Pauli</span><span class="o">.</span><span class="n">X</span><span class="p">],</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">xy_1_1</span> <span class="o">=</span> <span class="n">PauliExpBox</span><span class="p">([</span><span class="n">Pauli</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">Pauli</span><span class="o">.</span><span class="n">Y</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">circ_1_1</span><span class="o">.</span><span class="n">add_pauliexpbox</span><span class="p">(</span><span class="n">yx_1_1</span><span class="p">,</span> <span class="n">circ_1_1</span><span class="o">.</span><span class="n">qubits</span><span class="p">)</span><span class="o">.</span><span class="n">add_pauliexpbox</span><span class="p">(</span>
    <span class="n">xy_1_1</span><span class="p">,</span> <span class="n">circ_1_1</span><span class="o">.</span><span class="n">qubits</span>
<span class="p">)</span>
<span class="n">circbox_1_1</span> <span class="o">=</span> <span class="n">CircBox</span><span class="p">(</span><span class="n">circ_1_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the code cell below, the two <code class="docutils literal notranslate"><span class="pre">pytket.circuit.CircBox</span></code>, each corresponding to two spatial to spatial orbital excitations, is added to a 6-qubit circuit, initialised with the reference state, <span class="math notranslate nohighlight">\(|100000\rangle\)</span>. Two compilation passes are now applied, <code class="docutils literal notranslate"><span class="pre">DecomposeBoxes</span></code> and <code class="docutils literal notranslate"><span class="pre">PauliSimp</span></code>. The former decomposes CircBox commands on the circuit into 1-qubit and fixed-angle 2-qubit gates. The latter compilation pass optimises the number of fixed-angle 2-qubit gates on the circuit.</p>
<p>This new circuit contains 2 fixed-angle 2-qubit gates per excitation, as opposed to 4 fixed-angle 2-qubit gates as in the previous section.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pytket.passes</span><span class="w"> </span><span class="kn">import</span> <span class="n">GuidedPauliSimp</span>

<span class="n">circ_paulisimp</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># create reference state |100000&gt;</span>
<span class="n">circ_paulisimp</span><span class="o">.</span><span class="n">add_circbox</span><span class="p">(</span>
    <span class="n">circbox_0_1</span><span class="p">,</span> <span class="p">[</span><span class="n">circ_paulisimp</span><span class="o">.</span><span class="n">qubits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">circ_paulisimp</span><span class="o">.</span><span class="n">qubits</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="p">)</span>
<span class="n">circ_paulisimp</span><span class="o">.</span><span class="n">add_circbox</span><span class="p">(</span>
    <span class="n">circbox_1_1</span><span class="p">,</span> <span class="p">[</span><span class="n">circ_paulisimp</span><span class="o">.</span><span class="n">qubits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">circ_paulisimp</span><span class="o">.</span><span class="n">qubits</span><span class="p">[</span><span class="mi">4</span><span class="p">]]</span>
<span class="p">)</span>
<span class="n">GuidedPauliSimp</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">circ_paulisimp</span><span class="p">)</span>
<span class="n">circ_paulisimp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">circuit_cx</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">render_circuit_jupyter</span><span class="p">(</span><span class="n">circ_paulisimp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="chemically-aware-ucc-circuit-with-arbitrary-angle-2-qubit-gates">
<h2>Chemically-Aware UCC Circuit with Arbitrary-Angle 2-Qubit Gates<a class="headerlink" href="#chemically-aware-ucc-circuit-with-arbitrary-angle-2-qubit-gates" title="Link to this heading">¶</a></h2>
<p>The circuits defined above used fixed-angle 2-qubit (<code class="docutils literal notranslate"><span class="pre">CX</span></code>) gates. Compiling to the Quantinuum gateset results in circuits with <code class="docutils literal notranslate"><span class="pre">pytket.ciruit.OpType.ZZMax</span></code> or fully-entangling 2-qubit gates.</p>
<p>In this section, the Chemically-Aware UCC circuit is defined at 6-qubits with an  arbitrary-angle 2-qubit gate (<code class="docutils literal notranslate"><span class="pre">pytket.circuit.OpType.ZZPhase</span></code>). This arbitrary-angle  2-qubit gate is a native Quantinuum gate, and for small angles offers better fidelity than  the native maximally entangling ZZ gate.</p>
<p>In the code cell below, a function is defined, requiring a symbol and a boolean as input. The  symbol is the gate angle for the arbitrary-angle 2-qubit gate. The boolean keyword argument  dictates whether to synthesise <span class="math notranslate nohighlight">\(e^{\theta Y_{q[0]} X_{q[1]}}\)</span> or <span class="math notranslate nohighlight">\(e^{\theta X_{q[0]} Y_{q[1]}}\)</span>. The output of this function is a <code class="docutils literal notranslate"><span class="pre">pytket.circuit.CircBox</span></code>. As with the previous section, 2 excitations are synthesised, each excitation requiring 2 <code class="docutils literal notranslate"><span class="pre">pytket.circuit.CircBox</span></code> instances.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pytket.circuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Circuit</span><span class="p">,</span> <span class="n">CircBox</span><span class="p">,</span> <span class="n">OpType</span>


<span class="k">def</span><span class="w"> </span><span class="nf">yx_arbzz_primitive</span><span class="p">(</span><span class="n">symbol</span><span class="p">:</span> <span class="n">Symbol</span><span class="p">,</span> <span class="n">reverse</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CircBox</span><span class="p">:</span>
    <span class="n">circ</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">reverse</span><span class="p">:</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span>
        <span class="n">symbol</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    <span class="n">circ</span><span class="o">.</span><span class="n">PhasedX</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>  <span class="c1"># V</span>
    <span class="n">circ</span><span class="o">.</span><span class="n">PhasedX</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">Rz</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>  <span class="c1"># Hadamard</span>
    <span class="n">circ</span><span class="o">.</span><span class="n">ZZPhase</span><span class="p">(</span><span class="n">symbol</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">circ</span><span class="o">.</span><span class="n">PhasedX</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>  <span class="c1"># Vdg</span>
    <span class="n">circ</span><span class="o">.</span><span class="n">PhasedX</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">Rz</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>  <span class="c1"># Hadamard</span>
    <span class="k">return</span> <span class="n">CircBox</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">yx_0_2</span> <span class="o">=</span> <span class="n">yx_arbzz_primitive</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">xy_0_2</span> <span class="o">=</span> <span class="n">yx_arbzz_primitive</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">yx_1_2</span> <span class="o">=</span> <span class="n">yx_arbzz_primitive</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">xy_1_2</span> <span class="o">=</span> <span class="n">yx_arbzz_primitive</span><span class="p">(</span><span class="n">symbols</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">render_circuit_jupyter</span><span class="p">(</span><span class="n">yx_0_2</span><span class="o">.</span><span class="n">get_circuit</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">render_circuit_jupyter</span><span class="p">(</span><span class="n">xy_0_2</span><span class="o">.</span><span class="n">get_circuit</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pytket.passes</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecomposeBoxes</span>

<span class="n">circ_arbzz</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">qubits</span> <span class="o">=</span> <span class="n">circ_arbzz</span><span class="o">.</span><span class="n">qubits</span>
<span class="n">circ_arbzz</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># |100000&gt;</span>

<span class="n">circ_arbzz</span><span class="o">.</span><span class="n">add_circbox</span><span class="p">(</span><span class="n">yx_0_2</span><span class="p">,</span> <span class="p">[</span><span class="n">qubits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qubits</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">circ_arbzz</span><span class="o">.</span><span class="n">add_circbox</span><span class="p">(</span><span class="n">xy_0_2</span><span class="p">,</span> <span class="p">[</span><span class="n">qubits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qubits</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">circ_arbzz</span><span class="o">.</span><span class="n">add_circbox</span><span class="p">(</span><span class="n">yx_1_2</span><span class="p">,</span> <span class="p">[</span><span class="n">qubits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qubits</span><span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
<span class="n">circ_arbzz</span><span class="o">.</span><span class="n">add_circbox</span><span class="p">(</span><span class="n">xy_1_2</span><span class="p">,</span> <span class="p">[</span><span class="n">qubits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">qubits</span><span class="p">[</span><span class="mi">4</span><span class="p">]])</span>
<span class="n">circ_arbzz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">circuit_cx</span><span class="p">)</span>

<span class="n">DecomposeBoxes</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">circ_arbzz</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">render_circuit_jupyter</span><span class="p">(</span><span class="n">circ_arbzz</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="classical-noiseless-variational-procedure-with-numpy-and-scipy">
<h2>Classical Noiseless Variational Procedure with NumPy and SciPy<a class="headerlink" href="#classical-noiseless-variational-procedure-with-numpy-and-scipy" title="Link to this heading">¶</a></h2>
<p>Now we perform the variational procedure with numpy and scipy. The pytket objects are converted into numpy arrays. The Hamiltonian can be transformed from a <code class="docutils literal notranslate"><span class="pre">pytket.utils.operators.QubitPauliOperator</span></code> instance into a sparse square matrix. The <code class="docutils literal notranslate"><span class="pre">pytket.circuit.Circuit</span></code> instance can be represented as a complex column vector with <span class="math notranslate nohighlight">\(2^N\)</span> elements (<span class="math notranslate nohighlight">\(N\)</span> is the number of qubits - for this problem the vector will contain 64 elements). The objective function performs these transformations and evaluates the energy using the numpy dot product function.</p>
<p><code class="docutils literal notranslate"><span class="pre">scipy.optimize</span></code> is used to optimise the input parameters for the objective function, to obtain the lowest estimate of the ground-state energy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">Symbol</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.utils.operators</span><span class="w"> </span><span class="kn">import</span> <span class="n">QubitPauliOperator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.circuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Circuit</span>


<span class="k">class</span><span class="w"> </span><span class="nc">VariationalProcedure</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">operator</span><span class="p">:</span> <span class="n">QubitPauliOperator</span><span class="p">,</span>
        <span class="n">state_circuit</span><span class="p">:</span> <span class="n">Circuit</span><span class="p">,</span>
        <span class="n">symbols</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Symbol</span><span class="p">],</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_operator</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">to_sparse_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_circuit</span> <span class="o">=</span> <span class="n">state_circuit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_symbols</span> <span class="o">=</span> <span class="n">symbols</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">symbol_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="n">p</span> <span class="k">for</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_symbols</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)}</span>
        <span class="n">circuit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_circuit</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">symbol_substitution</span><span class="p">(</span><span class="n">symbol_dict</span><span class="p">)</span>
        <span class="n">statevector</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">get_statevector</span><span class="p">()</span>
        <span class="n">energy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vdot</span><span class="p">(</span><span class="n">statevector</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_operator</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">statevector</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">energy</span><span class="o">.</span><span class="n">real</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variational_procedure_fixed</span> <span class="o">=</span> <span class="n">VariationalProcedure</span><span class="p">(</span><span class="n">hamiltonian</span><span class="p">,</span> <span class="n">circ_fixed</span><span class="p">,</span> <span class="n">symbols</span><span class="p">)</span>
<span class="n">variational_procedure_paulisimp</span> <span class="o">=</span> <span class="n">VariationalProcedure</span><span class="p">(</span>
    <span class="n">hamiltonian</span><span class="p">,</span> <span class="n">circ_paulisimp</span><span class="p">,</span> <span class="n">symbols</span>
<span class="p">)</span>
<span class="n">variational_procedure_arbzz</span> <span class="o">=</span> <span class="n">VariationalProcedure</span><span class="p">(</span><span class="n">hamiltonian</span><span class="p">,</span> <span class="n">circ_arbzz</span><span class="p">,</span> <span class="n">symbols</span><span class="p">)</span>
<span class="n">initial_parameters</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">symbols</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimize</span>

<span class="n">result_fixed</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span>
    <span class="n">variational_procedure_fixed</span><span class="p">,</span> <span class="n">initial_parameters</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;L-BFGS-B&quot;</span>
<span class="p">)</span>
<span class="n">result_paulisimp</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span>
    <span class="n">variational_procedure_paulisimp</span><span class="p">,</span> <span class="n">initial_parameters</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;L-BFGS-B&quot;</span>
<span class="p">)</span>
<span class="n">result_arbzz</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span>
    <span class="n">variational_procedure_arbzz</span><span class="p">,</span> <span class="n">initial_parameters</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;L-BFGS-B&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">output</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">result</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
    <span class="p">[</span><span class="n">p</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">fun</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">symbols</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;Energy (Ha)&quot;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">d0</span> <span class="o">=</span> <span class="n">output</span><span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <span class="n">result_fixed</span><span class="p">)</span>
<span class="n">d1</span> <span class="o">=</span> <span class="n">output</span><span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <span class="n">result_paulisimp</span><span class="p">)</span>
<span class="n">d2</span> <span class="o">=</span> <span class="n">output</span><span class="p">(</span><span class="n">symbols</span><span class="p">,</span> <span class="n">result_arbzz</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">d0</span><span class="p">,</span> <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Fixed-Angle&quot;</span><span class="p">,</span> <span class="s2">&quot;Fixed-Angle/ Paulisimp&quot;</span><span class="p">,</span> <span class="s2">&quot;Arbitrary-Angle&quot;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="hamiltonian-averaging">
<h2>Hamiltonian Averaging<a class="headerlink" href="#hamiltonian-averaging" title="Link to this heading">¶</a></h2>
<p>The following code cells estimate the Hamiltonian Expectation Value using <code class="docutils literal notranslate"><span class="pre">pytket.utils.expectations.get_operator_expectation_value</span></code>. This function performs measurement reduction under the hood to reduce the number of measurement circuits required to estimate the ground-state energy. Circuit submission and result retrieval are also performed internally within this <code class="docutils literal notranslate"><span class="pre">pytket</span></code> convenience function.</p>
<p>This procedure requires the Chemically-Aware UCC state-preparation circuit, the 6-qubit electronic structure Hamiltonian for <span class="math notranslate nohighlight">\(\textrm{CH}_4\)</span> and the parameter set characterising the ground-state of <span class="math notranslate nohighlight">\(\textrm{CH}_4\)</span>.</p>
<p>The Quantinuum emulator (<code class="docutils literal notranslate"><span class="pre">H1-1E</span></code>) is used for this problem.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pytket.extensions.quantinuum</span><span class="w"> </span><span class="kn">import</span> <span class="n">QuantinuumBackend</span>

<span class="n">backend</span> <span class="o">=</span> <span class="n">QuantinuumBackend</span><span class="p">(</span><span class="n">device_name</span><span class="o">=</span><span class="s2">&quot;H1-1E&quot;</span><span class="p">)</span>
<span class="n">backend</span><span class="o">.</span><span class="n">login</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The code-cell below, the <code class="docutils literal notranslate"><span class="pre">hamiltonian_averaging_submission</span></code> requires the following inputs:</p>
<ul class="simple">
<li><p>Chemically Aware UCC state-preparation circuit</p></li>
<li><p>a <code class="docutils literal notranslate"><span class="pre">QubitPauliOperator</span></code> instance of the Hamiltonian</p></li>
<li><p>a dictionary mapping symbols on the circuit to numerical parameters</p></li>
<li><p>a <code class="docutils literal notranslate"><span class="pre">QuantinuumBackend</span></code> instance</p></li>
<li><p>an integer specifying the number of shots to execute per circuit</p></li>
<li><p>an integer specifying the maximum HQCs to consume before a batch session is terminated</p></li>
<li><p>a boolean specifying whether the circuit should be rebased from <code class="docutils literal notranslate"><span class="pre">ZZPhase</span></code> (after compilation by QuantinuumBackend) to <code class="docutils literal notranslate"><span class="pre">ZZMax</span></code></p></li>
</ul>
<p>This function prepares the measurement circuits needed to perform Hamiltonian Averaging. First the Hamiltonian is decomposed into commuting sets of Pauli-strings. Second, the commuting sets are synthesised into measurement operations, which are appended onto a copy of the Chemically-Aware UCC circuit (with numerical parameters). The circuits are submitted under the same batch session.</p>
<p>A second function, <code class="docutils literal notranslate"><span class="pre">hamiltonian_averaging_evaluate</span></code>, retrieves the result and performs the appropriate post-processing to evaluate the expectation value of the Hamiltonian. If the parameters corresponding to the approximate ground-state are inputted into <code class="docutils literal notranslate"><span class="pre">hamiltonian_averaging_submission</span></code>, then the approximate ground-state energy is evaluated.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.circuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Circuit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.partition</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">measurement_reduction</span><span class="p">,</span>
    <span class="n">MeasurementSetup</span><span class="p">,</span>
    <span class="n">PauliPartitionStrat</span><span class="p">,</span>
    <span class="n">MeasurementBitMap</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.passes</span><span class="w"> </span><span class="kn">import</span> <span class="n">auto_squash_pass</span><span class="p">,</span> <span class="n">auto_rebase_pass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.backends.resulthandle</span><span class="w"> </span><span class="kn">import</span> <span class="n">ResultHandle</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.utils.operators</span><span class="w"> </span><span class="kn">import</span> <span class="n">QubitPauliOperator</span>


<span class="k">def</span><span class="w"> </span><span class="nf">hamiltonian_averaging_submission</span><span class="p">(</span>
    <span class="n">state_circuit</span><span class="p">:</span> <span class="n">Circuit</span><span class="p">,</span>
    <span class="n">hamiltonian</span><span class="p">:</span> <span class="n">QubitPauliOperator</span><span class="p">,</span>
    <span class="n">parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Symbol</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">backend</span><span class="p">:</span> <span class="n">QuantinuumBackend</span><span class="p">,</span>
    <span class="n">n_shots</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">max_batch_cost</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="n">rebase_to_zzmax</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">ResultHandle</span><span class="p">],</span> <span class="n">MeasurementSetup</span><span class="p">]:</span>
    <span class="n">circuit</span> <span class="o">=</span> <span class="n">state_circuit</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">circuit</span><span class="o">.</span><span class="n">symbol_substitution</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
    <span class="n">term_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">term</span> <span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">hamiltonian</span><span class="o">.</span><span class="n">_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
    <span class="n">measurement_setup</span> <span class="o">=</span> <span class="n">measurement_reduction</span><span class="p">(</span>
        <span class="n">term_list</span><span class="p">,</span> <span class="n">strat</span><span class="o">=</span><span class="n">PauliPartitionStrat</span><span class="o">.</span><span class="n">CommutingSets</span>
    <span class="p">)</span>
    <span class="n">handles_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mc</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">measurement_setup</span><span class="o">.</span><span class="n">measurement_circs</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mc</span><span class="p">)</span>
        <span class="n">cc</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">get_compiled_circuit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">optimisation_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rebase_to_zzmax</span><span class="p">:</span>
            <span class="n">rebase_custom</span> <span class="o">=</span> <span class="n">auto_rebase_pass</span><span class="p">({</span><span class="n">OpType</span><span class="o">.</span><span class="n">ZZMax</span><span class="p">,</span> <span class="n">OpType</span><span class="o">.</span><span class="n">PhasedX</span><span class="p">,</span> <span class="n">OpType</span><span class="o">.</span><span class="n">Rz</span><span class="p">})</span>
            <span class="n">squash_custom</span> <span class="o">=</span> <span class="n">auto_squash_pass</span><span class="p">({</span><span class="n">OpType</span><span class="o">.</span><span class="n">PhasedX</span><span class="p">,</span> <span class="n">OpType</span><span class="o">.</span><span class="n">Rz</span><span class="p">})</span>
            <span class="n">rebase_custom</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
            <span class="n">squash_custom</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">cc</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">backend</span><span class="p">,</span> <span class="n">QuantinuumBackend</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">result_handle_start</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">start_batch</span><span class="p">(</span>
                    <span class="n">max_batch_cost</span><span class="p">,</span>
                    <span class="n">cc</span><span class="p">,</span>
                    <span class="n">n_shots</span><span class="o">=</span><span class="n">n_shots</span><span class="p">,</span>
                    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;tket-opt-level&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
                <span class="p">)</span>
                <span class="n">handles_list</span> <span class="o">+=</span> <span class="p">[</span><span class="n">result_handle_start</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">result_handle</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">add_to_batch</span><span class="p">(</span>
                    <span class="n">result_handle_start</span><span class="p">,</span>
                    <span class="n">cc</span><span class="p">,</span>
                    <span class="n">n_shots</span><span class="o">=</span><span class="n">n_shots</span><span class="p">,</span>
                    <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;tket-opt-level&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span>
                <span class="p">)</span>
                <span class="n">handles_list</span> <span class="o">+=</span> <span class="p">[</span><span class="n">result_handle</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result_handle</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">process_circuit</span><span class="p">(</span>
                <span class="n">cc</span><span class="p">,</span> <span class="n">n_shots</span><span class="o">=</span><span class="n">n_shots</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;tket-opt-level&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
            <span class="p">)</span>
            <span class="n">handles_list</span> <span class="o">+=</span> <span class="p">[</span><span class="n">result_handle</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">handles_list</span><span class="p">,</span> <span class="n">measurement_setup</span>


<span class="k">def</span><span class="w"> </span><span class="nf">hamiltonian_averaging_evaluate</span><span class="p">(</span>
    <span class="n">handles_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ResultHandle</span><span class="p">],</span>
    <span class="n">measurement_setup</span><span class="p">:</span> <span class="n">MeasurementSetup</span><span class="p">,</span>
    <span class="n">hamiltonian</span><span class="p">:</span> <span class="n">QubitPauliOperator</span><span class="p">,</span>
    <span class="n">backend</span><span class="p">:</span> <span class="n">QuantinuumBackend</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="n">results_list</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">get_results</span><span class="p">(</span><span class="n">handles_list</span><span class="p">)</span>
    <span class="n">energy</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">qps</span><span class="p">,</span> <span class="n">bitmap_list</span> <span class="ow">in</span> <span class="n">measurement_setup</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">coeff</span> <span class="o">=</span> <span class="n">hamiltonian</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">qps</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">bitmap</span> <span class="ow">in</span> <span class="n">bitmap_list</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">results_list</span><span class="p">[</span><span class="n">bitmap</span><span class="o">.</span><span class="n">circ_index</span><span class="p">]</span>
                <span class="n">distribution</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">()</span>
                <span class="n">value</span> <span class="o">+=</span> <span class="n">compute_expectation_paulistring</span><span class="p">(</span><span class="n">distribution</span><span class="p">,</span> <span class="n">bitmap</span><span class="p">)</span>
            <span class="n">energy</span> <span class="o">+=</span> <span class="n">value</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">bitmap_list</span><span class="p">)</span> <span class="o">*</span> <span class="n">coeff</span>
    <span class="k">return</span> <span class="n">energy</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_expectation_paulistring</span><span class="p">(</span>
    <span class="n">distribution</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="nb">float</span><span class="p">],</span> <span class="n">bitmap</span><span class="p">:</span> <span class="n">MeasurementBitMap</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">bitstring</span><span class="p">,</span> <span class="n">probability</span> <span class="ow">in</span> <span class="n">distribution</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">value</span> <span class="o">+=</span> <span class="n">probability</span> <span class="o">*</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">bitstring</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">bitmap</span><span class="o">.</span><span class="n">bits</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="n">bitmap</span><span class="o">.</span><span class="n">invert</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">value</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>For this experiment, 5000 shots are submitted per circuit. A dictionary containing the necessary symbols and relevant parameters is also prepared.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="s2">&quot;Fixed-Angle&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">}</span>
<span class="n">n_shots</span> <span class="o">=</span> <span class="mi">5000</span>
</pre></div>
</div>
</div>
</div>
<p>Three different Hamiltonian Averaging experiments with the Chemically-Aware UCC method are performed on the Quantinuum Emulator:</p>
<ol class="arabic simple">
<li><p>With Fixed-angle (<code class="docutils literal notranslate"><span class="pre">ZZMax</span></code>) gates.</p></li>
<li><p>With Fixed-angle (<code class="docutils literal notranslate"><span class="pre">ZZMax</span></code>) gates on a circuit generated using Pauli-Gadget synthesis.</p></li>
<li><p>With Arbitrary-Angle (<code class="docutils literal notranslate"><span class="pre">ZZPhase</span></code>) gates.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">handles_fixed</span><span class="p">,</span> <span class="n">ms</span> <span class="o">=</span> <span class="n">hamiltonian_averaging_submission</span><span class="p">(</span>
    <span class="n">circ_fixed</span><span class="p">,</span> <span class="n">hamiltonian</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">n_shots</span><span class="p">,</span> <span class="n">rebase_to_zzmax</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">energy_fixed</span> <span class="o">=</span> <span class="n">hamiltonian_averaging_evaluate</span><span class="p">(</span><span class="n">handles_fixed</span><span class="p">,</span> <span class="n">ms</span><span class="p">,</span> <span class="n">hamiltonian</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">handles_paulisimp</span><span class="p">,</span> <span class="n">ms</span> <span class="o">=</span> <span class="n">hamiltonian_averaging_submission</span><span class="p">(</span>
    <span class="n">circ_paulisimp</span><span class="p">,</span> <span class="n">hamiltonian</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">n_shots</span><span class="p">,</span> <span class="n">rebase_to_zzmax</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">energy_paulisimp</span> <span class="o">=</span> <span class="n">hamiltonian_averaging_evaluate</span><span class="p">(</span>
    <span class="n">handles_paulisimp</span><span class="p">,</span> <span class="n">ms</span><span class="p">,</span> <span class="n">hamiltonian</span><span class="p">,</span> <span class="n">backend</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">handles_arbzz</span><span class="p">,</span> <span class="n">ms</span> <span class="o">=</span> <span class="n">hamiltonian_averaging_submission</span><span class="p">(</span>
    <span class="n">circ_arbzz</span><span class="p">,</span> <span class="n">hamiltonian</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">backend</span><span class="p">,</span> <span class="n">n_shots</span><span class="p">,</span> <span class="n">rebase_to_zzmax</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="n">energy_arbzz</span> <span class="o">=</span> <span class="n">hamiltonian_averaging_evaluate</span><span class="p">(</span><span class="n">handles_arbzz</span><span class="p">,</span> <span class="n">ms</span><span class="p">,</span> <span class="n">hamiltonian</span><span class="p">,</span> <span class="n">backend</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In addition, to benchmark the performance hamiltonian averaging procedure on the emulator with fixed-angle and arbitrary-angle gates, a noiseless calculation is executed. This uses a new instance of <code class="docutils literal notranslate"><span class="pre">QuantinuumBackend</span></code>, but configured with no noise model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">quantinuum_backend_noiseless</span> <span class="o">=</span> <span class="n">QuantinuumBackend</span><span class="p">(</span>
    <span class="n">device_name</span><span class="o">=</span><span class="s2">&quot;H1-1E&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;error-model&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">handles_noiseless</span><span class="p">,</span> <span class="n">ms</span> <span class="o">=</span> <span class="n">hamiltonian_averaging_submission</span><span class="p">(</span>
    <span class="n">circ_arbzz</span><span class="p">,</span>
    <span class="n">hamiltonian</span><span class="p">,</span>
    <span class="n">parameters</span><span class="p">,</span>
    <span class="n">quantinuum_backend_noiseless</span><span class="p">,</span>
    <span class="n">n_shots</span><span class="p">,</span>
    <span class="n">rebase_to_zzmax</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">energy_noiseless</span> <span class="o">=</span> <span class="n">hamiltonian_averaging_evaluate</span><span class="p">(</span>
    <span class="n">handles_noiseless</span><span class="p">,</span> <span class="n">ms</span><span class="p">,</span> <span class="n">hamiltonian</span><span class="p">,</span> <span class="n">quantinuum_backend_noiseless</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The results from the 4 experiments are collated below. With Arbitrary-angle 2-qubit gates, a 4x (3x) improvement in relative error is demonstrated, compared to a fixed-angle circuit with 11 (7) 2-qubit gates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n2qb_fixed</span> <span class="o">=</span> <span class="n">circ_fixed</span><span class="o">.</span><span class="n">n_2qb_gates</span><span class="p">()</span>
<span class="n">n2qb_paulisimp</span> <span class="o">=</span> <span class="n">circ_paulisimp</span><span class="o">.</span><span class="n">n_2qb_gates</span><span class="p">()</span>
<span class="n">n2qb_arbzz</span> <span class="o">=</span> <span class="n">circ_arbzz</span><span class="o">.</span><span class="n">n_2qb_gates</span><span class="p">()</span>

<span class="n">n2qb</span> <span class="o">=</span> <span class="p">[</span><span class="n">n2qb_fixed</span><span class="p">,</span> <span class="n">n2qb_paulisimp</span><span class="p">,</span> <span class="n">n2qb_arbzz</span><span class="p">]</span>
<span class="n">energy</span> <span class="o">=</span> <span class="p">[</span><span class="n">energy_fixed</span><span class="p">,</span> <span class="n">energy_paulisimp</span><span class="p">,</span> <span class="n">energy_arbzz</span><span class="p">]</span>
<span class="n">abs_error</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">e</span> <span class="o">-</span> <span class="n">energy_noiseless</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">energy</span><span class="p">]</span>
<span class="n">rel_error</span> <span class="o">=</span> <span class="p">[</span><span class="n">err</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">for</span> <span class="n">err</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">abs_error</span><span class="p">,</span> <span class="n">energy</span><span class="p">)]</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">n2qb</span><span class="p">,</span> <span class="n">energy</span><span class="p">,</span> <span class="n">abs_error</span><span class="p">,</span> <span class="n">rel_error</span><span class="p">]</span>

<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Fixed-Angle&quot;</span><span class="p">,</span> <span class="s2">&quot;Paulisimp&quot;</span><span class="p">,</span> <span class="s2">&quot;Arb-Angle&quot;</span><span class="p">]</span>
<span class="n">index</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;Number of 2qb Gates&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Electronic Energy (Ha)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Absolute Error (Ha)&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Relative Error (%)&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">df_result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="n">df_result</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="jensen-shannon-divergence">
<h2>Jensen-Shannon Divergence<a class="headerlink" href="#jensen-shannon-divergence" title="Link to this heading">¶</a></h2>
<p>The Jensen-Shannon divergence is a metric to estimate the similarity between two probability distributions. Output from the three experiments on the Quantinuum emulator are compared to the output from the noiseless emulator calculation. During the Hamiltonian Averaging procedure, distributions of measurement outcomes are calculated. These distributions are processed to estimate the expectation value of the Hamiltonian. In the code-cell below, these distributions are retrieved using <code class="docutils literal notranslate"><span class="pre">QuantinuumBackend</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_fixed</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">get_results</span><span class="p">(</span><span class="n">handles_fixed</span><span class="p">)</span>
<span class="n">results_paulisimp</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">get_results</span><span class="p">(</span><span class="n">handles_paulisimp</span><span class="p">)</span>
<span class="n">results_arbzz</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">get_results</span><span class="p">(</span><span class="n">handles_arbzz</span><span class="p">)</span>
<span class="n">results_aer</span> <span class="o">=</span> <span class="n">quantinuum_backend_noiseless</span><span class="o">.</span><span class="n">get_results</span><span class="p">(</span><span class="n">handles_noiseless</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Each distribution of measurement outcomes is a dictionary mapping a bitstring (tuple of integers) to a probability. For each of the four experiments, the measurement distributions are ordered by a bitstring. The <code class="docutils literal notranslate"><span class="pre">sort_distributions</span></code> function takes a list of distributions and returns a list of ordered sequences of probabilities.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span>


<span class="k">def</span><span class="w"> </span><span class="nf">sort_distributions</span><span class="p">(</span>
    <span class="n">result_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ResultHandle</span><span class="p">],</span> <span class="n">n_qubits</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">6</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
    <span class="n">probabilities_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">result_list</span><span class="p">:</span>
        <span class="n">probabilities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">result</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bitstring</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">bitstring</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">repeat</span><span class="o">=</span><span class="n">n_qubits</span><span class="p">)</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">probabilities_list</span> <span class="o">+=</span> <span class="p">[</span><span class="n">probabilities</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">probabilities</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">probabilities_list</span><span class="p">)</span>


<span class="n">dist_fixed</span> <span class="o">=</span> <span class="n">sort_distributions</span><span class="p">(</span><span class="n">results_fixed</span><span class="p">)</span>
<span class="n">dist_paulisimp</span> <span class="o">=</span> <span class="n">sort_distributions</span><span class="p">(</span><span class="n">results_paulisimp</span><span class="p">)</span>
<span class="n">dist_arbzz</span> <span class="o">=</span> <span class="n">sort_distributions</span><span class="p">(</span><span class="n">results_arbzz</span><span class="p">)</span>
<span class="n">dist_aer</span> <span class="o">=</span> <span class="n">sort_distributions</span><span class="p">(</span><span class="n">results_aer</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The code cell below uses tools from numpy and scipy to calculate the JSD (Jensen-Shannon Divergence).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">entropy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="kn">import</span> <span class="n">Series</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compute_jsd</span><span class="p">(</span>
    <span class="n">distribution_list0</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">distribution_list1</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Series</span><span class="p">:</span>
    <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;Distribution </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">distribution_list0</span><span class="p">))]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">d0</span><span class="p">,</span> <span class="n">d1</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">distribution_list0</span><span class="p">,</span> <span class="n">distribution_list1</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">d0</span> <span class="o">+</span> <span class="n">d1</span><span class="p">)</span>
        <span class="n">jsd</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">entropy</span><span class="p">(</span><span class="n">d0</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">entropy</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
        <span class="n">data</span> <span class="o">+=</span> <span class="p">[</span><span class="n">jsd</span><span class="p">]</span>
    <span class="n">series</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">series</span>
</pre></div>
</div>
</div>
</div>
<p>The results below shows the JSD for each measured distribution from the <span class="math notranslate nohighlight">\(\textrm{CH}_4\)</span> problem. The lower the value of JSD, the more similar the measured distribution is to the test distribution (noiseless emulator calculation). It is clear from the results that the Arbitrary-angle measured distribution is the most similar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">series_fixed</span> <span class="o">=</span> <span class="n">compute_jsd</span><span class="p">(</span><span class="n">dist_fixed</span><span class="p">,</span> <span class="n">dist_aer</span><span class="p">)</span>
<span class="n">series_paulisimp</span> <span class="o">=</span> <span class="n">compute_jsd</span><span class="p">(</span><span class="n">dist_paulisimp</span><span class="p">,</span> <span class="n">dist_aer</span><span class="p">)</span>
<span class="n">series_arbzz</span> <span class="o">=</span> <span class="n">compute_jsd</span><span class="p">(</span><span class="n">dist_arbzz</span><span class="p">,</span> <span class="n">dist_aer</span><span class="p">)</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Fixed-Angle&quot;</span><span class="p">,</span> <span class="s2">&quot;Paulisimp&quot;</span><span class="p">,</span> <span class="s2">&quot;Arb-Angle&quot;</span><span class="p">]</span>
<span class="n">df_jsd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">series_fixed</span><span class="p">,</span> <span class="n">series_paulisimp</span><span class="p">,</span> <span class="n">series_arbzz</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df_jsd</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span>
<span class="n">df_jsd</span>
</pre></div>
</div>
</div>
</div>
<p>This distribution is now plotted as a Heatmap. In this grid, each row is a distribution, and each column is the result from the circuit with Fixed-Angle or Arbitrary-Angle gates. The colormap ranges from black to white. Black defines the highest JSD value (0.013). The closer a grid element is to white, the better (lower) the JSD value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df_jsd</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;binary&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="Quantinuum_high_energy_physics_experiment.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">High Energy Physics: Implementing <span class="math notranslate nohighlight">\(SU(2)\)</span> Lattice Gauge Theory Trotter Circuits</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="ka_index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Knowledge Articles</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
              Copyright &#169; 2024 Quantinuum Ltd. All rights reserved.
            </div>
            <div class="terms" style="display:flex; gap:0.5rem; align-items:center; margin: 0.25rem 0rem;">
              <a href="https://www.quantinuum.com/privacy-statement" target="_blank">Privacy Statement</a>
              <div role="separator">/</div>
              <a href="https://www.quantinuum.com/cookie-notice" target="_blank">Cookie Notice</a>
              <div role="separator">/</div>
              <a href="https://www.quantinuum.com/terms-conditions" target="_blank">Terms and Conditions</a>
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Quantum Chemistry Calculations with Arbitrary Angle 2-Qubit Gates</a><ul>
<li><a class="reference internal" href="#links">Links</a></li>
<li><a class="reference internal" href="#hamiltonian-specification">Hamiltonian Specification</a></li>
<li><a class="reference internal" href="#chemically-aware-ucc-circuit-with-fixed-angle-2-qubit-gates">Chemically-Aware UCC Circuit with Fixed-Angle 2-Qubit Gates</a></li>
<li><a class="reference internal" href="#chemically-aware-unitary-coupled-cluster-circuit-with-fixed-angle-2-qubit-gates-synthesised-with-pytket-pauliexpbox">Chemically-Aware Unitary Coupled Cluster Circuit with Fixed-Angle 2-Qubit Gates synthesised with <code class="docutils literal notranslate"><span class="pre">pytket</span></code> <code class="docutils literal notranslate"><span class="pre">PauliExpBox</span></code></a></li>
<li><a class="reference internal" href="#chemically-aware-ucc-circuit-with-arbitrary-angle-2-qubit-gates">Chemically-Aware UCC Circuit with Arbitrary-Angle 2-Qubit Gates</a></li>
<li><a class="reference internal" href="#classical-noiseless-variational-procedure-with-numpy-and-scipy">Classical Noiseless Variational Procedure with NumPy and SciPy</a></li>
<li><a class="reference internal" href="#hamiltonian-averaging">Hamiltonian Averaging</a></li>
<li><a class="reference internal" href="#jensen-shannon-divergence">Jensen-Shannon Divergence</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=7f41d439"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>