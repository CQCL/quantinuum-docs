<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YPQ1FTGDL3"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-YPQ1FTGDL3');
    </script>
    <link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Conditional Operations &amp; Classical Logic" href="conditional_operations_and_classical_logic.html" /><link rel="prev" title="Mid-Circuit Measurement &amp; Reset" href="mcmr.html" />

    <link rel="shortcut icon" href="../../_static/quantinuum_favicon.svg"/><!-- Generated with Sphinx 8.2.1 and Furo 2024.08.06 -->
        <title>Native Arbitrary Angle Hardware Gates - Quantinuum Systems</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=d7660fb1" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style>
<link rel="stylesheet" href="../../_static/tokens.css"/>
<link rel="stylesheet" href="../../_static/styles.css"/>
<link rel="stylesheet" href="../../_static/tailwind.css"/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="preload"
as="style">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">

<style>  
  .sidebar-sticky {
    top: calc(3.5rem - 0px);
    height: calc(100vh - 3.5rem);
  }
  
  @media (min-width: 97em) {
    html {
      font-size: 100% !important;
    }
  }
  
</style>
</head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>
<!-- <script type="text/javascript" src="../../_static/syncTheme.global.js" ></script> -->
 <!--Force light mode -->
 <script>document.body.setAttribute('data-theme','light')</script>
<nav style="position:fixed;top:0;z-index:1021;width:100%;">
    <div class="nexus-nav"></div>
</nav>
<script type="text/javascript" src="../../_static/injectNav.global.js"></script>
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Quantinuum Systems</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/systems.svg" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User Guides</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../user_guide/hardware_user_guide/access.html">Hardware User Guide</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Hardware User Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/hardware_user_guide/access.html">Quantinuum Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/hardware_user_guide/system_operation.html">System Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/hardware_user_guide/workflow.html">System Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/hardware_user_guide/fair_queue.html">Fair Queue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/hardware_user_guide/error_measurements.html">Error Measurements</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../user_guide/emulator_user_guide/introduction.html">Emulator User Guide</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Emulator User Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/emulator_user_guide/introduction.html">Quantinuum Emulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/emulator_user_guide/noise_model.html">Noise Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/emulator_user_guide/emulators/h1_emulators.html">H1 Emulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user_guide/emulator_user_guide/emulators/h2_emulators.html">H2 Emulators</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://docs.quantinuum.com/nexus/user_guide/user_guide.html">Nexus User Guide</a></li>
<li class="toctree-l1"><a class="reference external" href="https://docs.quantinuum.com/nexus/admin_guide/admin_guide.html">Nexus Admin Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Trainings</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="getting_started_index.html">Getting Started</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Getting Started</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="getting_started_index.html">Unique Capabilities</a></li>
<li class="toctree-l2"><a class="reference external" href="https://docs.quantinuum.com/nexus/trainings/getting_started.html">Quantinuum Nexus</a></li>
<li class="toctree-l2"><a class="reference external" href="https://docs.quantinuum.com/tket/user-guide/index.html">TKET</a></li>
<li class="toctree-l2"><a class="reference internal" href="emulators.html">Quantinuum Emulators</a></li>
<li class="toctree-l2"><a class="reference internal" href="mcmr.html">Mid-Circuit Measurement &amp; Reset</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Native Arbitrary Angle Hardware Gates</a></li>
<li class="toctree-l2"><a class="reference internal" href="conditional_operations_and_classical_logic.html">Conditional Operations &amp; Classical Logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="batch_jobs.html">Batch Jobs</a></li>
<li class="toctree-l2"><a class="reference internal" href="api_options.html">Quantinuum Systems API Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="access_systems_with_qiskit.html">Using Qiskit with Quantinuum Devices</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="qec_decoder_toolkit/qec_decoder_toolkit.html">QEC Decoder Toolkit</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of QEC Decoder Toolkit</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="qec_decoder_toolkit/qec_decoder_toolkit.html">QEC Decoder Toolkit</a></li>
<li class="toctree-l3"><a class="reference internal" href="qec_decoder_toolkit/repeat_until_success/rus_index.html">Repeat Until Success</a></li>
<li class="toctree-l3"><a class="reference internal" href="qec_decoder_toolkit/repetition_code/repetition_code_index.html">Repetition Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="qec_decoder_toolkit/surface_code/surface_code_index.html">Surface Code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pytket_quantinuum/pytket_quantinuum.html"><code class="docutils literal notranslate"><span class="pre">pytket-quantinuum</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../knowledge_articles/ka_index.html">Knowledge Articles</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Knowledge Articles</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../knowledge_articles/Quantinuum_chemistry_chemically_aware_ucc.html">Quantum Chemistry Calculations with Arbitrary Angle 2-Qubit Gates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../knowledge_articles/Quantinuum_high_energy_physics_experiment.html">High Energy Physics: Implementing <span class="math notranslate nohighlight">\(SU(2)\)</span> Lattice Gauge Theory Trotter Circuits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../knowledge_articles/Quantinuum_leakage_detection.html">Automatic Leakage Error Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../knowledge_articles/Quantinuum_toric_code.html">Topological Order from Measurements and Feed-Forward</a></li>
<li class="toctree-l2"><a class="reference internal" href="../knowledge_articles/Quantinuum_variational_experiment_with_batching.html">Variational Experiment with Batching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../knowledge_articles/Quantinuum_n56_ghz_state_fidelity.html">GHZ State Fidelity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../knowledge_articles/circuit_stitching.html">Circuit Stitching</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../support/product_change_notifications.html">Product Change Notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support/faqs.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../support/quantinuum_systems_citations.html">How to Cite Quantinuum Systems</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="native-arbitrary-angle-hardware-gates">
<h1>Native Arbitrary Angle Hardware Gates<a class="headerlink" href="#native-arbitrary-angle-hardware-gates" title="Link to this heading">¶</a></h1>
<p>Native gates are gates on a quantum computer that the hardware physically executes. Different quantum computers may have different gates that are physically executed on the hardware. Writing a gate in a quantum circuit submitted to hardware doesn’t guarantee its physical execution on the device. For instance, on Quantinuum quantum computers, a Hadamard gate written in the circuit is not the actual gate executed. When users submit circuits using a Hadamard gate, the gate is translated into a <span class="math notranslate nohighlight">\(U1q\)</span> gate followed by a <span class="math notranslate nohighlight">\(Rz\)</span> gate, which the ion trap device physically executes.</p>
<a class="reference internal image-reference" href="../../_images/submission_workflow.png"><img alt="Submission Workflow" class="align-center" src="../../_images/submission_workflow.png" style="width: 800px;" />
</a>
<p>The Quantinuum hardware compiler handles the translation from circuits users submit to the native gates run on hardware. In the Quantum Charge-Coupled Device (QCCD) architecture, the hardware compilation includes the assignment of which physical qubit corresponds to which qubit in a circuit as well as how qubits will be transported around the device. Since transport, as well as gating, incurs a small amount of error with each operation, the compiler aims to minimize the number of gates that need to be executed.</p>
<p>This article showcases two workflows:</p>
<ol class="arabic simple">
<li><p>prepare and submit a circuit with the <span class="math notranslate nohighlight">\(SU(4)\)</span> gate with a <a class="reference external" href="https://arxiv.org/abs/1811.12926">Quantum Volume Test (QVT)</a> use case. The quantum volume is an important metric to benchmark the quality of a quantum computer.</p></li>
<li><p>perform a comparison of Quantum Fourier Transform (QFT) circuits with and without use of Quantinuum’s native arbitrary-angle ZZ gate. The inverse QFT is an important primitive used in the <a class="reference external" href="https://docs.quantinuum.com/tket/user-guide/examples/algorithms_and_protocols/phase_estimation.html">Phase Estimation Algorithm (PEA)</a>.</p></li>
</ol>
<section id="arbitrary-angle-zz-gates">
<h2>Arbitrary Angle ZZ Gates<a class="headerlink" href="#arbitrary-angle-zz-gates" title="Link to this heading">¶</a></h2>
<p>Quantinuum System Model H1’s native gate set includes arbitrary angle ZZ gates. This is beneficial for reducing the 2-qubit gate count for many quantum algorithms and gate sequences.</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{split}RZZ(\theta) = e^{-i\frac{\theta}{2}\hat{Z} \otimes \hat{Z}}= e^{-i \frac{\theta}{2}} \begin{bmatrix} 1 &amp; 0 &amp; 0 &amp; 0\\ 0 &amp; e^{-i\theta} &amp; 0 &amp; 0\\ 0 &amp; 0 &amp; e^{-i\theta} &amp; 0\\ 0 &amp; 0 &amp; 0 &amp; 1 \end{bmatrix}\end{split}\]</div>
</div>
<p>Note that <span class="math notranslate nohighlight">\(RZZ(\frac{\pi}{2}) = ZZ()\)</span>.</p>
<p>Quantum circuits that use the gate sequence CNOT, RZ, CNOT can be replaced with the arbitrary angle ZZ gate, shown below. Arbitrary-angle two-qubit gates can be used to improve fidelity of the output and to decrease two-qubit gate depth. Specifically, the error from arbitrary-angle two-qubit gates is less than the fixed-angle two-qubit gate for small angles. The error from both gates is the same at angle <span class="math notranslate nohighlight">\(\frac{\phi}{2}\)</span>. The error from arbitrary-angle two-qubit gates increases with angle size.</p>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row docutils">
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Pauli Exponential with <code class="docutils literal notranslate"><span class="pre">OpType.Rz</span></code> and <code class="docutils literal notranslate"><span class="pre">OpType.CX</span></code> operations in pytket</div>
<figure class="align-default">
<img alt="../../_images/pauli_gadget_2q.png" src="../../_images/pauli_gadget_2q.png" />
</figure>
</div>
</div>
</div>
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Pauli Exponential with <code class="docutils literal notranslate"><span class="pre">OpType.ZZPhase</span></code> (<span class="math notranslate nohighlight">\(RZZ(\theta)\)</span>) operation in pytket</div>
<figure class="align-default">
<img alt="../../_images/zzphase.png" src="../../_images/zzphase.png" />
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="arbitrary-angle-su-4-gates">
<h2>Arbitrary Angle SU(4) Gates<a class="headerlink" href="#arbitrary-angle-su-4-gates" title="Link to this heading">¶</a></h2>
<p>The General <span class="math notranslate nohighlight">\(SU(4)\)</span> Entangler gate is available in TKET as <a class="reference external" href="https://tket.quantinuum.com/api-docs/circuit_class.html#pytket.circuit.Circuit.TK2"><code class="docutils literal notranslate"><span class="pre">OpType.TK2</span></code></a>. This gate is a combination of <code class="docutils literal notranslate"><span class="pre">OpType.XXPhase</span></code>, <code class="docutils literal notranslate"><span class="pre">OpType.YYPhase</span></code> and <code class="docutils literal notranslate"><span class="pre">OpType.ZZPhase</span></code>, and requires three angles as input, <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span> and <span class="math notranslate nohighlight">\(\gamma\)</span>. The definition of the gate is provided below:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{equation} \textrm{TK2}(\alpha, \beta, \gamma) = e^{-\frac{1}{2} i \pi \alpha (\hat{X} \bigotimes \hat{X})} \quad e^{-\frac{1}{2} i \pi \beta (\hat{Y} \bigotimes \hat{Y})} \quad e^{-\frac{1}{2} \pi \gamma (\hat{Z} \bigotimes \hat{Z})} = e^{-\frac{1}{2} i \alpha (\hat{X} \bigotimes \hat{X}) -\frac{1}{2} i \pi \beta (\hat{Y} \bigotimes \hat{Y}) -\frac{1}{2} i \pi \gamma (\hat{Z} \bigotimes \hat{Z})} \end{equation} \]</div>
</div>
<p>This gate can be used as follows within TKET.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pytket.circuit.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">render_circuit_jupyter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.circuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Circuit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sympy</span><span class="w"> </span><span class="kn">import</span> <span class="n">Symbol</span>

<span class="n">symbols</span> <span class="o">=</span> <span class="p">[</span><span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">),</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">),</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">)]</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">TK2</span><span class="p">(</span><span class="o">*</span><span class="n">symbols</span><span class="p">,</span> <span class="o">*</span><span class="n">circuit</span><span class="o">.</span><span class="n">qubits</span><span class="p">)</span>
<span class="n">render_circuit_jupyter</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This circuit can be converted to a QASM string using the <a class="reference external" href="https://tket.quantinuum.com/api-docs/qasm.html#pytket.qasm.circuit_to_qasm_str"><code class="docutils literal notranslate"><span class="pre">circuit_to_qasm_str</span></code></a> function and by specifying the Quantinuum header <code class="docutils literal notranslate"><span class="pre">hqslib1</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pytket.qasm.qasm</span><span class="w"> </span><span class="kn">import</span> <span class="n">circuit_to_qasm_str</span>

<span class="nb">print</span><span class="p">(</span><span class="n">circuit_to_qasm_str</span><span class="p">(</span><span class="n">circuit</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="s2">&quot;hqslib1&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Submission of the gate requires the desired native two-qubit gate to be specified in <code class="docutils literal notranslate"><span class="pre">qnexus.QuantinuumConfig</span></code> via the keyword argument, <code class="docutils literal notranslate"><span class="pre">target_2qb_gate</span></code>. Three values can be supplied as a string:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TK2</span></code>: to use the arbitrary-angle <span class="math notranslate nohighlight">\(SU(4)\)</span> gate;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ZZPhase</span></code>: to use the arbitrary-angle <span class="math notranslate nohighlight">\(ZZ\)</span> gate;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ZZMax</span></code>: to use the fixed-angle <span class="math notranslate nohighlight">\(ZZ\)</span> gate.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">qnexus</span>

<span class="n">config_tk2</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">QuantinuumConfig</span><span class="p">(</span><span class="n">device_name</span><span class="o">=</span><span class="s2">&quot;H1-1E&quot;</span><span class="p">,</span> <span class="n">target_2qb_gate</span><span class="o">=</span><span class="s2">&quot;TK2&quot;</span><span class="p">)</span>
<span class="n">config_zzphase</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">QuantinuumConfig</span><span class="p">(</span><span class="n">device_name</span><span class="o">=</span><span class="s2">&quot;H1-1E&quot;</span><span class="p">,</span> <span class="n">target_2qb_gate</span><span class="o">=</span><span class="s2">&quot;ZZPhase&quot;</span><span class="p">)</span>
<span class="n">config_zzmax</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">QuantinuumConfig</span><span class="p">(</span><span class="n">device_name</span><span class="o">=</span><span class="s2">&quot;H1-1E&quot;</span><span class="p">,</span> <span class="n">target_2qb_gate</span><span class="o">=</span><span class="s2">&quot;ZZMax&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="quantum-fourier-transform">
<h2>Quantum Fourier Transform<a class="headerlink" href="#quantum-fourier-transform" title="Link to this heading">¶</a></h2>
<p>The Quantum Fourier Transform (QFT) is an algorithm that serves as a sub-routine in multiple quantum algorithms, including Shor’s factoring algorithm. Below are two functions, written in <code class="docutils literal notranslate"><span class="pre">pytket</span></code>, that work together to implement the QFT.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">QFT</span></code> function can be used to create the QFT. It takes the following arguments:<br></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code>: number of qubits to use in the QFT circuit<br></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">arbZZ</span></code>: specify whether to use the arbitrary-angle ZZ gate or not, <code class="docutils literal notranslate"><span class="pre">True</span></code>/<code class="docutils literal notranslate"><span class="pre">False</span></code>, default: <code class="docutils literal notranslate"><span class="pre">False</span></code><br></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">approx</span></code>: if set to integer <code class="docutils literal notranslate"><span class="pre">k</span></code>, then controlled rotations by angles less than <span class="math notranslate nohighlight">\(\frac{\pi}{2}^{k}\)</span> do not occur</p></li>
</ul>
<p><strong>Note:</strong> In many presentations of the QFT, the circuit includes a round of SWAP gates at the end of the circuit that reverses the order of the qubits. The QFT circuits in this tutorial do not include this final SWAP step.</p>
<p><strong>Note:</strong> In <code class="docutils literal notranslate"><span class="pre">pytket</span></code> the <span class="math notranslate nohighlight">\(RZZ\)</span> gate is implemented with the <span class="math notranslate nohighlight">\(ZZPhase\)</span> circuit function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pytket</span><span class="w"> </span><span class="kn">import</span> <span class="n">Circuit</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.circuit.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">render_circuit_jupyter</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">control_phase</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">arbZZ</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;circuit gadget for performing controlled-[1 0;0 e^i theta]</span>
<span class="sd">    Inputs:</span>
<span class="sd">        circ: pytket Circuit object</span>
<span class="sd">        theta: Z rotation angle (in units of pi)</span>
<span class="sd">        q0: control qubit</span>
<span class="sd">        q1: target qubit</span>
<span class="sd">        arbZZ (bool): enables arbitrary angle RZZ gate</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">arbZZ</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="c1"># decompose into CNOTs</span>
        <span class="n">circ</span><span class="o">.</span><span class="n">Rz</span><span class="p">(</span><span class="n">theta</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>
        <span class="n">circ</span><span class="o">.</span><span class="n">CX</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>
        <span class="n">circ</span><span class="o">.</span><span class="n">Rz</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>
        <span class="n">circ</span><span class="o">.</span><span class="n">CX</span><span class="p">(</span><span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>
        <span class="n">circ</span><span class="o">.</span><span class="n">Rz</span><span class="p">(</span><span class="n">theta</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">q0</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">arbZZ</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">circ</span><span class="o">.</span><span class="n">Rz</span><span class="p">(</span><span class="n">theta</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">q0</span><span class="p">)</span>
        <span class="n">circ</span><span class="o">.</span><span class="n">Rz</span><span class="p">(</span><span class="n">theta</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>
        <span class="n">circ</span><span class="o">.</span><span class="n">ZZPhase</span><span class="p">(</span><span class="o">-</span><span class="n">theta</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">q0</span><span class="p">,</span> <span class="n">q1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">QFT</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to implement the Quantum Fourier Transform</span>
<span class="sd">    n : number of qubits</span>
<span class="sd">    approx: if set to integer k, then sets that largest</span>
<span class="sd">                 value of pi/2**k occuring in controlled rotation</span>
<span class="sd">    returns circ: pytket Circuit object</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># optional keyword arguments</span>
    <span class="n">arbZZ</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;arbZZ&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">approx</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;approx&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="c1"># initialize</span>
    <span class="n">circ_name</span> <span class="o">=</span> <span class="s2">&quot;QFT-arbZZ&quot;</span> <span class="k">if</span> <span class="n">arbZZ</span> <span class="k">else</span> <span class="s2">&quot;QFT-fixed&quot;</span>
    <span class="n">circ</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">circ_name</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">j</span>
        <span class="n">circ</span><span class="o">.</span><span class="n">H</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">approx</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">approx</span> <span class="o">&gt;=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">:</span>
                <span class="n">control_phase</span><span class="p">(</span>
                    <span class="n">circ</span><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">)),</span> <span class="n">q</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">,</span> <span class="n">arbZZ</span><span class="o">=</span><span class="n">arbZZ</span>
                <span class="p">)</span>
    <span class="n">circ</span><span class="o">.</span><span class="n">H</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">circ</span>
</pre></div>
</div>
</div>
</div>
<section id="qft-with-fixed-angle-gates">
<h3>QFT with Fixed Angle Gates<a class="headerlink" href="#qft-with-fixed-angle-gates" title="Link to this heading">¶</a></h3>
<p>First, create the circuit with fixed-angle gates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_qubits</span> <span class="o">=</span> <span class="mi">12</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qft_fixed</span> <span class="o">=</span> <span class="n">QFT</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">arbZZ</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">render_circuit_jupyter</span><span class="p">(</span><span class="n">qft_fixed</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="qft-with-arbitrary-angle-zz-gates">
<h3>QFT with Arbitrary Angle ZZ Gates<a class="headerlink" href="#qft-with-arbitrary-angle-zz-gates" title="Link to this heading">¶</a></h3>
<p>Second, create the circuit with arbitrary-angle ZZ gates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qft_arbZZ</span> <span class="o">=</span> <span class="n">QFT</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">arbZZ</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">render_circuit_jupyter</span><span class="p">(</span><span class="n">qft_arbZZ</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="compare-results">
<h3>Compare Results<a class="headerlink" href="#compare-results" title="Link to this heading">¶</a></h3>
<p>Now we compare the results of the QFT circuits with and without use of the arbitrary-angle ZZ gates on hardware.</p>
<section id="state-fidelity">
<h4>State Fidelity<a class="headerlink" href="#state-fidelity" title="Link to this heading">¶</a></h4>
<p>The QFT circuit applied to the computational basis state <span class="math notranslate nohighlight">\(|x\rangle\)</span> creates the state</p>
<p>\begin{align}<br>
QFT|x\rangle&amp;=\frac{1}{\sqrt{d}}\sum_{y=0}^{d-1} e^{2\pi i x y/d} |y\rangle\<br>
&amp;= \bigotimes_{j=0}^{n-1}\frac{1}{\sqrt{2}}\sum_{y_j=0}^1e^{2\pi i x 2^j y_j/d}|y_j\rangle\<br>
&amp;= \bigotimes_{j=0}^{n-1}\frac{1}{\sqrt{2}}\big(|0\rangle+e^{2\pi i x 2^j /d}|1\rangle\big)<br>
\end{align}</p>
<p>where <span class="math notranslate nohighlight">\(d=2^n\)</span>. Note that this state is unentangled. Therefore the state fidelity can be measured by applying only single-qubit gates to map the state back to the computational basis. In the example circuits above, the initial state <span class="math notranslate nohighlight">\(|x\rangle=|0\rangle\)</span>, and so the output state is</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\bigotimes_{j=0}^{n-1}\frac{1}{\sqrt{2}}\big(|0\rangle + |1\rangle\big) = |+\rangle^{\otimes n}\]</div>
</div>
<p>The state fidelity can then be measured by applying a Hadamard gate to each qubit and recording the probability of measuring <span class="math notranslate nohighlight">\(|0\rangle\)</span>.</p>
<p>We define a function to measure all qubits in the Hadamard basis and append this circuit to the QFT circuits:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">meas_Had_basis</span><span class="p">(</span><span class="n">orig_circ</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">):</span>
    <span class="n">circ</span> <span class="o">=</span> <span class="n">orig_circ</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">):</span>
        <span class="n">circ</span><span class="o">.</span><span class="n">H</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
    <span class="n">circ</span><span class="o">.</span><span class="n">add_barrier</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">))</span>
    <span class="n">circ</span><span class="o">.</span><span class="n">measure_all</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">circ</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qft_fid_fixed</span> <span class="o">=</span> <span class="n">meas_Had_basis</span><span class="p">(</span><span class="n">qft_fixed</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">)</span>
<span class="n">render_circuit_jupyter</span><span class="p">(</span><span class="n">qft_fid_fixed</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qft_fid_arbZZ</span> <span class="o">=</span> <span class="n">meas_Had_basis</span><span class="p">(</span><span class="n">qft_arbZZ</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">)</span>
<span class="n">render_circuit_jupyter</span><span class="p">(</span><span class="n">qft_fid_arbZZ</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-nexus-configuration">
<h4>Define Nexus Configuration<a class="headerlink" href="#define-nexus-configuration" title="Link to this heading">¶</a></h4>
<p>Use qnexus to retrieve an existing project from the database (<code class="docutils literal notranslate"><span class="pre">arb-angle-demonstration</span></code>). The <code class="docutils literal notranslate"><span class="pre">qnexus.QuantinuumConfig</span></code> targets the <code class="docutils literal notranslate"><span class="pre">H2-Emulator</span></code>, hosted on Nexus.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">qnexus</span>

<span class="n">quantinuum_config</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">QuantinuumConfig</span><span class="p">(</span><span class="n">device_name</span><span class="o">=</span><span class="s2">&quot;H2-Emulator&quot;</span><span class="p">)</span>
<span class="n">job_name_suffix</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y_%m_</span><span class="si">%d</span><span class="s2">-%H_%M_%S&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">project</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">projects</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;arb-angle-demonstration&quot;</span><span class="p">)</span>
<span class="n">token</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">set_active_project</span><span class="p">(</span><span class="n">project</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="circuit-compilation">
<h4>Circuit Compilation<a class="headerlink" href="#circuit-compilation" title="Link to this heading">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref_fixed</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">circuits</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">qft_fid_fixed</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Fixed&quot;</span><span class="p">)</span>
<span class="n">ref_arbzz</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">circuits</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">qft_fid_arbZZ</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ArbZZ&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Compile the circuits to use Quantinuum native gates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref_compile_job_arbzz</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">start_compile_job</span><span class="p">(</span>
    <span class="n">circuits</span><span class="o">=</span><span class="p">[</span><span class="n">ref_arbzz</span><span class="p">],</span>
    <span class="n">backend_config</span><span class="o">=</span><span class="n">quantinuum_config</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;nexus-compilation-job-arbzz-</span><span class="si">{</span><span class="n">job_name_suffix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">optimisation_level</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qnexus</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">ref_compile_job_arbzz</span><span class="p">)</span>
<span class="n">compiled_circuit_ref_arbzz</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">results</span><span class="p">(</span><span class="n">ref_compile_job_arbzz</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_output</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compiled_circuit_arbzz</span> <span class="o">=</span> <span class="n">compiled_circuit_ref_arbzz</span><span class="o">.</span><span class="n">download_circuit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref_compile_job_fixed</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">start_compile_job</span><span class="p">(</span>
    <span class="n">circuits</span><span class="o">=</span><span class="p">[</span><span class="n">ref_fixed</span><span class="p">],</span>
    <span class="n">backend_config</span><span class="o">=</span><span class="n">quantinuum_config</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;nexus-compilation-job-fixed-</span><span class="si">{</span><span class="n">job_name_suffix</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="n">optimisation_level</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qnexus</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">ref_compile_job_fixed</span><span class="p">);</span>
<span class="n">compiled_circuit_ref_fixed</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">results</span><span class="p">(</span><span class="n">ref_compile_job_fixed</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_output</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compiled_circuit_fixed</span> <span class="o">=</span> <span class="n">compiled_circuit_ref_fixed</span><span class="o">.</span><span class="n">download_circuit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="circuit-depth-and-two-qubit-gates">
<h4>Circuit Depth and Two-Qubit Gates<a class="headerlink" href="#circuit-depth-and-two-qubit-gates" title="Link to this heading">¶</a></h4>
<p>Note that the circuit depth number of two-qubit gates for the fixed-angle vs. arbitrary angle is less. The difference increases as more qubits are used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Circuit Depth for fixed-angle QFT:&quot;</span><span class="p">,</span> <span class="n">compiled_circuit_fixed</span><span class="o">.</span><span class="n">depth</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Circuit Depth for arbitrary-angle QFT:&quot;</span><span class="p">,</span> <span class="n">compiled_circuit_arbzz</span><span class="o">.</span><span class="n">depth</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Circuit Depth Difference:&quot;</span><span class="p">,</span> <span class="n">compiled_circuit_fixed</span><span class="o">.</span><span class="n">depth</span><span class="p">()</span> <span class="o">-</span> <span class="n">compiled_circuit_arbzz</span><span class="o">.</span><span class="n">depth</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of two-qubit gates for fixed-angle QFT:&quot;</span><span class="p">,</span> <span class="n">compiled_circuit_fixed</span><span class="o">.</span><span class="n">n_2qb_gates</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of two-qubit gates for arbitrary-angle QFT:&quot;</span><span class="p">,</span> <span class="n">compiled_circuit_arbzz</span><span class="o">.</span><span class="n">n_2qb_gates</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of two-qubit gates Difference:&quot;</span><span class="p">,</span> <span class="n">compiled_circuit_fixed</span><span class="o">.</span><span class="n">n_2qb_gates</span><span class="p">()</span> <span class="o">-</span> <span class="n">compiled_circuit_arbzz</span><span class="o">.</span><span class="n">n_2qb_gates</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-the-circuit">
<h4>Run the Circuit<a class="headerlink" href="#run-the-circuit" title="Link to this heading">¶</a></h4>
<p>Now run the circuits on Quantinuum systems. First compiling the circuits to the backend, then submitting to the device.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_shots</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">ref_execute_job_fixed</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">start_execute_job</span><span class="p">(</span>
    <span class="n">circuits</span><span class="o">=</span><span class="p">[</span><span class="n">compiled_circuit_ref_fixed</span><span class="p">],</span>
    <span class="n">n_shots</span><span class="o">=</span><span class="p">[</span><span class="n">n_shots</span><span class="p">],</span>
    <span class="n">backend_config</span><span class="o">=</span><span class="n">quantinuum_config</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;execution-job-fixed-</span><span class="si">{</span><span class="n">job_name_suffix</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qnexus</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">ref_execute_job_fixed</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref_execute_job_arbzz</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">start_execute_job</span><span class="p">(</span>
    <span class="n">circuits</span><span class="o">=</span><span class="p">[</span><span class="n">compiled_circuit_ref_arbzz</span><span class="p">],</span>
    <span class="n">n_shots</span><span class="o">=</span><span class="p">[</span><span class="n">n_shots</span><span class="p">],</span>
    <span class="n">backend_config</span><span class="o">=</span><span class="n">quantinuum_config</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;nexus-execution-job-arbzz-</span><span class="si">{</span><span class="n">job_name_suffix</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qnexus</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">ref_execute_job_arbzz</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="retrieve-results">
<h4>Retrieve Results<a class="headerlink" href="#retrieve-results" title="Link to this heading">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qft_fid_fixed_compiled_result</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">results</span><span class="p">(</span><span class="n">ref_execute_job_fixed</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_output</span><span class="p">()</span><span class="o">.</span><span class="n">download_result</span><span class="p">()</span>
<span class="n">qft_fid_arbZZ_compiled_result</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">results</span><span class="p">(</span><span class="n">ref_execute_job_arbzz</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_output</span><span class="p">()</span><span class="o">.</span><span class="n">download_result</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="analyze-results">
<h4>Analyze Results<a class="headerlink" href="#analyze-results" title="Link to this heading">¶</a></h4>
<p>Here the distribution of bitstrings is retrieved to inspect.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qft_fid_fixed_compiled_distro</span> <span class="o">=</span> <span class="n">qft_fid_fixed_compiled_result</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">()</span>
<span class="n">qft_fid_arbZZ_compiled_distro</span> <span class="o">=</span> <span class="n">qft_fid_arbZZ_compiled_result</span><span class="o">.</span><span class="n">get_distribution</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>For the QFT with the appended measurement in the Hadamard basis, we expect the QFT to return all 0’s in the result bitstring. Investigating the results for both the fixed and arbitrary ZZ versions of QFT, we see this is the bitstring with the highest frequency. This is good, this is what is desired.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qft_fid_fixed_compiled_distro</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qft_fid_arbZZ_compiled_distro</span>
</pre></div>
</div>
</div>
</div>
<p>Comparing the results between the fixed and arbitrary ZZ versions we see that the fidelity is higher using the arbitrary ZZ gate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Fixed angle QFT:&quot;</span><span class="p">,</span>
    <span class="n">qft_fid_fixed_compiled_distro</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="s2">&quot;Arbitrary Angle ZZ QFT:&quot;</span><span class="p">,</span>
    <span class="n">qft_fid_arbZZ_compiled_distro</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="quantum-volume-test">
<h2>Quantum Volume Test<a class="headerlink" href="#quantum-volume-test" title="Link to this heading">¶</a></h2>
<p>Quantum volume is a benchmarking test that was initially proposed by IBM (<a class="reference external" href="https://arxiv.org/abs/1811.12926">arXiv:1811.12926</a>). It is a test that aims to verify the quality as well as the quantity of qubits on the machine. The test does this by performing rounds of single and two qubit gates between random pairs of qubits for as many rounds as qubits in the test. For example, for quantum volume of <span class="math notranslate nohighlight">\(2^N\)</span> where <span class="math notranslate nohighlight">\(N=4\)</span>, there are 4 layers of repeated operations over 4 qubits. It verifies the quantum computer can perform quality computation with reasonable-sized circuits. The advantage to using quantum volume is that it gives users the confidence that not only do they have the number of qubits to support running their circuit, but the two-qubit gate fidelity meets the threshold to support circuits of significant depth as well. Quantum algorithms need not only qubits, but the ability to run many gates. Quantinuum has steadily been increasing the quantum volume of Quantinuum machines.</p>
<p>First we import the functions we need in TKET.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">pytket</span><span class="w"> </span><span class="kn">import</span> <span class="n">Circuit</span><span class="p">,</span> <span class="n">OpType</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.circuit.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">render_circuit_jupyter</span>
</pre></div>
</div>
</div>
</div>
<p>To run a circuit containing the general <span class="math notranslate nohighlight">\(SU(4)\)</span> gate on Quantinuum machines, the configuration for <code class="docutils literal notranslate"><span class="pre">QuantinumConfig</span></code> needs to have <code class="docutils literal notranslate"><span class="pre">OpType.TK2</span></code> set as the native two-qubit gate. This is accomplised by setting <code class="docutils literal notranslate"><span class="pre">target_2qb_gate</span></code>, compilation and execution with <code class="docutils literal notranslate"><span class="pre">OpType.TK2</span></code> is enabled.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">qnexus</span>

<span class="n">config_tk2</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">QuantinuumConfig</span><span class="p">(</span><span class="n">device_name</span><span class="o">=</span><span class="s2">&quot;H1-Emulator&quot;</span><span class="p">,</span> <span class="n">target_2qb_gate</span><span class="o">=</span><span class="s2">&quot;TK2&quot;</span><span class="p">)</span>
<span class="n">config_zzphase</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">QuantinuumConfig</span><span class="p">(</span><span class="n">device_name</span><span class="o">=</span><span class="s2">&quot;H1-Emulator&quot;</span><span class="p">,</span> <span class="n">target_2qb_gate</span><span class="o">=</span><span class="s2">&quot;ZZPhase&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>A new project is defined for the <span class="math notranslate nohighlight">\(SU(4)\)</span> use-case.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">project</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">projects</span><span class="o">.</span><span class="n">get_or_create</span><span class="p">(</span><span class="s2">&quot;qvt_usecase&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Project containing job data for Quantum Volume Test use-case&quot;</span><span class="p">)</span>
<span class="n">qnexus</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">set_active_project</span><span class="p">(</span><span class="n">project</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To set up the Quantum Volume test, we start by building up the repeated circuit elements. The function in the code cell below defines a TKET Circuit Box with <a class="reference external" href="https://tket.quantinuum.com/api-docs/circuit.html#pytket.circuit.CircBox"><code class="docutils literal notranslate"><span class="pre">pytket.circuit.CircBox</span></code></a>. Circuit Boxes are useful for composing larger circuits from smaller subcircuits that utilize the same set of gates.</p>
<p>The Circuit box below contains a blueprint for the decomposition of a random general <span class="math notranslate nohighlight">\(SU(4)\)</span> unitary distributed with the Haar Measure into a circuit primitive over 2 qubits. The implementation is based on <a class="reference external" href="http://arxiv.org/abs/math-ph/0609050">arxiv.0609050</a>. The random <span class="math notranslate nohighlight">\(SU(4)\)</span> unitary is generated using <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.unitary_group.html#scipy-stats-unitary-group"><code class="docutils literal notranslate"><span class="pre">scipy.stats.unitary_group</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pytket.circuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">CircBox</span><span class="p">,</span> <span class="n">Circuit</span><span class="p">,</span> <span class="n">Unitary2qBox</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">unitary_group</span>


<span class="k">def</span><span class="w"> </span><span class="nf">haar_random_su4_box</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">CircBox</span><span class="p">:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">unitary_group</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="n">circuit</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">box</span> <span class="o">=</span> <span class="n">Unitary2qBox</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="n">circuit</span><span class="o">.</span><span class="n">add_unitary2qbox</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">CircBox</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Circuit Boxes can be visualized utilizing the <code class="docutils literal notranslate"><span class="pre">get_circuit</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pytket.circuit.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">render_circuit_jupyter</span>

<span class="n">circuit</span> <span class="o">=</span> <span class="n">haar_random_su4_box</span><span class="p">()</span><span class="o">.</span><span class="n">get_circuit</span><span class="p">()</span>
<span class="n">render_circuit_jupyter</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the cell below, the CircBox is inspected and further optimisations are applied. <code class="docutils literal notranslate"><span class="pre">DecomposeBoxes</span></code> simplifies <code class="docutils literal notranslate"><span class="pre">OpType.CircBox</span></code> operations into the underlying gate operations recursively. Further decompositions  are performed with the <code class="docutils literal notranslate"><span class="pre">KAKDecomposition</span></code> function. We specify use the <code class="docutils literal notranslate"><span class="pre">OpType.TK2</span></code> gate in this function call as the target 2-qubit gate after decomposition.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">pytket</span></code> sequence pass, consists of two passes:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://tket.quantinuum.com/api-docs/passes.html#pytket.passes.DecomposeBoxes"><code class="docutils literal notranslate"><span class="pre">pytket.passes.DecomposeBoxes</span></code></a></p></li>
<li><p><a class="reference external" href="https://tket.quantinuum.com/api-docs/passes.html#pytket.passes.KAKDecomposition"><code class="docutils literal notranslate"><span class="pre">pytket.passes.KAKDecomposition</span></code></a></p></li>
</ul>
<p>Both passes are arguments to <a class="reference external" href="https://tket.quantinuum.com/api-docs/passes.html#pytket.passes.SequencePass"><code class="docutils literal notranslate"><span class="pre">pytket.passes.SequencePass</span></code></a>. <code class="docutils literal notranslate"><span class="pre">SequencePass</span></code> allows both passes to be applied to the input circuit with one <code class="docutils literal notranslate"><span class="pre">apply</span></code> call.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pytket.passes</span><span class="w"> </span><span class="kn">import</span> <span class="n">DecomposeBoxes</span><span class="p">,</span> <span class="n">KAKDecomposition</span><span class="p">,</span> <span class="n">SequencePass</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pytket.circuit</span><span class="w"> </span><span class="kn">import</span> <span class="n">OpType</span>

<span class="n">sequence_pass</span> <span class="o">=</span> <span class="n">SequencePass</span><span class="p">(</span>
    <span class="p">[</span><span class="n">DecomposeBoxes</span><span class="p">(),</span> <span class="n">KAKDecomposition</span><span class="p">(</span><span class="n">target_2qb_gate</span><span class="o">=</span><span class="n">OpType</span><span class="o">.</span><span class="n">TK2</span><span class="p">)]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sequence_pass</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
<span class="n">render_circuit_jupyter</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we’re ready to set up a Quantum Volume test circuit using the Circuit Box we created. The steps to set up the circuit are straightforward using the <code class="docutils literal notranslate"><span class="pre">CircBox</span></code> instances to build up the full circuit.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circuit</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">permutation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">circuit</span><span class="o">.</span><span class="n">qubits</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">box</span> <span class="o">=</span> <span class="n">haar_random_su4_box</span><span class="p">()</span>
        <span class="n">circuit</span><span class="o">.</span><span class="n">add_circbox</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="p">[</span><span class="n">permutation</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">permutation</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">measure_all</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">SequencePass</span></code> defined in the code cell in the previous subsection is used below on the QVT circuit and we can see the full set of gates in the circuit as well as the result of optimizations performed by <code class="docutils literal notranslate"><span class="pre">KAKDecomposition</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pytket.circuit.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">render_circuit_jupyter</span>

<span class="n">sequence_pass</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
<span class="n">render_circuit_jupyter</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref_su4</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">circuits</span><span class="o">.</span><span class="n">upload</span><span class="p">(</span><span class="n">circuit</span><span class="o">=</span><span class="n">circuit</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;su4_circuit&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref_compile_job_tk2</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">start_compile_job</span><span class="p">(</span>
    <span class="n">circuits</span><span class="o">=</span><span class="p">[</span><span class="n">ref_su4</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;compilation-tk2-job&quot;</span><span class="p">,</span>
    <span class="n">backend_config</span><span class="o">=</span><span class="n">config_tk2</span><span class="p">,</span>
    <span class="n">optimisation_level</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qnexus</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">ref_compile_job_tk2</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">ref_compile_circuit_tk2</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">results</span><span class="p">(</span><span class="n">ref_compile_job_tk2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_output</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">compiled_circuit_tk2</span> <span class="o">=</span> <span class="n">ref_compile_circuit_tk2</span><span class="o">.</span><span class="n">download_circuit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">pytket.circuit.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">render_circuit_jupyter</span>

<span class="n">render_circuit_jupyter</span><span class="p">(</span><span class="n">compiled_circuit_tk2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref_execute_job_tk2</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">start_execute_job</span><span class="p">(</span>
    <span class="n">circuits</span><span class="o">=</span><span class="p">[</span><span class="n">ref_compile_circuit_tk2</span><span class="p">],</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;execution-tk2-job&quot;</span><span class="p">,</span>
    <span class="n">backend_config</span><span class="o">=</span><span class="n">config_tk2</span><span class="p">,</span>
    <span class="n">n_shots</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">qnexus</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">ref_execute_job_tk2</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">result_tk2</span> <span class="o">=</span> <span class="n">qnexus</span><span class="o">.</span><span class="n">jobs</span><span class="o">.</span><span class="n">results</span><span class="p">(</span><span class="n">ref_execute_job_tk2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">download_result</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="conditional_operations_and_classical_logic.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Conditional Operations &amp; Classical Logic</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="mcmr.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Mid-Circuit Measurement &amp; Reset</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
              Copyright &#169; 2024 Quantinuum Ltd. All rights reserved.
            </div>
            <div class="terms" style="display:flex; gap:0.5rem; align-items:center; margin: 0.25rem 0rem;">
              <a href="https://www.quantinuum.com/privacy-statement" target="_blank">Privacy Statement</a>
              <div role="separator">/</div>
              <a href="https://www.quantinuum.com/cookie-notice" target="_blank">Cookie Notice</a>
              <div role="separator">/</div>
              <a href="https://www.quantinuum.com/terms-conditions" target="_blank">Terms and Conditions</a>
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Native Arbitrary Angle Hardware Gates</a><ul>
<li><a class="reference internal" href="#arbitrary-angle-zz-gates">Arbitrary Angle ZZ Gates</a></li>
<li><a class="reference internal" href="#arbitrary-angle-su-4-gates">Arbitrary Angle SU(4) Gates</a></li>
<li><a class="reference internal" href="#quantum-fourier-transform">Quantum Fourier Transform</a><ul>
<li><a class="reference internal" href="#qft-with-fixed-angle-gates">QFT with Fixed Angle Gates</a></li>
<li><a class="reference internal" href="#qft-with-arbitrary-angle-zz-gates">QFT with Arbitrary Angle ZZ Gates</a></li>
<li><a class="reference internal" href="#compare-results">Compare Results</a><ul>
<li><a class="reference internal" href="#state-fidelity">State Fidelity</a></li>
<li><a class="reference internal" href="#define-nexus-configuration">Define Nexus Configuration</a></li>
<li><a class="reference internal" href="#circuit-compilation">Circuit Compilation</a></li>
<li><a class="reference internal" href="#circuit-depth-and-two-qubit-gates">Circuit Depth and Two-Qubit Gates</a></li>
<li><a class="reference internal" href="#run-the-circuit">Run the Circuit</a></li>
<li><a class="reference internal" href="#retrieve-results">Retrieve Results</a></li>
<li><a class="reference internal" href="#analyze-results">Analyze Results</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#quantum-volume-test">Quantum Volume Test</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=7f41d439"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>